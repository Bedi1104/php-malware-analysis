# Web Shell Program Installation Campaign

Record of a campaign to install Simple SOCKS5 Server for Perl
on a WordPress honey pot.

## Origin

### IP Address 91.109.19.24

    % Information related to '91.109.16.0/20AS28753'
    route:          91.109.16.0/20
    descr:          routed via LeaseWeb DE
    origin:         AS28753
    mnt-by:         LEASEWEB-DE-MNT
    created:        2015-06-04T13:17:40Z
    last-modified:  2015-10-22T11:11:34Z

`geoiplookup` agrees, this IP address has a location somewhere in Germany.

### Download

The attacker tried to access a URI `/wp-content/themes/twentytwelve/data.php`
with HTTP POST parameters named "a", "c", "p1", "p2".

## Analysis

The attacker(s) attempted to install a file named [sss.pl](files/91.109.19.24W1oV0qV8keuzatLIFymrwwAAAAc.0.file)
via a sequence of commands to a WSO (Web Shell by oRb) web shell.

Based on the fine-grained timestamp that PHP keeps as `$_SERVER['REQUEST_TIME_FLOAT']`,
I reconstructed the timeline of actions.
The table following lists values of "a", "c", "p1", "p2", "p3"
HTTP POST parameters (if present), in chronological order.

|Timestamp|a|c|p1|p2|p3|
|---|---|---|---|---|---|
|2018-07-26T12:41:17.701-0600|||||||
|2018-07-26T12:41:18.326-0600|FilesTools|/var/www/html/|sss.pl|mkfile|||
|2018-07-26T12:41:18.848-0600|FilesTools|/var/www/html/|sss.pl|chmod|0755||
|2018-07-26T12:41:19.331-0600|FilesTools|/var/www/html/|sss.pl|chmod|||
|2018-07-26T12:41:19.877-0600|FilesTools|/var/www/html/|sss.pl|chmod|0744||
|2018-07-26T12:41:20.433-0600|FilesTools|/var/www/html/|sss.pl|edit|#!/usr/bin/perl||
|2018-07-26T12:41:21.063-0600|FilesMan|/var/www/html/|delete||||
|2018-07-26T12:41:21.558-0600|FilesTools|/var/www/html/|touch||||
|2018-07-26T12:41:22.071-0600|FilesMan|/var/www/html/|uploadFile||||
|2018-07-26T12:41:22.453-0600|FilesTools|/var/www/html/|sss.plHgkTAo|chmod|0444||
|2018-07-26T12:41:22.956-0600|FilesTools|/var/www/html/|touch||||
|2018-07-26T12:41:23.405-0600|FilesTools|/var/www/html/|.|touch|||
|2018-07-26T12:41:23.947-0600|FilesTools|/var/www/html/|..|touch|||
|2018-07-26T12:41:24.417-0600|FilesTools|/var/www/html/|sss.plHgkTAo|touch|||
|2018-07-26T12:41:24.892-0600|FilesTools|/var/www/html/sss.plHgkTAo|chmod||||
|2018-07-26T12:41:25.466-0600|FilesTools|/var/www/html/|sss.plHgkTAo|rename|sss.pl||
|2018-07-26T12:41:25.946-0600|FilesTools|/var/www/html/|sss.pl|chmod|0444||
|2018-07-26T12:41:29.415-0600|FilesTools|/var/www/html/sss.pl|chmod||||


