#!/bin/bash
# Reduce data.

# 1. timestamp address URL password
cat crudhammer.wso.password.data \
modern.wso.passwords \
premodern.wso.passwords \
wso.password.data.2018-10-28 \
wso.password.data.2018-11-27 \
wso.password.data.2019-09-15 \
wso.password.data.2019-09-15b | fgrep -v 'Cookie for' | fgrep -v 'eval' | fgrep -v 'print ' |
fgrep -v 'fopen(' | fgrep -v 'die(' | fgrep -v 'WRITE:1|IWRITE:28' | fgrep -v 'sheldonbarrett.com' |
fgrep -v 'UNAME:' |
sort | uniq | sort -k1.1n | ./timeparsefilter >  wso.passwords.txt

# 2. passwords and MD5 hash, WSO auth cookie value
awk '{print $4}' wso.passwords.txt | sort | uniq > just.passwords
php ./md5passwords.php just.passwords > md5passwords.txt

# 3. Top 20 WSO passwords
awk '{print $4}' wso.passwords.txt | sort | uniq -c | sort -k1.1nr | head -20 | awk '{print $2}' > top10.txt
