# Web Shells Analysis

A "web shell" is a program that presents a general purpose
administrative GUI interface to a human via a web page.
The analog is to a Linux "shell", a programming language interpreter
that specializes in manipulating files,
and starting and stopping other programs.

If web shells were standalone, they'd be "remote access trojans",
or if legitimately installed, they'd be "remote support software",
like [Dameware](https://www.dameware.com/).
But they're not standalone,
they run by HTTP invocation,
in the context of an HTTP (web) server.
They're almost never legitimately installed,
but rather surreptitiously placed on some compromised web server.

This groups all the web shells that I've caught and analyzed.
Includes:

* WSO 2.1, 2.3, 2.5, 2.6, 2.9, 2.5 + extensions
* b374k
* cgi-telnet
* c99
* PhpSpy
* Kaylin chinese language
* IndoXploit
* Some one-offs.

## WSO - web shell by orb

I collected all the [WSO passwords](wso_in_depth/passwords) my honey pot has seen.

Examination of [WSO in depth](wso_in_depth). It is the most common web shell family.
Other families of web shells are sparse compared to WSO.
The number of WSO variants is enormous.
The question becomes, "what makes a web shell a WSO web shell?"

##  [Thoroughly kinked WSO 2.1](/webshells/wew.php)

The most backdoored download I've ever seen. A WSO 2.1 web shell, with
two phone-homes It also downloads the LeafMail mailing tool, and a WSO 2.6
web shell.

## [b374k](/webshells/b374k)

An instance of b374k Web Shell, which gets some code from EXIF
data of a googleusercontent.com JPEG image.

## [K4X SHELL I'M THE BEST](/webshells/k4x_shell)

Descendant of b374k web shell, probably v2.2

## [FOPO-encoded WSO 2.3](/webshells/fopo_k4x_wso)

A FOPO-encoded WSO webshell that I hand-decoded because
I didn't believe it was really FOPO-encoded.
Arrived in the same campaign that delivered the [K4X SHELL](/webshells/k4x_shell).

## [ring.php](/plugins/login_wall/ring_decoded)

Medium-capability web shell downloaded along with login_wall fake plugin.
May be related to c99 web shell.

## [another ring.php instance](/webshells/tbl_status.php)

Another autokey-encoded instance of the `ring.php` web shell.
The obfuscation has changed, and this wasn't part of a [login_wall](/plugins/login_wall)
download.

## [CGI-Telnet](/webshells/cgi-telnet)

b374k has a link to download this moderately capable
web shell from pastebin.

## [Jijle3, WSO 2.5 variant](/webshells/154.121.7.26-2018-08-07a)

A WSO 2.5 web shell heavily modified by adding code from various
other hacking tools.

## [WSO 2.5 installation](/webshells/campaignA)

3.993 second WSO (Web Shell by oRb, a.k.a. "FilesMan")
installation, only eight HTTP requests, including a cold WordPress login.

## [Another WSO 2.5 installation](/webshells/settings.php)

Novel, yet oddly obfuscated WSO 2.5, installed via [apikey.php](/apikey.php).
`apikey.php` would have been installed via a plugin update with a malicious plugin,
so this isn't as circular as it could have been,
were `apikey.php` installed via WSO instance.

## [WSO 2.5, modified and labeled 2.6](/webshells/113.244.245.160-2019-08-31a)

Another WSO 2.5, edited a little, called 2.6 and packaged up in a
dropper that probably doesn't work.
Arrived about an hour after the [Chinafans defacement attempt](/defacements/chinafans).

## [Two Plugin Zip files](/webshells/customizer-ui-experimenks.php)

Uploads of two Zip-format-files, one of which is WSO 2.5 with some
camoflaging code. The other Zip file has an ELF-format executable
and a small piece of PHP to run that executable in the background.

## [claw.php](/webshells/claw.php)

c99 web shell inside 10-12 levels of obfuscation.

## [Simple web shell/backdoor](/webshells/118.184.47.13-2018-10-30a)

A simple backdoor, with just enough features to allow
a human to use it without too much automation.
Use could easily be automated. May be kinked, in that
it has a backdoor itself, if you know the magic HTTP parameter.

## [htaccess.php](/webshells/WSO-htaccess.php)

WSO "Web Shell by oRb", downloaded by a previously-installed
instance of WSO.

## [kaylin](/webshells/kaylin)

Full-featured, Chinese language web shell, with a modern webapp look to it.

## [Chinese language web shell](/webshells/222.77.242.65-2019-07-10a)

Another Chinese-language web shell. Very weak analsis, I'm a little ashamed.

## [archive.php](/webshells/archive.php)

Modified PhpSpy web shell, disguised as a GIF file, downloaded as
a theme update. Modifications are at least to change some labels
to Turkish, and add "phone home" code that lets someone in Turkey
know that the web shell has executed. Is there no honor among thieves!?!

## [Deeply obfuscated WSO](/webshells/general.php)

Somewhat modified Web Shell by oRb, derived from version 2.5,
or possibly 2.9. Many levels of obfuscation.

## [Busted Dropper](/webshells/calculation.php)

Dropper that relies on a WSO 2.9 variant to execute,
except its Base64 encoding is messed up. Drops a PHP
program that can (a) delete all `.htaccess` files up to
document root, or (b) generate some underhanded JavaScript
that redirects you to a scammy website.

## [Trojaned theme](/webshells/95.10.253.55-2018-01-25a)

A WordPress theme containing two PhpSpy web shells, and a
web-based file manager that phones home.

## [WSO with novel obfuscation](/webshells/5.149.250.194-2018-03-14a)

WSO 2.5 web shell, with a novel, 2-step obfuscation.
Attacker also added some anti-search-discovery code.
Most amusing.

## [IndoXploit](/webshells/IndoXploit)

Simple web shell, credits itself to an Indonesian URL.

