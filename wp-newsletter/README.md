# wp-newsletter-v??.php - recon and email spamming tool

## File Retrieval

Attempts to retrieve:

    http://newsletter-service.pw//var/www/html/temp/temp.ef831ecd8ad9a1e007cca58ddcf21437.zip


## Recon Function

Called with GET parameter `?server-infos=something`, it sends back
a JSON object:

    {"UNIQUE_ID":"Wi9bc45PduB7ni5vOphQEgAAAAU",
    "HTTP_USER_AGENT":"Wget\/1.19.2 (linux-gnu)",
    "HTTP_ACCEPT":"*\/*",
    "HTTP_ACCEPT_ENCODING":"gzip"
    ,"HTTP_HOST":"smurfette"
    ,"HTTP_CONNECTION":"Keep-Alive"
    ,"PATH":"\/usr\/local\/sbin:\/usr\/local\/bin:\/usr\/sbin:\/usr\/bin"
    ,"SERVER_SIGNATURE":""
    ,"SERVER_SOFTWARE":"Apache\/2.4.6 (CentOS) PHP\/7.0.25"
    ,"SERVER_NAME":"cain"
    ,"SERVER_ADDR":"xxx.yyy.zzz.www"
    ,"SERVER_PORT":"80"
    ,"REMOTE_ADDR":"aaa.bbb.ccc.ddd"
    ,"DOCUMENT_ROOT":"\/var\/www\/html"
    ,"REQUEST_SCHEME":"http"
    ,"CONTEXT_PREFIX":""
    ,"CONTEXT_DOCUMENT_ROOT":"\/var\/www\/html"
    ,"SERVER_ADMIN":"someone@example.com"
    ,"SCRIPT_FILENAME":"\/var\/www\/html\/server-infos.php"
    ,"REMOTE_PORT":"38360"
    ,"GATEWAY_INTERFACE":"CGI\/1.1"
    ,"SERVER_PROTOCOL":"HTTP\/1.1"
    ,"REQUEST_METHOD":"GET"
    ,"QUERY_STRING":"server-infos=yes"
    ,"REQUEST_URI":"\/server-infos.php?server-infos=yes"
    ,"SCRIPT_NAME":"\/server-infos.php"
    ,"PHP_SELF":"\/server-infos.php"
    ,"REQUEST_TIME_FLOAT":1513053043.306
    ,"REQUEST_TIME":1513053043
    ,"REAL_IP_GET":"290.232.160.123"
    ,"EXPLOIT_VERSION":"1.9.0"}

It also creates `.htaccess` file with these contents:

    <IfModule mod_rewrite.c>
      <IfModule mod_env.c>
          SetEnv HTTP_MOD_REWRITE_SHELL On
      </IfModule>
    </IfModule>

