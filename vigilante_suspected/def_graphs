#!/bin/bash
rm -f defs.cont
touch defs.cont
for FNAME in extracted_defs/*
do
	TIMESTAMP=$(basename $FNAME | sed 's/def.//')
	if [[ $TIMESTAMP =~ 2018-11-2[235] ]]
	then
		:
	else
		while read SERIAL NAME1 NAME2
		do
			echo $TIMESTAMP $SERIAL >> defs.cont
		done < $FNAME
		echo >> defs.cont
	fi
done

sort -k2.1n defs.cont | awk 'NR==1 {last=$2; print $0} NR>1 {if (last != $2) { print "\n"} print $0; last=$2}' > xyz
