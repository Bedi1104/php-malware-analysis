# php-malware-analysis

Rough cut analysis of PHP source code that I got via
running a [WordPress honey pot](http://stratigery.com/phparasites)

This illustrates what I think the bottom feeders who hack WordPress sites do,
once they have illegitimate access to a new WordPress instance or host.

## [nptzow](nptzow)

Seems to be some kind of search engine optimization thing.
It serves up different results for "human" or "bot" invokers.
When it decides you're a "bot" it creates web pages from
templates and results from Google and/or Yahoo searches.

## [phpd.local](phpd.local)

Native PHP SOCKS server. I often see Perl and even compiled ("bouncer")
SOCKS servers downloaded. Can you sell SOCKS servers on some underground
markets? Is there value in having a cut-out like this?

## [wp-newsletter](wp-newsletter)

Two versions of something.

## [claw.php](claw.php)

c99 web shell inside 10-12 levels of obfuscation.

## [IndoXploit](IndoXploit)

Simple web shell, credits itself to an Indonesian URL.

## [promos.php](promos.php)

Email spamming tool, explodes a single POST request into multiple emails.
Has "check" function that looks up compromised machine's IP address
in various RBLs.

## [htaccess.php](WSO-htaccess.php)

WSO "Web Shell by oRb", downloaded by a previously-installed
instance of WSO.

## [db-config.php](db-config.php)

An email spamming tool, with WSO web shell appended. Complete with
"phone home" code to notify a Ukrainian web site that someone invoked the program.

## [CMS Recon tool](109.74.0.104-2017-11-28a)

Knows how to recognize 24 different CMS systems and frameworks.
Responds to an HTTP POST with a serialized summary of what CMS and framework(s) it found.

## [kaylin](kaylin)

Full-featured, Chinese language web shell, with a modern webapp look to it.

## [mobile phone browser redirector](91.223.167.117-2017-12-27a)

Redirects mobile phone browsers to some other URL via
`mod_rewrite` comands in document root `.htaccess` file.

## [Access verification](31.184.234.60-2017-12-28a)

Downloads PHP code that when executed, creates an HTML file.
The downloading IP address immediately attempted to access
the HTML file, so this is probably just access verification.

## [GetDomains](GetDomains)

I hypothesize this is an Apache virtual host directory
reconnaisance tool. Looks for directory names with 150+
domain name appearing suffixes, seems to emphasize Russian and eastern European
country codes.

## [archive.php](archive.php)

Modified PhpSpy web shell, disguised as a GIF file, downloaded as
a theme update. Modifications are at least to change some labels
to Turkish, and add "phone home" code that lets someone in Turkey
know that the web shell has executed. Is there no honor among thieves!?!

## [SuperFetchExec](syslib.php)

Ancient SuperFetchExec PHP malware, still using the same old
XOR string it was using in 2012.

## [Deeply obfuscated WSO web shell](general.php)

Somewhat modified Web Shell by oRb, derived from version 2.5,
or possibly 2.9. Many levels of obfuscation.

## [Legitimate File Manager Plugin](185.220.101.21-2018-01-01a)

A real (albeit possibly off-license) file manager plugin, illegitimately
installed. Interesting dual use of COTS technology.

## [Flexible email spamming tool](ricches.php)

Email spamming tool, where all email/SOCKS/spam parameters
are transmitted in an HTTP cookie.

## [Plausibly Deniable Blind SQL Injection](188.120.231.151-2018-01-07a)

An intermediary, coded and obfuscated for my specific honey pot,
that acts as a cut-out between the downloader, and another
web site. Performs SQL injection testing on that other web site.
