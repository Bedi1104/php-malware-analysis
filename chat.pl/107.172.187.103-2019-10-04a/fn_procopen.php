<?php
function fn_procopen($i,$d) {
	$o="";
	if (
		is_resource(
			$h=proc_open(
				$i,
				array(0=>array("pipe","r"),1=>array("pipe","w"),2=>array("pipe","w"))
				,$p
			)
		)
	) {
		fwrite($p[0],$d);
		fclose($p[0]);
		while (!feof($p[1])) {
			$o.=fread($p[1],1024);
		}
		fclose($p[1]);
		proc_close($h);
	}
	return $o;
}
