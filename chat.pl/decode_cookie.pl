#!/usr/bin/env perl
use strict;
use warnings;
my $cookie = '300518103c7675742a676972646d6365226e612076722e676a68736d677e2478656b6275623d757870757e79366e7e716d30';

my  ($link, $file, $id, $command, $timeout );
($link, $file, $id, $command, $timeout ) = &decxd($cookie);

print "\$link \"$link\"\n";
print "\$file \"$file\"\n";
print "\$id \"$id\"\n";
print "\$command \"$command\"\n";
print "\$timeout \"$timeout\"\n";

sub decxd {
    my $data = pack( "H*", shift );
    @_ = unpack( "C5", substr( $data, 0, 5, "" ) );
    return ( &xorl( substr( $data, 0, shift, "" ) ),
        &xorl( substr( $data, 0, shift, "" ) ), @_ );
}

sub xorl {
    my ( $line, $code, $xor, $lim ) = ( shift, "", 1, 16 );
    foreach my $chr ( split( //, $line ) ) {
        if ( $xor == $lim ) {
            $lim = 0 if $lim == 256;
            $lim += 16;
            $xor = 1;
        }
        $code .= pack( "C", unpack( "C", $chr ) ^ $xor );
        $xor++;
    }
    return $code;
}
