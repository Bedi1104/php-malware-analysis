# chat.pl - self-contained email spamming tool

A self-contained Perl email spamming server. Native Perl
versions of DNS lookup and SMTP email sending.

## Origin

### IP Address

Right now, 87.106.242.16 is in 87.106.0.0/16AS8560. That looks like
a 1&1 German subsidiary, in Karlsruhe, Germany.

DNS says 87.106.242.16 is s15316012.onlinehome-server.info

`whois onlinehome-server.info` gives 1&1 Internet Inc. as admin, registrant and billing contacts.

### Download

Downloaded to a honey pot WSO web shell. The downloader wanted to
execute the "Php" action that WSO provides, which is immediate eval of
PHP code, with no file created.

## Decoding

1. Hand edit `87.106.242.16WjPLrzyjMixMC240GgLqBAAAAAo.php.file` into `dc1.php` to decode the Base64-encoded block of text.
2. Execute `php dc1.php > chat.pl`

Downled a PHP program to a PHP program, that creates a Perl program.

## Analysis

The `chat.pl` program seems like a decently written Perl
server. It does smart server things like change directory to
"/", the root of the filesystem,
it ignores signals like HUP, INT, QUIT, etc,
that Linux/Unix server processes should ignore.
and re-opens STDIN, STDOUT and STDERR as /dev/null.
It forks and sets a session ID, to detach itself from any TTY.

The code is of uniform style and quality. It does `use strict;`
which is wise for Perl programs.
Variables and functions are consistently named in all lower-case.
Functions are called old school style, i.e. `&startserver();`,
with a leading ampersand.

It looks like `chat.pl` can work under Linux, FreeBSD and "MSWin32".

