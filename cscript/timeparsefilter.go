package main

import (
	"bufio"
	"fmt"
	"net"
	"os"
	"strconv"
	"strings"
	"time"
)

func main() {

	fmt.Printf("|IP address|Download time|DNS name|\n")
	fmt.Printf("|----------|-------------|--------|\n")

	scanner := bufio.NewScanner(os.Stdin)

	for scanner.Scan() {
		line := scanner.Text()
		sp := strings.IndexByte(line, ' ')
		if sp > -1 {
			// Convert "epoch" time to meaninglful timestamp
			sec, err := strconv.ParseInt(string(line[sp+1:]), 10, 64)
			if err != nil {
				fmt.Fprintf(os.Stderr, "%s\n", err)
				continue
			}
			t := time.Unix(sec, 0)

			// Get host name for IP address
			names, nerr := net.LookupAddr(line[:sp])
			name := "N/A"
			if nerr == nil {
				name = names[0]
				name = name[0:len(name)-1]
			}

			fmt.Printf("|%s|%s|%s|\n", line[:sp], string(t.Format("2006-01-02T03:04:05.000-0700")), name)
		} else {
			fmt.Fprintf(os.Stderr, "Did not find a space in: %q\n", line)
		}
	}
}
