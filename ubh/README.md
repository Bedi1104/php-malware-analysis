# United Bangladeshi Hackers plugin

Hacking tools disguised as a plugin,
implicating a Bangladeshi hacking crew.
It claims to be from "United Bangladeshi Hackers",
but the attacking IP address was Turkish,
their website is registered out of Bangalore, India,
and hosted in Australia.
The most effective piece of code they downloaded appears to
be from a Russian programmer.
Quite a cosmopolitan conglomeration,
but it doesn't scream "Bangladeshi" except for the possibly ironic title.

## Origin

### Download

A file named `ubh.zip` got downloaded to my WordPress honey pot
via the plugin install page.
It is a zip-format file,
so I suppose that WordPress would have opened the zip file.

### IP Address 88.253.118.191

Address downloaded from 88.253.118.191 has DNS 88.253.118.191.dynamic.ttnet.com.tr

Apparently another TurkTelecom IP address 

That makes sense. Traceroute goes through:

    34-acibadem-xrs-t2-2---308-buk-col-1.statik.turktelekom.com.tr (212.156.139.107)
    34-acibadem-t3-6---34-acibadem-xrs-t2-2.statik.turktelekom.com.tr (195.175.171.162)

#### ubhteam.org

`whois` for ubhteam.org:

    Domain Name: UBHTEAM.ORG
    Registrant Name: Domain Manager
    Registrant Organization: samirnet -domain names for sale
    Registrant Street: Flat No. 48 Cunningham Apts Edward Road
    Registrant City: Bangalore
    Registrant State/Province:
    Registrant Postal Code: 560052
    Registrant Country: IN

Wait, *Bangalore*? That's not in Bangladesh.

ubhteam.org &rarr; 103.224.212.222

103.224.212.222 &rarr; lb-212-222.above.com.

    inetnum:        103.224.212.0 - 103.224.213.255
    netname:        TRELLIAN-AU
    descr:          Trellian Pty. Limited
    descr:          8 East Concourse, Beaumaris Victoria 3193
    country:        AU

Hmmm... Australia.

## Analysis

The Zip file unzips into a directory containing 4 files:

1. `ubh.php` - plugin actions that references `con.php` and `up.php`
2. `con.php` - console? Very obfuscated
3. `index.php` - small amount of HTML displaying "United Bangladeshi Hackers"
3. `up.php` - file uploader.

### `up.php` file uploader

### `con.php` - densely coded interactive console

The original [`con.php` file](ubh/con.php) is a highly obscured piece of visual garbage.

After running my [PHP deobfuscator](https://github.com/bediger4000/reverse-php-malware)
over it, it becomes [clearer](f1.php).
But not totally clear, whatever JavaScript minifier compressed this did a great job.

![web console screen shot](ubh_web_console.png?raw=true)

https://github.com/nickola/web-console

https://github.com/sergeyfast/eazy-jsonrpc
