# Turkish AyyÄ±ldÄ±Tim Hacking Campaign

75 [HTTP accesses](access_log) from 
18/Mar/2018:07:37:01 -0600 to 18/Mar/2018:07:41:36 -0600

10 file downloads via at least 2 methods.
1. theme editor file update
2. WSO file upload, although this looks like an artifact
of honey pot not acting like PhpSpy, but WSO instead.

HTTP accesses retrieved `favicon.ico`, `style.css`,
`navigation.js`, others indicating use of a web
browser, not some program. Fairly rare occurance.

User agent is `Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36`

Login via admin/1234qwer without any guessing.

Uploaded Turkish PhpSpy `archive.php`. Honey pot doesn't
distinguish PhpSpy, responded to access of archive.php URL
with WSO login page.

Attacker apparently confused by this, several attempts
to use `archive.php` URL, lists files using WSO FilesMan
listFile action. Uploads `index.html` file using
uploadFile action (refer to file in this repo)

Attempt to delete WordPerfect files via delete subaction
of FilesMan action. "move" subaction, archive.php -> index.php
More apparently interactive use of WSO listing, tar,
move subactions.


## Origin

### IP Address 88.240.107.37

88.240.107.37 has DNS 

37.107.240.88.in-addr.arpa	name = 88.240.107.37.dynamic.ttnet.com.tr.

Authoritative answers can be found from:

Server:		127.0.0.1
Address:	127.0.0.1#53

** server can't find 88.240.107.37.dynamic.ttnet.com.tr: NXDOMAIN

** Registrant:
   TTNET AÞ
   Esentepe Mah.Salih Tozan Sok.Karamancýlar Ýþ Mrk.
   D Blok No:16 Þiþli
   Ýstanbul,
     Türkiye
   domain.minder@ttnet.com.tr
   + 90-212-3061000-
   + 90-212-3061010-


** Registrar:
NIC Handle		: tyh14-metu
Organization Name	: Turkticaret.Net Yazýlým Hizmetleri Sanayi Ticaret A.Þ.
Address			: Uludag Universitesi Gorukle Kampusu
			  Ulutek Tek. Bol. Arge Binasi Yani Ek Bina Nilufer
			  Bursa,
			  Türkiye
Phone			: + 90-224-2248640
Fax			: + 90-224-2249520


** Domain Servers:
ns1.ttnetdns.com.tr
ns2.ttnetdns.com.tr

** Additional Info:
Created on..............: 2008-Jan-21.
Expires on..............: 2019-Jan-20.
% This is the RIPE Database query service.
% The objects are in RPSL format.
%
% The RIPE Database is subject to Terms and Conditions.
% See http://www.ripe.net/db/support/db-terms-conditions.pdf

% Note: this output has been filtered.
%       To receive output for a database update, use the "-B" flag.

% Information related to '88.240.0.0 - 88.240.255.255'

% Abuse contact for '88.240.0.0 - 88.240.255.255' is 'abuse@ttnet.com.tr'

inetnum:        88.240.0.0 - 88.240.255.255
netname:        TurkTelekom
descr:          TT ADSL-TT net_aci
country:        tr
admin-c:        TTBA1-RIPE
tech-c:         TTBA1-RIPE
status:         ASSIGNED PA
mnt-by:         as9121-mnt
created:        2006-02-08T07:31:03Z
last-modified:  2010-07-27T08:47:35Z
source:         RIPE # Filtered

role:           TT Administrative Contact Role
address:        Turk Telekom Genel Mudurlugu
phone:          +90 312 555 0000
fax-no:         +90 312 313 1924
admin-c:        BADB3-RIPE
abuse-mailbox:  abuse@ttnet.com.tr
tech-c:         BADB3-RIPE
tech-c:         BADB3-RIPE
tech-c:         BADB3-RIPE
nic-hdl:        TTBA1-RIPE
mnt-by:         AS9121-MNT
created:        2002-02-28T12:22:28Z
last-modified:  2017-03-29T05:21:26Z
source:         RIPE # Filtered

% Information related to '88.240.0.0/17AS9121'

route:          88.240.0.0/17
descr:          TurkTelecom
origin:         AS9121
mnt-by:         AS9121-MNT
created:        2006-01-20T12:55:53Z
last-modified:  2006-01-20T12:55:53Z
source:         RIPE

% This query was served by the RIPE Database Query Service version 1.91.1 (WAGYU)


### Decoding 88.240.107.37Wq5rsZQwvvYtun9nnJ-rSQAAAAAfile

1. Hand edit `88.240.107.37Wq5rsZQwvvYtun9nnJ-rSQAAAAAfile` into `dc1.php`,
change "eval" to "print"
2. Invoke `php dc1.php > dc2.php`

`dc2.php` is a version of PhpSpy with some Turkish
language mods. Same version of PhpSpy as in
[archive.php](../webshells/archive.php)


