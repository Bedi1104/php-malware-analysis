# kaylin - Chinese language web shell

A rather aesthetic Chinese language web shell, with lots of features.

## Origin

### IP Address 95.85.38.41

95.85.38.41 is a Digital Ocean IP address. Not worth following up.

### Download

Downloaded to my WordPress honey pot as a plugin install. Not an upgrade,
a straight up install, to a file `editor.php`

I seem to remember that all plugins have the Zip file format. This code
got sent to my honey pot as straight ASCII text. This may not even work.

## Decoding

1. De-obfuscate `95.85.38.41WjH2yKqyGTm6pK8KcQwmrQAAAAA.0.file`: `revphp *file > fx1.php`
2. Hand edit `fx1.php` to change "eval" to "print"
3. Execute `php fx1.php > dx1.php`
4. Pretty print `dx1.php` to get `fx2.php`

## Analysis

HTML generated by `fx2.php` sets character set to GB2312, a
"simplified chinese character" character set.

![kaylin screen shot](https://raw.githubusercontent.com/bediger4000/php-malware-analysis/master/kaylin/kaylin.jpg)

Indeed, it displays Chinese characters in the tabs for its various functions.

### Features

1. File management functions
2. Scan files for keywords
3. Antivirus, seems to scan files for something
4. Run backshell on exploited machine, Perl, PHP, compiled C or native PHP, on port 443
5. exec a shell function on exploited machine, Windows or Linux
5. execute SQL in Postgres, SQLServer, Oracle or MySQL databases on exploited machine.
6. eval PHP source code
7. Display `phpinfo()`
8. Upload files
