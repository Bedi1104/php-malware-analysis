# CMS recon

Call to RC action of Web Shell by oRb, most common web shell.
Unusual - usually call Php action to eval PHP source passed in
POST parameters.

Does an exhaustive check for presence of 24 different CMS, including
WordPress, Joomla, Drupal, phpBB and lots of others. It looks for files
that apparently indicate that this malware investigates a particular CMS.
Any results it finds get serialized, and returned to the invoker as
the reply to the POST that invoked the WSO web shell.

## Origin

### IP address 109.74.0.104

109.74.0.104 is 109-74-0-104-static.glesys.net in DNS.

109.74.0.0/20AS43948 is registered to a Swedish company:

    person:         GleSYS Support
    address:        Box 134
    address:        31122 Falkenberg
    address:        Sweden
    phone:          +46-346-738800
    nic-hdl:        GLE-RIPE
    mnt-by:         GLESYS-MNT
    created:        2007-09-20T12:07:40Z
    last-modified:  2010-05-28T04:24:21Z

`traceroute` shows the routing going through glesys.net hosts.

### Download

Downloaded to a fake WSO web shell. Done using the "RC" action, which
in versions later than 2.1, causes WSO to immediate evaluate any
PHP code that appears as the value of the POST parameter named `p1`.

This is a bit unusual - most code gets downloaded to a file, then
invoked by URL later.
