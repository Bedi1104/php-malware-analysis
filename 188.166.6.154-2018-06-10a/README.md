# Small Turkish Language Web Shell/File manager

## Origin

### Download

Downloaded through the theme update feature of a WordPress honey pot.
I believe that a real WordPress would have created or overwritten a file
`wp-content/themes/twentytwelve/archive.php` in the WordPress directory tree.

### IP Address 188.166.6.154

It's a digital ocean IP address.

geoiplookup 188.166.6.154: GeoIP Country Edition: NL, Netherlands

    inetnum:        188.166.0.0 - 188.166.127.255
    netname:        EU-DIGITALOCEAN-NL1
    descr:          Digital Ocean, Inc.
    country:        NL

Traceroute through:
* 100ge6-2.core1.ams1.he.net (Amsterdam)
* digitalocean.telecity5.nl-ix.net

Netherlands seems correct.

## Deobfuscation

This code had only one level of obfuscation,
a very common `<?php eval("?>".base64_decode("...` .
That is, when the `archive.php` file got executed,
PHP would do a base64 decoding, and then eval the resulting PHP source,
which lives in [`dc2.php`](dc2.php) in this repo/project.

## Analysis

A tidy little (297 lines of code) file manager.

![screen shot](https://raw.githubusercontent.com/bediger4000/php-malware-analysis/master/188.166.6.154-2018-06-10a/turkish_web_shell.png)

I don't read Turkish, but it looks like you can upload files,
delete, rename, change permissions, change directory and 
even edit a file, which I could not get to work.
Not terrifically full-featured: there's no "eval PHP" function
at all, not even a backdoor or a hidden eval in the source code.

The background image was not available or had incorrect contents.
