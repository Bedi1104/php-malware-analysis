#!/bin/bash

for NAME in files/*wso.scans
do
	awk '/\[name\] => [a-z][a-z][a-z][a-z][a-z][a-z][a-z][a-z][a-z]\.php/ {file=$3} /\[0\] => [a-z][a-z][a-z][a-z][a-z][a-z][a-z][a-z][a-z]\.php/ {file=$3} /\[REMOTE_ADDR\]/ {ip = $3} END {print file, ip}' $NAME
done | sort -k1.1 > downloads.to.ips

for NAME in accesses/*wso.scans
do
	X=$(basename $(grep 'SCRIPT_URL' $NAME | awk '{print $3}'))
	Y=$(grep 'REMOTE_ADDR' $NAME | awk '{print $3}')
	echo $X $Y
done | sort -k1.1 > accesses.to.ips

join downloads.to.ips accesses.to.ips | awk '{if ($2 != $3) { print $0 }}'
