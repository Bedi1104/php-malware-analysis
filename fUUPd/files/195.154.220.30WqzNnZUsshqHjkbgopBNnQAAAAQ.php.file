@set_time_limit(0);
@ini_set("memory_limit", "512M");


function array_strstr($haystack, $needles)
{
	foreach($needles as $needle)
		if(strpos($haystack, $needle))
			return true;
    
    
return false;
}

function array_strcmp($haystack, $needles)
{
	foreach($needles as $needle)
		if(!strncmp($haystack, $needle, strlen($haystack)))
			return true;
    
    
return false;
}

function DelByPartOfName($dir, $t_match) 
{
	$dir = rtrim($dir, '\\/');
	$h = @opendir($dir);
	
	
		while(($f = @readdir($h)) !== false) 
		{
			if($f !== '.' && $f !== '..') 
			{
				if(is_dir("$dir/$f")) 
					DelByPartOfName("$dir/$f", $t_match);
		
				if(is_file("$dir/$f"))
				{
					if(array_strcmp($f, $t_match))
					{
						echo "Delete: $dir/$f"."<br>";
						@unlink("$dir/$f");
					}
				}
			}
		}
		
		closedir($h);
}

function DelByPartOfText($dir, $t_match) 
{
	$dir = rtrim($dir, '\\/');
	$h = @opendir($dir);
	
	
		while(($f = @readdir($h)) !== false) 
		{
			if($f !== '.' && $f !== '..') 
			{
				if(is_dir("$dir/$f")) 
					DelByPartOfText("$dir/$f", $t_match);
		
				if(is_file("$dir/$f") && strncmp("$dir/$f", realpath(__FILE__), strlen("$dir/$f")) != 0)
				{
					if(array_strstr(@file_get_contents("$dir/$f"), $t_match))
					{
						echo "Delete: $dir/$f"."<br>";
						@unlink("$dir/$f");
					}
				}
			}
		}
		
		closedir($h);
}


$full_name = array("infodata.php", "mail.php", "post.php", "wlomaz.zip");

echo "Search in: ".$_SERVER["DOCUMENT_ROOT"]."<br><br>";

DelByPartOfName($_SERVER["DOCUMENT_ROOT"], $full_name);