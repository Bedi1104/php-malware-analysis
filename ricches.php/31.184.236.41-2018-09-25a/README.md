# Another cookie contents spamming tool

This is apparently an advanced version of the cookie-contents
spamming tool.

This document compares the two versions,
which my honey pot caught about 9 months apart.

## Origin

### IP Address 31.184.236.41

31.184.236.41 has DNS A record of omp-pronouns.outtimid.com.

omp-pronouns.outtimid.com does not have a reverse lookup.

outtimid.com does not have `whois` information,
and 31.184.236.41 has a bad internet reputation for spamming.

`whois` says that 31.184.236.41 is:

    inetnum:        31.184.236.0 - 31.184.236.255
    netname:        Makis_Systems_network
    country:        CZ
    admin-c:        AP27687-RIPE
    org:            ORG-MSL37-RIPE
    mnt-routes:     Jurjanu-mnt
    created:        2017-09-27T09:28:59Z
    last-modified:  2017-09-27T11:32:15Z
    org-name:       Makis Systems Ltd.
    address:        Prague 3, Seifertova 545/44, postal code 13000
    abuse-c:        ACRO10118-RIPE

Oddly, one of the contacts is a Russian, in Moscow:

    person:         ALEXEY PANAFIDIN
    address:        Moskva, Kantemirovskaya 12 / 1-235, ZIP 115477, Russian Federation
    phone:          +420228885778
    nic-hdl:        AP27687-RIPE
    mnt-by:         MNT-PINSUPPORT
    mnt-by:         MNT-PIN
    created:        2017-09-27T09:13:49Z
    last-modified:  2017-09-27T15:03:57Z

That's amusing.
`geoiplookup` has the address in the Russian Federation.
Cross-border oddities are a trademark of IP addresses that behave poorly.


--- Compare to earlier IP address
`p0f3` says Linux 3.1-3.10 for this one,
Linux 3.1-3.10 for the previous version.

### Download

Essentially the same download technique both times.

Previous version sent to file name "ricches.php",
this one to "wbalyosian.php".

Both downloaded to what they attacker believed was a WSO webshell.
"FilesMan" action, "uploadFile" subaction,
WSO password of "nhzgrf" both times.

/wordpress/wp-content/plugins/revslider/temp/update_extract/revslider/db.php
/wordpress//wp-content/plugins/revslider/temp/update_extract/revslider/db.php

Same User Agent string: " Mozilla/5.0 (compatible; MSIE 7.0; Windows NT 5.1)"
both times, and if we believe `p0f3`, it's a lie.

## Analysis

-- differences

-- are they bug fixes or what?
Apparently mostly a feature upgrade.
It now seems to support "StartTLS"
