# Something

Some weird code that does some weird actions.

## Origin

### IP Address 198.71.239.32

198.71.239.32 &rarr; a2nlwpweb031.prod.iad2.secureserver.net

a2nlwpweb031.prod.iad2.secureserver.net &rarr; 198.71.239.32

Both 198.71.239.32 and domain secureserver.net belong to GoDaddy.

`traceroute` has 198.71.239.32 behind godaddy.com and secureserver.net
IP addresses.

### Download

Downloaded to the fake WSO web shell componet of my WordPress
honey pot. Downloader called the "RC" action with PHP code
you can see in `198.71.239.32WpEwV-t@zpEjMNWi9KQirQAAAAY.php.file`
as one of the POST parameters. WSO's RC action is an immediate
eval backdoor for PHP code The downloader expected the PHP
to run immediately, and return text to him or her.

## Decoding

`198.71.239.32WpEwV-t@zpEjMNWi9KQirQAAAAY.php.file` has 2 base64-encoded
lines at the time. Take care of those.

1. Edit `198.71.239.32WpEwV-t@zpEjMNWi9KQirQAAAAY.php.file` into `dc1.php` and `db1.php`
2. Edit `dc1.php`, add `<?php` and change "eval" to "print"
3. Invoke `php dc1.php > dc2.php`
4. Invoke `/home/bediger/src/php/reverse-php-malware/pp.php dc2.php > f2.php`

`dc2.ph` has unindented code. Pretty-print to aid in readability.
Code in `f2.php` creates a number of oddly-named PHP functions.

1. Edit `db1.php`, add `<?php` and add `var_dump($defs);` to get a readable version of unserialized object.
2. Invoke `php db1.php > defs.dump`

`defs.dump` contains an array of 3-element arrays, one of which
looks like this:

    array(3) {
      [0]=>
      int(191)
      [1]=>
      string(8) "rqwrdtyq"
      [2]=>
      string(7) "gejtcnw"
    }

Functions named "rqwrdtyq" and "gejtcnw" exist in `f2.php`.

## Analysis

